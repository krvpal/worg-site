<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN">
<!-- Created by htmlize-1.56 in css mode. -->
<html>
  <head>
    <title>org-watchdoc.org</title>
    <style type="text/css">
    <!--
      body {
        color: #d6d6d4;
        background-color: #161719;
      }
      .bold {
        /* bold */
        font-weight: bold;
      }
      .comment {
        /* font-lock-comment-face */
        color: #696969;
      }
      .custom {
      }
      .kc-org-link-url {
        /* kc-org-link-url */
        color: #d02090;
        text-decoration: underline;
      }
      .org-block-begin-line {
        /* org-block-begin-line */
        color: #696969;
      }
      .org-block-end-line {
        /* org-block-end-line */
        color: #696969;
      }
      .org-date {
        /* org-date */
        color: #a020f0;
      }
      .org-document-info {
        /* org-document-info */
        color: #fd971f;
      }
      .org-document-info-keyword {
        /* org-document-info-keyword */
        color: #555556;
      }
      .org-document-title {
        /* org-document-title */
        color: #fd971f;
        font-weight: bold;
      }
      .org-drawer {
        /* org-drawer */
        color: #cd3278;
      }
      .org-formula {
        /* org-formula */
        color: #66d9ef;
      }
      .org-level-1 {
        /* org-level-1 */
        color: #eb4509;
        font-weight: bold;
      }
      .org-level-2 {
        /* org-level-2 */
        color: #f0b144;
        font-weight: bold;
      }
      .org-level-3 {
        /* org-level-3 */
        color: #8ec298;
        font-weight: bold;
      }
      .org-link {
        /* org-link */
        color: #fd971f;
        font-weight: bold;
        text-decoration: underline;
      }
      .org-list-dt {
        /* org-list-dt */
        color: #e2c770;
      }
      .org-meta-line {
        /* org-meta-line */
        color: #7f7f80;
      }
      .org-property-value {
        /* org-property-value */
        color: #7f7f80;
      }
      .org-special-keyword {
        /* org-special-keyword */
        color: #7f7f80;
      }
      .org-superstar-header-bullet {
      }
      .org-superstar-leading {
        /* org-superstar-leading */
        color: #bebebe;
        background-color: #010000;
      }
      .org-table {
        /* org-table */
        color: #9c91e4;
      }

      a {
        color: inherit;
        background-color: inherit;
        font: inherit;
        text-decoration: inherit;
      }
      a:hover {
        text-decoration: underline;
      }
    -->
    </style>
  </head>
  <body>
    <pre>
<span class="org-document-info-keyword">#+TITLE:</span> <span class="org-document-title">Org-watchdoc
</span><span class="org-document-info-keyword">#+DATE:</span> <span class="org-document-info"><span class="org-date">&lt;2014-04-09 Mi&gt;</span></span><span class="org-document-info">
</span><span class="org-document-info-keyword">#+AUTHOR:</span> <span class="org-document-info">Thorsten Jolitz
</span><span class="org-document-info-keyword">#+DATE:</span> <span class="org-document-info">2014-04-10
</span><span class="org-meta-line">#+OPTIONS: H:4 num:nil toc:4 \n:nil </span><span class="org-meta-line"><span class="org-formula">@:t</span></span><span class="org-meta-line"> ::t |:t ^:t -:t f:t *:t TeX:t LaTeX:t skip:nil d:(HIDE) tags:not-in-toc prop:t</span>
<span class="org-meta-line">#+STARTUP: align fold nodlcheck oddeven lognotestate</span>
<span class="org-meta-line">#+SEQ_TODO: TODO(t) INPROGRESS(i) WAITING(w@) | DONE(d) CANCELED(c@)</span>
<span class="org-meta-line">#+TAGS: Write(w) Update(u) Fix(f) Check(c)</span>
<span class="org-meta-line">#+LANGUAGE: en</span>
<span class="org-meta-line">#+PRIORITIES: A C B</span>
<span class="org-meta-line">#+CATEGORY: worg</span>

<span class="comment"># This file is released by its authors and contributors under the GNU</span>
<span class="comment"># Free Documentation license v1.3 or later, code examples are released</span>
<span class="comment"># under the GNU General Public License v3 or later.</span>

<span class="org-link"><a href="file:index.org">{Back to Worg's index}</a></span>

<span class="org-level-1"><span class="org-superstar-header-bullet">*</span></span><span class="org-level-1"> org-watchdoc.el --- Watchdog for exported Org-mode trees
</span><span class="org-drawer">:PROPERTIES:</span>
<span class="org-special-keyword">:EXPORT_OPTIONS:</span> <span class="org-property-value">prop:nil</span>
<span class="org-special-keyword">:wdoc_1992rwM:</span> <span class="org-property-value">/home/tj/git/org-watchdoc/README.md /home/tj/git/org-watchdoc/export-templates/org-watchdoc-gh.org gfm</span>
<span class="org-special-keyword">:wdoc_1992G_r:</span> <span class="org-property-value">/home/tj/gitclone/worg/org-contrib/org-watchdoc.org /home/tj/git/org-watchdoc/export-templates/org-watchdoc-worg.org org</span>
<span class="org-special-keyword">:wdoc_1992gas:</span> <span class="org-property-value">/home/tj/git/org-watchdoc/targets/org-watchdoc.html /home/tj/git/org-watchdoc/export-templates/org-watchdoc-gh.org html</span>
<span class="org-special-keyword">:wdoc_1992tky:</span> <span class="org-property-value">/home/tj/git/org-watchdoc/targets/org-watchdoc.txt /home/tj/git/org-watchdoc/export-templates/org-watchdoc-gh.org ascii</span>
<span class="org-special-keyword">:wdoc_1992fuB:</span> <span class="org-property-value">/home/tj/git/org-watchdoc/targets/org-watchdoc.tex /home/tj/git/org-watchdoc/export-templates/org-watchdoc-gh.org latex</span>
<span class="org-drawer">:END:</span>

Copyright (C) from 2014 Thorsten Jolitz
Author: Thorsten Jolitz &lt;tjolitz at gmail dot com&gt;
Keywords: org-mode, exporter, propagate changes, documentation

<span class="org-superstar-leading">*</span><span class="org-level-2"><span class="org-superstar-header-bullet">*</span></span><span class="org-level-2"> MetaData
</span><span class="org-drawer">:PROPERTIES:</span>
<span class="org-special-keyword">:copyright:</span> <span class="org-property-value">Thorsten Jolitz</span>
<span class="org-special-keyword">:copyright-years:</span> <span class="org-property-value">2014+</span>
<span class="org-special-keyword">:version:</span>  <span class="org-property-value">1.0</span>
<span class="org-special-keyword">:licence:</span>  <span class="org-property-value">GPL 3 or later (free software)</span>
<span class="org-special-keyword">:licence-url:</span> <span class="kc-org-link-url"><a href="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</a></span>
<span class="org-special-keyword">:part-of-emacs:</span> <span class="org-property-value">no</span>
<span class="org-special-keyword">:git-repo:</span> <span class="kc-org-link-url"><a href="https://github.com/tj64/org-watchdoc.git">https://github.com/tj64/org-watchdoc.git</a></span>
<span class="org-special-keyword">:git-clone:</span> <span class="org-property-value">git://github.com/tj64/org-watchdoc.git</span>
<span class="org-special-keyword">:author:</span>   <span class="org-property-value">Thorsten Jolitz</span>
<span class="org-special-keyword">:author_email:</span> <span class="org-property-value">tjolitz AT gmail DOT com</span>
<span class="org-drawer">:END:</span>
<span class="org-superstar-leading">*</span><span class="org-level-2"><span class="org-superstar-header-bullet">*</span></span><span class="org-level-2"> Commentary
</span>
This library implements functionality for keeping exported files
associated with Org subtrees up-to-date.

Its principal use case is writing the comment-section of Emacs
Lisp (or other) source-code files only once (and in full Org-mode
using outorg.el), export it as README documentation from the
<span class="bold">outorg-edit-buffer</span> to html, ascii, latex/pdf,
markdown-github-flavor or whatever, and keep the exported doc
files automatically up-to-date when the original comment-section
of the source-buffer is edited explicitly with outorg (via M-x
outorg-edit-comments-and-propagate-changes).

org-watchdoc is just a little toolbox that can be used
independently from outorg too. All its functions are commands, so
its functionality is available for interactive use too.
<span class="org-superstar-leading">*</span><span class="org-level-2"><span class="org-superstar-header-bullet">*</span></span><span class="org-level-2"> Installation
</span>
Put this line in your init file

<span class="org-block-begin-line">#+BEGIN_SRC 'emacs-lisp
</span>  (require 'org-watchdoc)
<span class="org-block-end-line">#+END_SRC
</span>
and make sure Emacs can find the file org-watchdoc.el.

To take real advantage of org-watchdoc, outshine.el and outorg.el
(and maybe navi-mode.el) should be installed and source-code
buffers should be structured with outshine headers (outcommented
Org-mode headers), taking care that the whole comment-section is
one single outline tree that is the first headline in the
source-code file. Use org-watchdoc.el itself as an example for
this kind of file structuring.
<span class="org-superstar-leading">*</span><span class="org-level-2"><span class="org-superstar-header-bullet">*</span></span><span class="org-level-2"> Usage
</span>
<span class="org-superstar-leading">**</span><span class="org-level-3"><span class="org-superstar-header-bullet">*</span></span><span class="org-level-3"> Commands
</span>
Since org-watchdoc is a toolbox and not a mode, no menu or keymap
is specified. However, its commands can be used interactively:

<span class="org-table">| M-x org-watchdoc- | action                                   |</span>
<span class="org-table">|-------------------+------------------------------------------|</span>
<span class="org-table">| add-target        | add target-combination to watchlist      |</span>
<span class="org-table">| remove-target     | remove target-combination from watchlist |</span>
<span class="org-table">| propagate-changes | if md5 changed reexport all combinations |</span>
<span class="org-table">| set-md5           | set org-watchdoc-md5 to current md5      |</span>
<span class="org-superstar-leading">**</span><span class="org-level-3"><span class="org-superstar-header-bullet">*</span></span><span class="org-level-3"> Interactive Use
</span>
In interactive use, this would be the typical order of actions:

<span class="org-list-dt">1.</span> Export first buffer tree to desired doc files (e.g. README-GH.md
   or README-WORG.html). Optional, since adding non-exiting
   target-files in step 2 will cause the exporter to write them the
   when exiting the edit-buffer.

<span class="org-list-dt">2.</span> Add targets with point on first buffer headline.

   Targets are combinations of files the exporter writes to,
   export-template files to be inserted before the exporter does
   its work, and backends the exporter should export to, e.g.

<span class="org-block-begin-line">   #+BEGIN_EXAMPLE
</span><span class="custom">   "/home/me/proj/README-GH.md /home/me/proj/gh-tmpl.org gfm"
   "/home/me/proj/README-WORG.html /home/me/proj/worg-tmpl.org html"
</span><span class="org-block-end-line">   #+END_EXAMPLE
</span>
   The three elements of such a combination are prompted from
   the user.

<span class="org-list-dt">3.</span> Save and set md5 variable.

<span class="org-list-dt">4.</span> Edit the (narrowed) first buffer tree and save

<span class="org-list-dt">5.</span> Propagate changes.

   Since md5 has changed due to the edits, all registered target
   combinations are automatically re-exported.
<span class="org-superstar-leading">**</span><span class="org-level-3"><span class="org-superstar-header-bullet">*</span></span><span class="org-level-3"> Use with Outorg
</span>
Assuming outshine and outorg are installed and active, do once:

<span class="org-list-dt">-</span> Edit as Org

  In the <span class="bold">outorg-edit-buffer</span> do steps 1 and 2 described above
  for direct interactive use.

<span class="org-block-begin-line">#+BEGIN_EXAMPLE
</span><span class="custom">M-x outorg-edit-comments-and-propagate-changes
</span><span class="org-block-end-line">#+END_EXAMPLE
</span>
Then whenever you want to edit the source-buffer's
comment-section and propagate the changes to the watched doc
files, do:

<span class="org-block-begin-line">#+BEGIN_EXAMPLE
</span><span class="custom">M-x outorg-edit-comments-and-propagate-changes
</span><span class="org-block-end-line">#+END_EXAMPLE
</span>
instead of the usual 

<span class="org-block-begin-line">#+BEGIN_EXAMPLE
</span><span class="custom">M-x outorg-edit-comment-as-org
</span><span class="org-block-end-line">#+END_EXAMPLE
</span>
This will

<span class="org-list-dt">-</span> Offer the first buffer tree for editing in the
  <span class="bold">outorg-edit-buffer</span>

<span class="org-list-dt">-</span> Reset `org-watchdoc-md5' immediately after edit-buffer setup

<span class="org-list-dt">-</span> Check if buffer md5 has changed when editing is quitted. If so,
  propagate the changes to the doc files registered in the subtrees
  watchlist.
<span class="org-superstar-leading">**</span><span class="org-level-3"><span class="org-superstar-header-bullet">*</span></span><span class="org-level-3"> Keybindings in Outshine
</span>
Here are the keybindings I added to outshine.el:

<span class="org-block-begin-line">#+BEGIN_EXAMPLE
</span><span class="custom">;; edit comment-section with `outorg' and propagate changes

;; best used with prefix-key 'C-c' 
(define-key map "`" 'outorg-edit-comments-and-propagate-changes)

;; best used with prefix-key 'M-#'
(define-key map "\M-+" 'outorg-edit-comments-and-propagate-changes)
(define-key map "+" 'outorg-edit-comments-and-propagate-changes)
</span><span class="org-block-end-line">#+END_EXAMPLE
</span>
So just like editing e.g. an Emacs Lisp buffer or subtree (with
outshine activated) in full Org-mode only involves pressing M-# M-#
once to start editing, and then M-# to exit the edit-buffer, edting
the comment-section of such a source-buffer and propagating the
changes to several export-targets only involves pressing M-# M-+ once
to start editing, and then M-# to exit the edit buffer (when M-# was
set as outline-minor-mode prefix). 
<span class="org-superstar-leading">**</span><span class="org-level-3"><span class="org-superstar-header-bullet">*</span></span><span class="org-level-3"> ChangeLog
</span>
<span class="org-table">| date            | author(s)       | version |</span>
<span class="org-table">|-----------------+-----------------+---------|</span>
<span class="org-table">| </span><span class="org-table"><span class="org-date">&lt;2014-04-09 Mi&gt;</span></span><span class="org-table"> | Thorsten Jolitz |     0.9 |</span>

<span class="comment"># Emacs 24.3.1 (Org mode 8.2.5h)</span>
</pre>
  </body>
</html>
