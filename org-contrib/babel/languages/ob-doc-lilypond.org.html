<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN">
<!-- Created by htmlize-1.56 in css mode. -->
<html>
  <head>
    <title>ob-doc-lilypond.org</title>
    <style type="text/css">
    <!--
      body {
        color: #d6d6d4;
        background-color: #161719;
      }
      .bold {
        /* bold */
        font-weight: bold;
      }
      .custom {
      }
      .function-name {
        /* font-lock-function-name-face */
        color: #b6e63e;
      }
      .italic {
        /* italic */
        font-style: italic;
      }
      .kc-org-link-url {
        /* kc-org-link-url */
        color: #d02090;
        text-decoration: underline;
      }
      .org-block {
        /* org-block */
        background-color: #000000;
      }
      .org-block-begin-line {
        /* org-block-begin-line */
        color: #696969;
      }
      .org-block-end-line {
        /* org-block-end-line */
        color: #696969;
      }
      .org-code {
        /* org-code */
        color: #dfd05e;
      }
      .org-document-info {
        /* org-document-info */
        color: #fd971f;
      }
      .org-document-info-keyword {
        /* org-document-info-keyword */
        color: #555556;
      }
      .org-document-title {
        /* org-document-title */
        color: #fd971f;
        font-weight: bold;
      }
      .org-hide {
        /* org-hide */
        color: #161719;
      }
      .org-level-1 {
        /* org-level-1 */
        color: #eb4509;
        font-weight: bold;
      }
      .org-level-2 {
        /* org-level-2 */
        color: #f0b144;
        font-weight: bold;
      }
      .org-link {
        /* org-link */
        color: #fd971f;
        font-weight: bold;
        text-decoration: underline;
      }
      .org-list-dt {
        /* org-list-dt */
        color: #e2c770;
      }
      .org-meta-line {
        /* org-meta-line */
        color: #7f7f80;
      }
      .org-superstar-header-bullet {
      }
      .org-verbatim {
        /* org-verbatim */
        color: #b6e63e;
      }
      .string {
        /* font-lock-string-face */
        color: #e2c770;
      }
      .variable-name {
        /* font-lock-variable-name-face */
        color: #fd971f;
      }

      a {
        color: inherit;
        background-color: inherit;
        font: inherit;
        text-decoration: inherit;
      }
      a:hover {
        text-decoration: underline;
      }
    -->
    </style>
  </head>
  <body>
    <pre>
<span class="org-meta-line">#+OPTIONS:    H:3 num:nil toc:2 \n:nil ::t |:t ^:{} -:t f:t *:t tex:t d:(HIDE) tags:not-in-toc</span>
<span class="org-meta-line">#+STARTUP:    align fold nodlcheck hidestars oddeven lognotestate hideblocks</span>
<span class="org-meta-line">#+SEQ_TODO:   TODO(t) INPROGRESS(i) WAITING(w@) | DONE(d) CANCELED(c@)</span>
<span class="org-meta-line">#+TAGS:       Write(w) Update(u) Fix(f) Check(c) noexport(n)</span>
<span class="org-document-info-keyword">#+TITLE:</span>      <span class="org-document-title">Org-babel-lilypond
</span><span class="org-document-info-keyword">#+AUTHOR:</span>     <span class="org-document-info">Martyn Jago
</span><span class="org-meta-line">#+LANGUAGE:   en</span>
<span class="org-meta-line">#+HTML_LINK_UP:    index.html</span>
<span class="org-meta-line">#+HTML_LINK_HOME:  <a href="https://orgmode.org/worg/">https://orgmode.org/worg/</a></span>

<span class="org-block-begin-line">#+begin_export html
</span><span class="org-block">  &lt;</span><span class="org-block"><span class="function-name">div</span></span><span class="org-block"> </span><span class="org-block"><span class="variable-name">id</span></span><span class="org-block">=</span><span class="org-block"><span class="string">"subtitle"</span></span><span class="org-block"> </span><span class="org-block"><span class="variable-name">style</span></span><span class="org-block">=</span><span class="org-block"><span class="string">"float: center; text-align: center;"</span></span><span class="org-block">&gt;
  &lt;</span><span class="org-block"><span class="function-name">p</span></span><span class="org-block">&gt;
  Org Babel support for
  &lt;</span><span class="org-block"><span class="function-name">a</span></span><span class="org-block"> </span><span class="org-block"><span class="variable-name">href</span></span><span class="org-block">=</span><span class="org-block"><span class="string">"<a href="http://lilypond.org/">http://lilypond.org/</a>"</span></span><span class="org-block">&gt;LilyPond (Score Engraving and Arrangement)&lt;/</span><span class="org-block"><span class="function-name">a</span></span><span class="org-block">&gt;
  &lt;/</span><span class="org-block"><span class="function-name">p</span></span><span class="org-block">&gt;
  &lt;</span><span class="org-block"><span class="function-name">p</span></span><span class="org-block">&gt;
  &lt;</span><span class="org-block"><span class="function-name">a</span></span><span class="org-block"> </span><span class="org-block"><span class="variable-name">href</span></span><span class="org-block">=</span><span class="org-block"><span class="string">"<a href="http://lilypond.org/">http://lilypond.org/</a>"</span></span><span class="org-block">&gt;
  &lt;</span><span class="org-block"><span class="function-name">img</span></span><span class="org-block"> </span><span class="org-block"><span class="variable-name">src</span></span><span class="org-block">=</span><span class="org-block"><span class="string">"../../../images/org-lilypond/mixolydian.png"</span></span><span class="org-block">&gt;
  &lt;/</span><span class="org-block"><span class="function-name">a</span></span><span class="org-block">&gt;
  &lt;/</span><span class="org-block"><span class="function-name">p</span></span><span class="org-block">&gt;
  &lt;/</span><span class="org-block"><span class="function-name">div</span></span><span class="org-block">&gt;
</span><span class="org-block-end-line">#+end_export
</span>
<span class="org-level-1"><span class="org-superstar-header-bullet">*</span></span><span class="org-level-1"> Introduction
</span>
LilyPond is a music engraving program devoted to producing the
highest-quality sheet music possible. Org-mode supports lilypond
source code blocks that can generate music scores with optional
auditing via Midi.

<span class="org-level-1"><span class="org-superstar-header-bullet">*</span></span><span class="org-level-1"> Usage
</span>
There are two modes available with ob-lilypond:

  <span class="org-list-dt">-</span> <span class="bold">basic-mode</span> (default)
  <span class="org-list-dt">-</span> <span class="bold">arrange-mode</span>

Which one you use depends on what you intend to do (a quick way to
switch modes is via <span class="org-verbatim">M-x org-babel-lilypond-toggle-arrange-mode</span>).

<span class="org-level-1"><span class="org-superstar-header-bullet">*</span></span><span class="org-level-1"> basic-mode
</span>
<span class="bold">basic-mode</span> (the default) allows you to embed LilyPond snippets into
an Org-mode file, and compile and export them using typical Org-mode
commands (such as <span class="org-verbatim">C-c C-e l p</span> for pdf export). This is useful if you
want to mix blocks of Lilypond-generated score with text, and perhaps
other images to export to Latex, Docbook, pdf, or HTML. In other
words, <span class="bold">basic-mode</span> could be used as a very flexible replacement to
<span class="bold">lilypond-book</span>.

<span class="bold">Warning!</span> in <span class="bold">basic-mode</span> a lilypond source block requires a <span class="org-verbatim">:file</span>
 parameter as shown below, as failure to do so will result in an error
 message.

<span class="org-block-begin-line">#+begin_example
</span><span class="custom">#+begin_src lilypond :file Mixolydian.png
\relative c' {
  g a b c d e f g f e d c b a g a b c d e f g f e d c b a g1
}
#+end_src
</span><span class="org-block-end-line">#+end_example
</span>
The previous block will produce an image file in .png format, which
would be suitable for exporting to HTML for instance.

To generate a nice image for embedding into a pdf or Latex document,
you might consider using the .eps (or .pdf) format as shown in the
example below.

<span class="org-block-begin-line">#+begin_example
</span><span class="custom">#+begin_src lilypond :file Mixolydian.eps
\relative c' {
  g a b c d e f g f e d c b a g a b c d e f g f e d c b a g1
}
#+end_src
</span><span class="org-block-end-line">#+end_example
</span>
<span class="org-level-1"><span class="org-superstar-header-bullet">*</span></span><span class="org-level-1"> Examples
</span>
Following are some examples generated in ob-lilypond Basic Mode.

<span class="bold">Note:</span> Some of the source files used in these examples were published
by Martyn Jago in 2011 and are probably no longer compatible with
recent versions of Org and LilyPond.

<span class="org-hide">*</span><span class="org-level-2"><span class="org-superstar-header-bullet">*</span></span><span class="org-level-2"> PDF export
</span>
<span class="org-list-dt">-</span> <span class="kc-org-link-url"><a href="https://github.com/mjago/ob-lilypond/blob/master/examples/basic-mode/pdf-example/pdf-example.pdf?raw=true">Here is an example</a></span> of a pdf file containing high quality vector
  graphics generated by Org and ob-lilypond.
<span class="org-list-dt">-</span> <span class="kc-org-link-url"><a href="https://raw.github.com/mjago/ob-lilypond/master/examples/basic-mode/pdf-example/pdf-example.org">and the Org file</a></span> that compiled the LilyPond snippets and exported
  the pdf.

<span class="org-hide">*</span><span class="org-level-2"><span class="org-superstar-header-bullet">*</span></span><span class="org-level-2"> HTML export
</span>
<span class="org-list-dt">-</span> <span class="kc-org-link-url"><a href="https://github.com/mjago/ob-lilypond/raw/master/examples/basic-mode/html-example/html-example.html">Here is an example</a></span> of an html page containing images (png) generated
  by Org-mode and ob-lilypond.
<span class="org-list-dt">-</span> <span class="kc-org-link-url"><a href="https://raw.github.com/mjago/ob-lilypond/master/examples/basic-mode/html-example/html-example.org">and the Org file</a></span> that compiled the LilyPond snippets and exported
  the html page.

<span class="org-level-1"><span class="org-superstar-header-bullet">*</span></span><span class="org-level-1"> Compiling LilyPond Blocks
</span>
In <span class="bold">basic-mode</span> the key sequence <span class="org-verbatim">C-c C-c</span> within a Lilypond block
will compile the block. Exporting of all blocks and Org file contents
is initiated with the sequence <span class="org-verbatim">C-c C-e</span> (standard Org-mode export
keys).

<span class="org-level-1"><span class="org-superstar-header-bullet">*</span></span><span class="org-level-1"> Arrange Mode
</span>
<span class="bold">arrange-mode</span> allows you to develop complete pieces of score, whilst
organizing sections of the piece using typical Org-mode
techniques. And because you are in Org-mode, you are free to use
Literate Programming techniques to do things programatically, like
storing information in tables etc.

In addition, there are automated features to automatically audition
the piece (via MIDI) and or display the resultant pdf output.

To change the default mode to Arrange Mode, put the following in your
Emacs init file:

<span class="org-code">: (setq org-babel-lilypond-arrange-mode t)
</span>
...or to temporarily switch between modes use the following command:

<span class="org-code">: M-x org-babel-lilypond-toggle-arrange-mode
</span>
Following are examples generated using ob-lilypond in Arrange Mode.

<span class="org-hide">*</span><span class="org-level-2"><span class="org-superstar-header-bullet">*</span></span><span class="org-level-2"> Modal Cycles
</span>
<span class="org-list-dt">-</span> <span class="kc-org-link-url"><a href="https://github.com/mjago/ob-lilypond/blob/master/examples/arrange-mode/Modal-Cycle/modal-cycle.pdf?raw=true">Modal Cycles (Utilises org-babel and noweb to generate notes)</a></span> (pdf)
<span class="org-list-dt">-</span> <span class="kc-org-link-url"><a href="https://github.com/mjago/ob-lilypond/blob/master/examples/arrange-mode/Modal-Cycle/modal-cycle.midi?raw=true">Generated Midi File</a></span>
<span class="org-list-dt">-</span> <span class="kc-org-link-url"><a href="https://raw.github.com/mjago/ob-lilypond/master/examples/arrange-mode/Modal-Cycle/modal-cycle.org">Source Org File</a></span>

<span class="org-hide">*</span><span class="org-level-2"><span class="org-superstar-header-bullet">*</span></span><span class="org-level-2"> Modal Cycles 2
</span>
<span class="org-list-dt">-</span> <span class="kc-org-link-url"><a href="https://github.com/mjago/ob-lilypond/blob/master/examples/arrange-mode/Modal-Cycle-2/modal-cycle-2.pdf?raw=true">Modal Cycles 2 (Utilises org-babel and noweb to generate notes)</a></span> (pdf)
<span class="org-list-dt">-</span> <span class="kc-org-link-url"><a href="https://github.com/mjago/ob-lilypond/blob/master/examples/arrange-mode/Modal-Cycle-2/modal-cycle-2.midi?raw=true">Generated Midi File</a></span>
<span class="org-list-dt">-</span> <span class="kc-org-link-url"><a href="https://raw.github.com/mjago/ob-lilypond/master/examples/arrange-mode/Modal-Cycle-2/modal-cycle-2.org">Source Org File</a></span>

<span class="org-hide">*</span><span class="org-level-2"><span class="org-superstar-header-bullet">*</span></span><span class="org-level-2"> Modes in the Key of C
</span>
<span class="org-list-dt">-</span> <span class="kc-org-link-url"><a href="https://github.com/mjago/ob-lilypond/blob/master/examples/arrange-mode/Modes-in-Key-of-C/modes-in-key-of-c.pdf?raw=true">Modes in the Key of C (another example of polyglot lilypond programming)</a></span> (pdf)
<span class="org-list-dt">-</span> <span class="kc-org-link-url"><a href="https://github.com/mjago/ob-lilypond/blob/master/examples/arrange-mode/Modes-in-Key-of-C/modes-in-key-of-c.midi?raw=true">Generated Midi File</a></span>
<span class="org-list-dt">-</span> <span class="kc-org-link-url"><a href="https://raw.github.com/mjago/ob-lilypond/master/examples/arrange-mode/Modes-in-Key-of-C/modes-in-key-of-c.org">Source Org File</a></span>

<span class="org-level-1"><span class="org-superstar-header-bullet">*</span></span><span class="org-level-1"> Tangling and Compiling LilyPond Blocks
</span>
In <span class="bold">arrange-mode</span>, the key sequence <span class="org-verbatim">C-c C-c</span> within a Lilypond block
initiates <span class="org-verbatim">org-babel-lilypond-tangle</span> (tangling of all Lilypond blocks
within the current Org file). Depending on the feature settings,
ob-lilypond will then either <span class="italic">display a pdf</span> of the score, <span class="italic">play the
generated MIDI file</span>, both, or neither.

The command <span class="org-verbatim">M-x org-babel-lilypond-tangle</span> can also be called from
anywhere in the file and could be tied to a function key with
something like:

<span class="org-code">: (global-set-key [f8] 'org-babel-lilypond-tangle)
</span>
Some commands are included in arrange-mode to quickly enable/disable
certain post-tangle activities, including:

<span class="org-list-dt">-</span> <span class="org-verbatim">org-babel-lilypond-toggle-midi-play</span> (toggle whether midi will be
  played following a successful compilation)
<span class="org-list-dt">-</span> <span class="org-verbatim">org-babel-lilypond-toggle-pdf-display</span> (toggle whether pdf will be
  displayed following a successful compilation)

<span class="bold">Note:</span> If using <span class="kc-org-link-url"><a href="http://timidity.sourceforge.net/">Timidity</a></span> for MIDI playback, kill the MIDI stream with
<span class="org-verbatim">C-g</span> in Emacs.

<span class="org-level-1"><span class="org-superstar-header-bullet">*</span></span><span class="org-level-1"> Setup
</span>
By default, <span class="org-verbatim">ob-lilypond</span> is included in the latest Org-mode. For
information on obtaining the latest Org-mode follow this link to the
<span class="kc-org-link-url"><a href="https://orgmode.org/manual/Installation.html">Org-mode Manual</a></span> and follow the instructions.

Then, add lilypond to your list of babel languages (in your init
file):

<span class="org-block-begin-line">#+begin_example
</span><span class="custom">(org-babel-do-load-languages
 'org-babel-load-languages
 '((emacs-lisp . t)
   (org . t)
   (lilypond . t)))
</span><span class="org-block-end-line">#+end_example
</span>
Alternatively, you may <span class="bold">require</span> the ob-lilypond babel language directly:

<span class="org-code">: (require 'ob-lilypond)
</span>
To ensure all is correct consider <span class="bold">running the tests</span> (see below).

<span class="org-level-1"><span class="org-superstar-header-bullet">*</span></span><span class="org-level-1"> Requirements
</span>
<span class="org-hide">*</span><span class="org-level-2"><span class="org-superstar-header-bullet">*</span></span><span class="org-level-2"> Mac OS X
</span>
<span class="org-list-dt">-</span> LilyPond may be <span class="kc-org-link-url"><a href="http://lilypond.org/">downloaded here</a></span>.

<span class="org-hide">*</span><span class="org-level-2"><span class="org-superstar-header-bullet">*</span></span><span class="org-level-2"> Nix
</span>
<span class="org-list-dt">-</span> LilyPond is <span class="kc-org-link-url"><a href="http://lilypond.org/">available here</a></span> or via the the system-relevant package manager.
<span class="org-list-dt">-</span> For MIDI, <span class="bold">Timidity</span> is <span class="kc-org-link-url"><a href="http://timidity.sourceforge.net/">available here</a></span> or via the system-relevant package manager.
<span class="org-list-dt">-</span> For pdf, <span class="bold">Evince</span> is <span class="kc-org-link-url"><a href="https://wiki.gnome.org/Apps/Evince">available here</a></span> or via package manager.

<span class="org-hide">*</span><span class="org-level-2"><span class="org-superstar-header-bullet">*</span></span><span class="org-level-2"> Win32
</span>
<span class="org-list-dt">-</span> Currently untested, although it should be made to work with minimal fuss.

<span class="org-level-1"><span class="org-superstar-header-bullet">*</span></span><span class="org-level-1"> Testing
</span>
Tests are provided and can be executed by running the following
commands (for more help and information on testing see <span class="org-link"><a href="file:../../../org-tests/index.org">Testing Org</a></span>):

<span class="org-code">: M-x load-file RET  testing/lisp/test-ob-lilypond.el
: M-x ert t
</span>
<span class="org-level-1"><span class="org-superstar-header-bullet">*</span></span><span class="org-level-1"> Issues
</span>
Any issues should be reported to the <span class="kc-org-link-url"><a href="https://orgmode.org">Org-mode Mailing-list</a></span>
</pre>
  </body>
</html>
