<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN">
<!-- Created by htmlize-1.56 in css mode. -->
<html>
  <head>
    <title>index.org</title>
    <style type="text/css">
    <!--
      body {
        color: #d6d6d4;
        background-color: #161719;
      }
      .bold {
        /* bold */
        font-weight: bold;
      }
      .comment {
        /* font-lock-comment-face */
        color: #696969;
      }
      .italic {
        /* italic */
        font-style: italic;
      }
      .kc-org-link-url {
        /* kc-org-link-url */
        color: #d02090;
        text-decoration: underline;
      }
      .org-code {
        /* org-code */
        color: #dfd05e;
      }
      .org-document-info {
        /* org-document-info */
        color: #fd971f;
      }
      .org-document-info-keyword {
        /* org-document-info-keyword */
        color: #555556;
      }
      .org-document-title {
        /* org-document-title */
        color: #fd971f;
        font-weight: bold;
      }
      .org-hide {
        /* org-hide */
        color: #161719;
      }
      .org-level-1 {
        /* org-level-1 */
        color: #eb4509;
        font-weight: bold;
      }
      .org-level-2 {
        /* org-level-2 */
        color: #f0b144;
        font-weight: bold;
      }
      .org-level-3 {
        /* org-level-3 */
        color: #8ec298;
        font-weight: bold;
      }
      .org-link {
        /* org-link */
        color: #fd971f;
        font-weight: bold;
        text-decoration: underline;
      }
      .org-list-dt {
        /* org-list-dt */
        color: #e2c770;
      }
      .org-meta-line {
        /* org-meta-line */
        color: #7f7f80;
      }
      .org-special-keyword {
        /* org-special-keyword */
        color: #7f7f80;
      }
      .org-superstar-header-bullet {
      }
      .org-verbatim {
        /* org-verbatim */
        color: #b6e63e;
      }

      a {
        color: inherit;
        background-color: inherit;
        font: inherit;
        text-decoration: inherit;
      }
      a:hover {
        text-decoration: underline;
      }
    -->
    </style>
  </head>
  <body>
    <pre>
<span class="org-document-info-keyword">#+TITLE:</span>      <span class="org-document-title">Testing Org
</span><span class="org-document-info-keyword">#+AUTHOR:</span>     <span class="org-document-info">Worg people
</span><span class="org-document-info-keyword">#+EMAIL:</span>      <span class="org-document-info">bzg AT altern DOT org
</span><span class="org-meta-line">#+OPTIONS:    H:3 num:nil toc:t \n:nil ::t |:t ^:t -:t f:t *:t tex:t d:(HIDE) tags:not-in-toc</span>
<span class="org-meta-line">#+STARTUP:    align fold nodlcheck hidestars oddeven lognotestate</span>
<span class="org-meta-line">#+SEQ_TODO:   TODO(t) INPROGRESS(i) WAITING(w@) | DONE(d) CANCELED(c@)</span>
<span class="org-meta-line">#+TAGS:       Write(w) Update(u) Fix(f) Check(c) NEW(n)</span>
<span class="org-meta-line">#+LANGUAGE:   en</span>
<span class="org-meta-line">#+PRIORITIES: A C B</span>
<span class="org-meta-line">#+CATEGORY:   worg</span>

<span class="comment"># This file is released by its authors and contributors under the GNU</span>
<span class="comment"># Free Documentation license v1.3 or later, code examples are released</span>
<span class="comment"># under the GNU General Public License v3 or later.</span>

<span class="comment"># This file is the default header for new Org files in Worg.  Feel free</span>
<span class="comment"># to tailor it to your needs.</span>

<span class="org-link"><a href="file:../index.org">{Back to Worg's index}</a></span>

<span class="org-level-1"><span class="org-superstar-header-bullet">*</span></span><span class="org-level-1"> Why test?
</span>
Org-mode has grown into a popular large and feature-rich application,
on which development often happens at a great pace. Indeed, feature
requests posted on the <span class="org-link"><a href="file:../org-mailing-list.org">Org mailing list</a></span> are frequently developed and
published within hours of the request.

The down-side of such rapid development is that on some occasions, one
of the many patches, features, or <span class="kc-org-link-url"><a href="https://en.wikipedia.org/wiki/Code_refactoring">refactorings</a></span> being applied to the
code-base may unintentionally cause unexpected behavior within
Org-mode. This is known as a <span class="kc-org-link-url"><a href="https://en.wikipedia.org/wiki/Software_regression">software regression</a></span>. The larger and more
complex Org-mode becomes, the more you may expect to see such software
regressions.

One concern with introducing software regressions is that the
regression may not be immediately obvious to users. Indeed it can be
hours, days, or even months before an Org-mode user moves to export an
important schedule, when "bang" - the regression has reared its ugly
head.

The solution to avoiding software regressions? <span class="kc-org-link-url"><a href="https://en.wikipedia.org/wiki/Regression_testing">Regression Testing!</a></span>
With a regression test suite the developer can run the tests prior to
committing their change, to ensure their additions do not break the
regression tests.

Naturally, a regression test suite is only as good as the number,
quality, and coverage of regression tests within it, and this is where
Org-mode users can help.

<span class="org-level-1"><span class="org-superstar-header-bullet">*</span></span><span class="org-level-1"> Running the current test suite
</span>
So long as you are on an up-to-date release of Org-mode you may run
the tests on your local setup. To update Org-mode check out the <span class="kc-org-link-url"><a href="https://orgmode.org/worg/org-faq.html">org
FAQ page</a></span>. Note, the test suite will run on versions of Emacs back to
version 22.

A pre-requisite for running the tests is the <span class="kc-org-link-url"><a href="http://www.emacswiki.org/emacs/ErtTestLibrary">ERT test library</a></span>. This
may be obtained easily as follows.

<span class="org-hide">*</span><span class="org-level-2"><span class="org-superstar-header-bullet">*</span></span><span class="org-level-2"> Emacs-22 / Emacs-23
</span>
In Emacs-22 and Emacs-23 you will need to download the test files
<span class="bold">ert.el</span> and <span class="bold">ert-x.el</span> to your testing directory. This may be
accomplished with the following commands entered on the command line.

<span class="org-code">: cd /path/to/org-mode/testing
: curl -O <a href="https://github.com/mirrors/emacs/raw/master/lisp/emacs-lisp/ert.el">https://github.com/mirrors/emacs/raw/master/lisp/emacs-lisp/ert.el</a>
: curl -O <a href="https://github.com/mirrors/emacs/raw/master/lisp/emacs-lisp/ert-x.el">https://github.com/mirrors/emacs/raw/master/lisp/emacs-lisp/ert-x.el</a>
</span>
Alternatively you may download the files within your browser.

 <span class="org-list-dt">-</span> browse to <span class="kc-org-link-url"><a href="https://github.com/mirrors/emacs/tree/master/lisp/emacs-lisp">github.com/mirrors/emacs/lisp/emacs-lisp</a></span>
 <span class="org-list-dt">-</span> right click ert.el link and select <span class="bold">download linked file</span> (or
   equivalent) and save to org-mode/testing/ert.el
 <span class="org-list-dt">-</span> right click ert-x.el link and select <span class="bold">download linked file</span> (or
   equivalent) and save to org-mode/testing/ert-x.el

That's it - you may now run the tests.

<span class="org-hide">*</span><span class="org-level-2"><span class="org-superstar-header-bullet">*</span></span><span class="org-level-2"> Emacs-24
</span>
Emacs-24 includes ERT, so nothing to do.

<span class="org-hide">*</span><span class="org-level-2"><span class="org-superstar-header-bullet">*</span></span><span class="org-level-2"> Run tests from the command line
</span>
To run the tests from the command line (without loading your personal
configurations) use the following commands (Note, if you have more
than one version of Emacs on your system, you may need to include the
full path to the required Emacs executable).

<span class="org-code">: cd /path/to/org-mode/testing
: Emacs -Q -batch -l org-test.el -eval "(setq org-confirm-babel-evaluate nil)" -f org-test-run-batch-tests'
</span>
In recent versions of Emacs and Org-mode a test run can be triggered
using the <span class="org-verbatim">make</span> program.

<span class="org-code">: cd /path/to/org-mode
: make test
</span>
<span class="org-hide">*</span><span class="org-level-2"><span class="org-superstar-header-bullet">*</span></span><span class="org-level-2"> Run tests from within Emacs
</span>
To run the tests from within Emacs itself.

<span class="org-code">: M-x load-file RET /path/to/org-mode/testing/org-test.el
: M-x org-test-run-all-tests
</span>
<span class="org-level-1"><span class="org-superstar-header-bullet">*</span></span><span class="org-level-1"> Writing tests with minimal Emacs-lisp knowledge
</span>
Thanks to the growing number of test-macros that are being made
available, it is becoming easier to write regression tests with
minimal lisp knowledge, and you are also likely to greatly improve
your knowledge of Emacs-lisp as a result. And the more tests you
write, the more confident you may be that your personal use of the
many Org-mode features available has not been affected by regression.

And of course, any help toward improving the Org-mode test-suite is
highly appreciated.

<span class="org-level-1"><span class="org-superstar-header-bullet">*</span></span><span class="org-level-1"> Preparing to write tests
</span>
Coming soon...

<span class="org-level-1"><span class="org-superstar-header-bullet">*</span></span><span class="org-level-1"> Tutorial
</span>
Coming soon...

<span class="org-level-1"><span class="org-superstar-header-bullet">*</span></span><span class="org-level-1"> Testing Utilities
</span>
Several useful utilities exist to make the practice of writing tests
even easier. These are available from the Org-mode repository as a
seperate git sub-module. Assuming you have cloned Org-mode using git,
you may install these extra utilities with the following git commands.

<span class="org-code">: cd /path/to/org-mode
: git submodule init
: git submodule update
</span>
<span class="org-level-1"><span class="org-superstar-header-bullet">*</span></span><span class="org-level-1"> Aims
</span>
<span class="org-list-dt">-</span> Help all non-programmers to help:
  <span class="org-list-dt">-</span> Link to tutorials on debugging, emacs debugger...

<span class="org-list-dt">-</span> Create simple packages with test data, and place them here for download:
  <span class="org-list-dt">-</span> Directory trees with org-files for export-stress-testing.
  <span class="org-list-dt">-</span> One Org-file per bug to prevent regression.
  <span class="org-list-dt">-</span> Name and add corner cases.

<span class="org-list-dt">-</span> Create automated tests to programm against.

<span class="org-level-1"><span class="org-superstar-header-bullet">*</span></span><span class="org-level-1"> Ideas for test
</span>
<span class="org-list-dt">-</span> Verify the output of tests with tools like <span class="org-verbatim">diff</span> (think <span class="italic">export</span> here).
<span class="org-list-dt">-</span> <span class="kc-org-link-url"><a href="http://www.emacswiki.org/emacs-fr/UnitTesting">http://www.emacswiki.org/emacs-fr/UnitTesting</a></span>

<span class="org-level-1"><span class="org-superstar-header-bullet">*</span></span><span class="org-level-1"> What we need to know to actually write tests
</span>
The tutorial I'd need to write a test is one which lays out code I
could copy and paste to do the following:

<span class="org-hide">*</span><span class="org-level-2"><span class="org-superstar-header-bullet">*</span></span><span class="org-level-2"> setup the test environment
</span>
   <span class="org-list-dt">-</span> create a test directory
   <span class="org-list-dt">-</span> create a sample test.org file
   <span class="org-list-dt">-</span> put the cursor in a particular place

<span class="org-hide">*</span><span class="org-level-2"><span class="org-superstar-header-bullet">*</span></span><span class="org-level-2"> run the command we need to test
</span>
  <span class="org-list-dt">-</span> hit the <span class="org-verbatim">TAB</span> key, or <span class="org-verbatim">C-c C-c</span> (some folks might need to be reminded how to
    find out exactly what command is actually being run  when you hit a
    keystroke. And some of me might need to be told what  lisp-code to use when
    the keystroke runs different commands at  different places in a file)
  <span class="org-list-dt">-</span> reformat a table
  <span class="org-list-dt">-</span> clock in/out
  <span class="org-list-dt">-</span> create the agenda
  <span class="org-list-dt">-</span> export .html .ics .dvi files

<span class="org-hide">*</span><span class="org-level-2"><span class="org-superstar-header-bullet">*</span></span><span class="org-level-2"> How do we specify the correct result???
</span>
  <span class="org-list-dt">-</span> check that the headline folded properly.  What's the lisp code for getting
    the folded string as displayed?
  <span class="org-list-dt">-</span> check that the cursor is where it should be? Especially when the cursor is
    near elipses...
  <span class="org-list-dt">-</span> check that the agenda is built properly.  What's the lisp code for getting
    the agenda as a string?
  <span class="org-list-dt">-</span> check that the exported files are correct.  Maybe the right suggestion is to
    run the export on two different files, so the test  can focus on the 'diff'
    between them.  That way different people who  run the same test on different
    hosts can get the same result.


<span class="org-hide">**</span><span class="org-level-3"><span class="org-superstar-header-bullet">*</span></span><span class="org-level-3"> ERT Example
</span>
I implemented a toy test of org's html export facility using ert.el.
See <span class="org-link"><a href="file:../code/elisp/ert-publish-test.el">file:../code/elisp/ert-publish-test.el</a></span> for the implementation.  To run the test
open up org-publish-test.el, and <span class="org-verbatim">M-x eval-buffer</span>.  This should load
ert, and run the simple html export test.

<span class="org-level-1"><span class="org-superstar-header-bullet">*</span></span><span class="org-level-1"> </span><span class="org-special-keyword">COMMENT</span><span class="org-level-1"> buffer dictionary
</span>
 LocalWords:  ert el EmacsLispExpectations org's
</pre>
  </body>
</html>
