<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2021-06-15 Tue 18:21 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Org ad hoc code, quick hacks and workarounds</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="Worg people" />
<link rel="stylesheet" type="text/css" href="src/readtheorg_theme/css/htmlize.css"/>
 <link rel="stylesheet" type="text/css" href="src/readtheorg_theme/css/readtheorg.css"/>
 <script type="text/javascript" src="src/lib/js/jquery.min.js"></script>
 <script type="text/javascript" src="src/lib/js/bootstrap.min.js"></script>
 <script type="text/javascript" src="src/lib/js/jquery.stickytableheaders.min.js"></script>
 <script type="text/javascript" src="src/readtheorg_theme/js/readtheorg.js"></script>
<script type="text/javascript">
// @license magnet:?xt=urn:btih:1f739d935676111cfff4b4693e3816e664797050&amp;dn=gpl-3.0.txt GPL-v3-or-Later
<!--/*--><![CDATA[/*><!--*/
     function CodeHighlightOn(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.cacheClassElem = elem.className;
         elem.cacheClassTarget = target.className;
         target.className = "code-highlighted";
         elem.className   = "code-highlighted";
       }
     }
     function CodeHighlightOff(elem, id)
     {
       var target = document.getElementById(id);
       if(elem.cacheClassElem)
         elem.className = elem.cacheClassElem;
       if(elem.cacheClassTarget)
         target.className = elem.cacheClassTarget;
     }
    /*]]>*///-->
// @license-end
</script>
</head>
<body>
<div id="org-div-home-and-up">
 <a accesskey="h" href="index.html"> UP </a>
 |
 <a accesskey="H" href="https://orgmode.org/worg/"> HOME </a>
</div><div id="content">
<h1 class="title">Org ad hoc code, quick hacks and workarounds</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#orgdc1d04f">Hacking Org: Working within Org-mode</a>
<ul>
<li><a href="#org8aa1613">Org Agenda</a>
<ul>
<li><a href="#org856d2b4">Colorize clocking tasks with a block</a></li>
<li><a href="#org457b287">Picking up a random task in the global TODO list</a></li>
</ul>
</li>
<li><a href="#orgedcff1d">Building and Managing Org</a>
<ul>
<li><a href="#compiling-org-without-make">Generating autoloads and Compiling Org without make</a></li>
<li><a href="#org6af50ca">Reload Org</a></li>
<li><a href="#check-old-link-escapes">Check for possibly problematic old link escapes</a></li>
</ul>
</li>
<li><a href="#orgeab2a9e">Structure Movement and Editing</a>
<ul>
<li><a href="#org884dfb9">Go back to the previous top-level heading</a></li>
<li><a href="#org-jump-to-child">Go to a child of the current heading</a></li>
<li><a href="#org-jump-to-id">Go to a heading by its ID (<code>CUSTOM_ID</code> property)</a></li>
<li><a href="#org6d09456">Show next/prev heading tidily</a></li>
<li><a href="#orgce28e41">Promote all items in subtree</a></li>
<li><a href="#heading-to-link">Turn a heading into an Org link</a></li>
<li><a href="#org1767f2d">Using M-up and M-down to transpose paragraphs</a></li>
<li><a href="#org42a8b99">Changelog support for org headers</a></li>
<li><a href="#org094c193">Different org-cycle-level behavior</a></li>
<li><a href="#orgd8ca056">Count words in an Org buffer</a></li>
<li><a href="#check-for-misplaced-timestamps">Check for misplaced SCHEDULED and DEADLINE cookies</a></li>
<li><a href="#org37f0229">Sorting list by checkbox type</a></li>
<li><a href="#orgdf3e5af">Adding Licenses to org files</a></li>
</ul>
</li>
<li><a href="#Tables">Org Table</a>
<ul>
<li><a href="#align-tables-in-file">Align all tables in a file</a></li>
<li><a href="#transpose-table">Transpose table</a></li>
<li><a href="#org2818e72">Manipulate hours/minutes/seconds in table formulas</a></li>
<li><a href="#org93902ed">Dates computation</a></li>
<li><a href="#orgc2f288e">Hex computation</a></li>
<li><a href="#field-coordinates-in-formulas">Field coordinates in formulas (<code>@#</code> and <code>$#</code>)</a></li>
<li><a href="#field-same-row-or-column">Rearrange one or more field within the same row or column</a></li>
</ul>
</li>
<li><a href="#org3276319">Capture and Remember</a>
<ul>
<li><a href="#org6117d7a">Customize the size of the frame for remember</a></li>
<li><a href="#org225be6d">User-defined capture template variables with prompt and completion list</a></li>
<li><a href="#org90c4936">Ensure blank lines between headings and before contents</a></li>
</ul>
</li>
<li><a href="#org9c46336">Handling Links</a>
<ul>
<li><a href="#org90b24f4">Turn a heading into an org link</a></li>
<li><a href="#org860f0c6">Quickaccess to the link part of hyperlinks</a></li>
<li><a href="#orgbf5b90e">Insert link with HTML title as default description</a></li>
</ul>
</li>
<li><a href="#archiving">Archiving Content in Org-Mode</a>
<ul>
<li><a href="#orga959431">Preserve top level headings when archiving to a file</a></li>
<li><a href="#org7c5bc17">Archive in a date tree</a></li>
<li><a href="#org62a9570">Add inherited tags to archived entries</a></li>
</ul>
</li>
<li><a href="#orga2b9150">Using and Managing Org-Metadata</a>
<ul>
<li><a href="#remove-redundant-tags">Remove redundant tags of headlines</a></li>
<li><a href="#remove-empty-property-drawers">Remove empty property drawers</a></li>
<li><a href="#orgd59deb9">Group task list by a property</a></li>
<li><a href="#orgbe5a967">A way to tag a task so that when clocking-out user is prompted to take a note.</a></li>
<li><a href="#orge247149">Dynamically adjust tag position</a></li>
<li><a href="#orgbdb88b5">Use an &ldquo;attach&rdquo; link type to open files without worrying about their location</a></li>
</ul>
</li>
<li><a href="#org31aec6b">Org Agenda and Task Management</a>
<ul>
<li><a href="#org9dde2f1">Make it easier to set org-agenda-files from multiple directories</a></li>
<li><a href="#set-agenda-files-by-filetag">Restrict org-agenda-files by filetag</a></li>
<li><a href="#org44cb5e8">Highlight the agenda line under cursor</a></li>
<li><a href="#orga5da6c6">Split frame horizontally for agenda</a></li>
<li><a href="#org020e380">Automatically add an appointment when clocking in a task</a></li>
<li><a href="#org76c939a">Using external programs for appointments reminders</a></li>
<li><a href="#org04b6749">Remove from agenda time grid lines that are in an appointment</a></li>
<li><a href="#org9e5321e">Disable version control for Org mode agenda files</a></li>
<li><a href="#org9f3aefa">Easy customization of TODO colors</a></li>
<li><a href="#org6b4b736">Add an effort estimate on the fly when clocking in</a></li>
<li><a href="#org7e9d8f1">Use idle timer for automatic agenda views</a></li>
<li><a href="#orgdb040ad">Refresh the agenda view regularly</a></li>
<li><a href="#org29fe039">Reschedule agenda items to today with a single command</a></li>
<li><a href="#org3fdd9b1">Mark subtree DONE along with all subheadings</a></li>
<li><a href="#mark-done-when-all-checkboxes-checked">Mark heading done when all checkboxes are checked.</a></li>
<li><a href="#links-to-agenda-views">Links to custom agenda views</a></li>
</ul>
</li>
<li><a href="#org63a9cd1">Exporting org files</a>
<ul>
<li><a href="#ignoreheadline">Ignoring headlines during export</a></li>
<li><a href="#org7367a31">Export Org to Org and handle includes.</a></li>
<li><a href="#latex-command-for-floats">Specifying LaTeX commands to floating environments</a></li>
<li><a href="#orgac875b1">Styling code sections with CSS</a></li>
<li><a href="#orgb41caee">Where can I find nice themes for HTML export?</a></li>
<li><a href="#orgf8f4948">Including external text fragments</a></li>
</ul>
</li>
<li><a href="#org4a463a2">Babel</a>
<ul>
<li><a href="#orge2628a4">How do I preview LaTeX fragments when in a LaTeX source block?</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org60792b4">Hacking Org: Working with Org-mode and other Emacs Packages</a>
<ul>
<li><a href="#org76d0082">How to ediff folded Org files</a></li>
<li><a href="#orgec6af19">org-remember-anything</a></li>
<li><a href="#orga7e2b33">Org-mode and saveplace.el</a></li>
<li><a href="#org0ceec78">Using ido-mode for org-refile (and archiving via refile)</a></li>
<li><a href="#org6dbd0f3">Using ido-completing-read to find attachments</a></li>
<li><a href="#orgd82b4a2">Link to Gnus messages by Message-Id</a></li>
<li><a href="#orge37b115">Store link to a message when sending in Gnus</a></li>
<li><a href="#orga71fa75">Link to visit a file and run occur</a></li>
<li><a href="#org7280e31">Send html messages and attachments with Wanderlust</a>
<ul>
<li><a href="#orgae7c088">Send HTML message</a></li>
<li><a href="#org77b37de">Attach HTML of region or subtree</a></li>
<li><a href="#orga8b485d">Adopting for Gnus</a></li>
</ul>
</li>
<li><a href="#orgc676383">Add sunrise/sunset times to the agenda.</a></li>
<li><a href="#orge997dee">Add lunar phases to the agenda.</a></li>
<li><a href="#org423998a">Export BBDB contacts to org-contacts.el</a></li>
<li><a href="#org7d74c0f">Calculating date differences - how to write a simple elisp function</a></li>
<li><a href="#org68f7629">ibuffer and org files</a></li>
<li><a href="#org2b7c01c">Enable org-mode links in other modes</a></li>
<li><a href="#org793a6c0">poporg.el: edit comments in org-mode</a></li>
<li><a href="#orgea3c04b">Convert a .csv file to an Org-mode table</a></li>
<li><a href="#org743f2ac">Don&rsquo;t let visual-line-mode shadow org special commands</a></li>
<li><a href="#org879688d">foldout.el</a></li>
<li><a href="#org2caff77">Integrate Org Capture with YASnippet and Yankpad</a></li>
<li><a href="#org9139190">Slack messages as TODOs in your Org Agenda</a></li>
</ul>
</li>
<li><a href="#orgb8db2e9">Hacking Org: Working with Org-mode and External Programs</a>
<ul>
<li><a href="#org1da93de">Use Org-mode with Screen [Andrew Hyatt]</a></li>
<li><a href="#org-agenda-appt-zenity">Org Agenda + Appt + Zenity</a></li>
<li><a href="#org020bac9">Org and appointment notifications on Mac OS 10.8</a></li>
<li><a href="#orgfa3d353">Org-Mode + gnome-osd</a></li>
<li><a href="#org6fd1bd6">txt2org convert text data to org-mode tables</a></li>
<li><a href="#orgd1e1775">remind2org</a></li>
<li><a href="#orgf8cacd4">Useful webjumps for conkeror</a></li>
<li><a href="#org1f94fcc">Use MathJax for HTML export without requiring JavaScript</a></li>
<li><a href="#orgdda3c11">Use checkboxes and progress cookies in HTML generated from Org</a></li>
<li><a href="#org74c85c8">Search Org files using lgrep</a></li>
<li><a href="#orgf1ff98d">Automatic screenshot insertion</a></li>
<li><a href="#org9747b62">Capture invitations/appointments from MS Exchange emails</a></li>
<li><a href="#org38ad37e">Audio/video file playback within org mode</a></li>
<li><a href="#orgdae4a73">Under X11 Keep a window with the current agenda items at all time</a></li>
<li><a href="#org3f66225">Script (thru procmail) to output emails to an Org file</a></li>
<li><a href="#fileconversion">Save File With Different Format for Headings (fileconversion)</a>
<ul>
<li><a href="#hidestarsfile">Headings Without Leading Stars (hidestarsfile and nbspstarsfile)</a></li>
<li><a href="#markdownstarsfile">Headings in Markdown Format (markdownstarsfile)</a></li>
<li><a href="#fileconversion-code">emacs-lisp code</a></li>
</ul>
</li>
<li><a href="#orgc66c300">Meaningful diff for org files in a git repository</a></li>
<li><a href="#orgbee7bd8">Opening devonthink links</a></li>
<li><a href="#org8d27a32">Memacs - Org-mode collecting meta-data from the disk and cloud</a></li>
<li><a href="#org80c74f7">Displaying Vega and Vega lite graphs with org</a></li>
<li><a href="#orgf3264ff">Emacs as an Org capture server</a></li>
</ul>
</li>
<li><a href="#orgca743e5">Musings</a>
<ul>
<li><a href="#orgb875a28">Cooking?  Brewing?</a></li>
</ul>
</li>
</ul>
</div>
</div>
<p>
This page is for ad hoc bits of code. Feel free to add quick hacks and
workaround. Go crazy.
</p>

<div id="outline-container-orgdc1d04f" class="outline-2">
<h2 id="orgdc1d04f">Hacking Org: Working within Org-mode</h2>
<div class="outline-text-2" id="text-orgdc1d04f">
</div>
<div id="outline-container-org8aa1613" class="outline-3">
<h3 id="org8aa1613">Org Agenda</h3>
<div class="outline-text-3" id="text-org8aa1613">
</div>
<div id="outline-container-org856d2b4" class="outline-4">
<h4 id="org856d2b4">Colorize clocking tasks with a block</h4>
<div class="outline-text-4" id="text-org856d2b4">
<p>
Show Org Agenda tasks with heigh spacing based on clock time with <code>org-agenda-log-mode</code>.
</p>


<div class="figure">
<p><img src="images/agenda/org-agenda-colorized-blocks.png" alt="org-agenda-colorized-blocks.png" />
</p>
</div>

<p>
Here is original author&rsquo;s post <a href="https://emacs-china.org/t/org-agenda/8679">https://emacs-china.org/t/org-agenda/8679</a>.
</p>

<p>
Here is a hook function to use archive this effect:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #696969;">;; </span><span style="color: #696969;">work with org-agenda dispatcher [c] "Today Clocked Tasks" to view today's clocked tasks.</span>
<span style="color: #eb4509;">(</span><span style="color: #eb4509;">defun</span> <span style="color: #b6e63e;">org-agenda-log-mode-colorize-block</span> <span style="color: #fd971f;">()</span>
  <span style="color: #7f7f80;">"Set different line spacing based on clock time duration."</span>
  <span style="color: #fd971f;">(</span><span style="color: #eb4509;">save-excursion</span>
    <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">let*</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">(</span>colors <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">cl-case</span> <span style="color: #eb4509;">(</span><span style="color: #b6e63e;">alist-get</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">background-mode</span> <span style="color: #fd971f;">(</span><span style="color: #fd971f;">frame-parameters</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
                     <span style="color: #eb4509;">(</span><span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">light</span>
                      <span style="color: #fd971f;">(</span><span style="color: #fd971f;">list</span> <span style="color: #e2c770;">"#F6B1C3"</span> <span style="color: #e2c770;">"#FFFF9D"</span> <span style="color: #e2c770;">"#BEEB9F"</span> <span style="color: #e2c770;">"#ADD5F7"</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
                     <span style="color: #eb4509;">(</span><span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">dark</span>
                      <span style="color: #fd971f;">(</span><span style="color: #fd971f;">list</span> <span style="color: #e2c770;">"#aa557f"</span> <span style="color: #e2c770;">"DarkGreen"</span> <span style="color: #e2c770;">"DarkSlateGray"</span> <span style="color: #e2c770;">"DarkSlateBlue"</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>
           pos
           duration<span style="color: #eb4509;">)</span>
      <span style="color: #eb4509;">(</span><span style="color: #fd971f;">nconc</span> colors colors<span style="color: #eb4509;">)</span>
      <span style="color: #eb4509;">(</span><span style="color: #fd971f;">goto-char</span> <span style="color: #fd971f;">(</span><span style="color: #fd971f;">point-min</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
      <span style="color: #eb4509;">(</span><span style="color: #eb4509;">while</span> <span style="color: #fd971f;">(</span><span style="color: #eb4509;">setq</span> pos <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">next-single-property-change</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">point</span><span style="color: #eb4509;">)</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">duration</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>
        <span style="color: #fd971f;">(</span><span style="color: #fd971f;">goto-char</span> pos<span style="color: #fd971f;">)</span>
        <span style="color: #fd971f;">(</span><span style="color: #eb4509;">when</span> <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">and</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">not</span> <span style="color: #fd971f;">(</span><span style="color: #fd971f;">equal</span> pos <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">point-at-eol</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
                   <span style="color: #eb4509;">(</span><span style="color: #eb4509;">setq</span> duration <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">org-get-at-bol</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">duration</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
          <span style="color: #696969;">;; </span><span style="color: #696969;">larger duration bar height</span>
          <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">let</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">(</span>line-height <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">if</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">&lt;</span> duration <span style="color: #9c91e4; font-weight: bold;">15</span><span style="color: #eb4509;">)</span> <span style="color: #9c91e4; font-weight: bold;">1.0</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">+</span> <span style="color: #9c91e4; font-weight: bold;">0.5</span> <span style="color: #fd971f;">(</span><span style="color: #fd971f;">/</span> duration <span style="color: #9c91e4; font-weight: bold;">30</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>
                <span style="color: #fd971f;">(</span>ov <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">make-overlay</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">point-at-bol</span><span style="color: #eb4509;">)</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">1+</span> <span style="color: #fd971f;">(</span><span style="color: #fd971f;">point-at-eol</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
            <span style="color: #eb4509;">(</span><span style="color: #fd971f;">overlay-put</span> ov <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">face</span> <span style="color: #9c91e4;">`</span><span style="color: #fd971f;">(</span><span style="color: #fd971f;">:background</span> ,<span style="color: #b6e63e;">(</span><span style="color: #fd971f;">car</span> colors<span style="color: #b6e63e;">)</span> <span style="color: #fd971f;">:foreground</span> <span style="color: #e2c770;">"black"</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
            <span style="color: #eb4509;">(</span><span style="color: #eb4509;">setq</span> colors <span style="color: #fd971f;">(</span><span style="color: #fd971f;">cdr</span> colors<span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
            <span style="color: #eb4509;">(</span><span style="color: #fd971f;">overlay-put</span> ov <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">line-height</span> line-height<span style="color: #eb4509;">)</span>
            <span style="color: #eb4509;">(</span><span style="color: #fd971f;">overlay-put</span> ov <span style="color: #9c91e4;">'</span><span style="color: #fd971f;">line-spacing</span> <span style="color: #fd971f;">(</span><span style="color: #fd971f;">1-</span> line-height<span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>

<span style="color: #eb4509;">(</span><span style="color: #b6e63e;">add-hook</span> <span style="color: #9c91e4;">'</span><span style="color: #fd971f;">org-agenda-finalize-hook</span> <span style="color: #9c91e4;">#'</span><span style="color: #66d9ef;">org-agenda-log-mode-colorize-block</span><span style="color: #eb4509;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org457b287" class="outline-4">
<h4 id="org457b287">Picking up a random task in the global TODO list</h4>
<div class="outline-text-4" id="text-org457b287">
<p>
Tony day <a href="http://mid.gmane.org/m2zk19l1me.fsf@gmail.com">shared</a> <a href="https://gist.github.com/4343164">this gist</a> to pick up a
random task.
</p>
</div>
</div>
</div>

<div id="outline-container-orgedcff1d" class="outline-3">
<h3 id="orgedcff1d">Building and Managing Org</h3>
<div class="outline-text-3" id="text-orgedcff1d">
</div>
<div id="outline-container-compiling-org-without-make" class="outline-4">
<h4 id="compiling-org-without-make">Generating autoloads and Compiling Org without make</h4>
<div class="outline-text-4" id="text-compiling-org-without-make">
<p>
Compilation is optional, but you <span class="underline">must</span> update the autoloads file
each time you update org, even when you run org uncompiled!
</p>

<p>
Starting with Org 7.9 you&rsquo;ll find functions for creating the
autoload files and do byte-compilation in <code>mk/org-fixup.el</code>.  When
you execute the commands below, your current directory must be where
org has been unpacked into, in other words the file <code>README</code> should
be found in your current directory and the directories <code>lisp</code> and
<code>etc</code> should be subdirectories of it.  The command <code>emacs</code> should be
found in your <code>PATH</code> and start the Emacs version you are using.  To
make just the autoloads file do:
</p>
<pre class="example">
emacs -batch -Q -L lisp -l ../mk/org-fixup -f org-make-autoloads
</pre>

<p>
To make the autoloads file and byte-compile org:
</p>
<pre class="example">
emacs -batch -Q -L lisp -l ../mk/org-fixup -f org-make-autoloads-compile
</pre>

<p>
To make the autoloads file and byte-compile all of org again:
</p>
<pre class="example">
emacs -batch -Q -L lisp -l ../mk/org-fixup -f org-make-autoloads-compile-force
</pre>

<p>
If you are not using Git, you&rsquo;ll have to make fake version strings
first if <code>org-version.el</code> is not already available (if it is, you
could also edit the version strings there).
</p>
<pre class="example">
emacs -batch -Q -L lisp -l ../mk/org-fixup \
--eval '(let ((org-fake-release "7.9.1")(org-fake-git-version "7.9.1-fake"))\
(org-make-autoloads))'
</pre>

<p>
The above assumes a
POSIX shell for its quoting.  Windows <code>CMD.exe</code> has quite different
quoting rules and this won&rsquo;t work, so your other option is to start
Emacs like this
</p>
<pre class="example">
emacs -Q -L lisp -l ../mk/org-fixup
</pre>

<p>
then paste the following into the <code>*scratch*</code> buffer
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span style="color: #eb4509;">(</span><span style="color: #eb4509;">let</span> <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">(</span>org-fake-release     <span style="color: #e2c770;">"7.9.1"</span><span style="color: #b6e63e;">)</span>
        <span style="color: #b6e63e;">(</span>org-fake-git-version <span style="color: #e2c770;">"7.9.1-fake"</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>
    <span style="color: #fd971f;">(</span>org-make-autoloads<span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
</pre>
</div>
<p>
position the cursor after the closing paren and press <code>C-j</code> or <code>C-x
  C-e</code> to evaluate the form.  Of course you can replace
<code>org-make-autoloads</code> with <code>org-make-autoloads-compile</code> or even
<code>org-make-autoloads-compile-force</code> if you wish with both variants.
</p>

<p>
For <b>older org versions only</b> (that do not yet have
<code>mk/org-fixup.el</code>), you can use the definitions below.  To use
this function, adjust the variables <code>my/org-lisp-directory</code> and
<code>my/org-compile-sources</code> to suit your needs.  If you have
byte-compiled org, but want to run org uncompiled again, just remove
all <code>*.elc</code> files in the <code>lisp/</code> directory, set
<code>my/org-compile-sources</code> to <code>nil</code>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span style="color: #eb4509;">(</span><span style="color: #eb4509;">defvar</span> <span style="color: #fd971f;">my/org-lisp-directory</span> <span style="color: #e2c770;">"~/.emacs.d/org/lisp/"</span>
    <span style="color: #7f7f80;">"Directory where your org-mode files live."</span><span style="color: #eb4509;">)</span>

  <span style="color: #eb4509;">(</span><span style="color: #eb4509;">defvar</span> <span style="color: #fd971f;">my/org-compile-sources</span> t
    <span style="color: #7f7f80;">"If `</span><span style="color: #fd971f;">nil</span><span style="color: #7f7f80;">', never compile org-sources. `</span><span style="color: #fd971f;">my/compile-org</span><span style="color: #7f7f80;">' will only create</span>
<span style="color: #7f7f80;">  the autoloads file `</span><span style="color: #fd971f;">org-loaddefs.el</span><span style="color: #7f7f80;">' then. If `t', compile the sources, too."</span><span style="color: #eb4509;">)</span>

  <span style="color: #696969;">;; </span><span style="color: #696969;">Customize: (must end with a slash!)</span>
  <span style="color: #eb4509;">(</span><span style="color: #eb4509;">setq</span> my/org-lisp-directory <span style="color: #e2c770;">"~/.emacs.d/org/lisp/"</span><span style="color: #eb4509;">)</span>

  <span style="color: #696969;">;; </span><span style="color: #696969;">Customize:</span>
  <span style="color: #eb4509;">(</span><span style="color: #eb4509;">setq</span>  my/org-compile-sources t<span style="color: #eb4509;">)</span>

  <span style="color: #eb4509;">(</span><span style="color: #eb4509;">defun</span> <span style="color: #b6e63e;">my/compile-org</span><span style="color: #fd971f;">(</span><span style="color: #66d9ef;">&amp;optional</span> directory<span style="color: #fd971f;">)</span>
    <span style="color: #7f7f80;">"Generate autoloads file org-loaddefs.el.  Optionally compile</span>
<span style="color: #7f7f80;">     all *.el files that come with org-mode."</span>
    <span style="color: #fd971f;">(</span><span style="color: #eb4509;">interactive</span><span style="color: #fd971f;">)</span>
    <span style="color: #fd971f;">(</span><span style="color: #eb4509;">defun</span> <span style="color: #b6e63e;">my/compile-org</span><span style="color: #b6e63e;">()</span>
      <span style="color: #7f7f80;">"Generate autoloads file org-loaddefs.el.  Optionally compile</span>
<span style="color: #7f7f80;">       all *.el files that come with org-mode."</span>
      <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">interactive</span><span style="color: #b6e63e;">)</span>
      <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">let</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">(</span>dirlisp <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">file-name-directory</span> my/org-lisp-directory<span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
        <span style="color: #eb4509;">(</span><span style="color: #b6e63e;">add-to-list</span> <span style="color: #9c91e4;">'</span><span style="color: #fd971f;">load-path</span> dirlisp<span style="color: #eb4509;">)</span>
        <span style="color: #eb4509;">(</span><span style="color: #fd971f;">require</span> <span style="color: #9c91e4;">'</span><span style="color: #fd971f;">autoload</span><span style="color: #eb4509;">)</span>
        <span style="color: #eb4509;">(</span><span style="color: #eb4509;">let</span> <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">(</span>generated-autoload-file <span style="color: #eb4509;">(</span><span style="color: #fd971f;">concat</span> dirlisp <span style="color: #e2c770;">"org-loaddefs.el"</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>
          <span style="color: #696969;">;; </span><span style="color: #696969;">create the org-loaddefs file</span>
          <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">update-directory-autoloads</span> dirlisp<span style="color: #fd971f;">)</span>
          <span style="color: #fd971f;">(</span><span style="color: #eb4509;">when</span> my/org-compile-sources
            <span style="color: #696969;">;; </span><span style="color: #696969;">optionally byte-compile</span>
            <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">byte-recompile-directory</span> dirlisp <span style="color: #9c91e4; font-weight: bold;">0</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">force</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org6af50ca" class="outline-4">
<h4 id="org6af50ca">Reload Org</h4>
<div class="outline-text-4" id="text-org6af50ca">
<p>
As of Org version 6.23b (released Sunday Feb 22, 2009) there is a new
function to reload org files.
</p>

<p>
Normally you want to use the compiled files since they are faster.
If you update your org files you can easily reload them with
</p>

<pre class="example">
M-x org-reload
</pre>


<p>
If you run into a bug and want to generate a useful backtrace you can
reload the source files instead of the compiled files with
</p>

<pre class="example">
C-u M-x org-reload
</pre>


<p>
and turn on the &ldquo;Enter Debugger On Error&rdquo; option.  Redo the action
that generates the error and cut and paste the resulting backtrace.
To switch back to the compiled version just reload again with
</p>

<pre class="example">
M-x org-reload
</pre>
</div>
</div>

<div id="outline-container-check-old-link-escapes" class="outline-4">
<h4 id="check-old-link-escapes">Check for possibly problematic old link escapes</h4>
<div class="outline-text-4" id="text-check-old-link-escapes">
<p>
Starting with version 7.5 Org uses <a href="https://en.wikipedia.org/wiki/Percent-encoding">percent escaping</a> more consistently
and with a modified algorithm to determine which characters to escape
and how.
</p>

<p>
As a side effect this modified behaviour might break existing links if
they contain a sequence of characters that look like a percent escape
(e.g. <code>[0-9A-Fa-f]{2}</code>) but are in fact not a percent escape.
</p>

<p>
The function below can be used to perform a preliminary check for such
links in an Org mode file.  It will run through all links in the file
and issue a warning if it finds a percent escape sequence which is not
in old Org&rsquo;s list of known percent escapes.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span style="color: #eb4509;">(</span><span style="color: #eb4509;">defun</span> <span style="color: #b6e63e;">dmaus/org-check-percent-escapes</span> <span style="color: #fd971f;">()</span>
    <span style="color: #7f7f80;">"*Check buffer for possibly problematic old link escapes."</span>
    <span style="color: #fd971f;">(</span><span style="color: #eb4509;">interactive</span><span style="color: #fd971f;">)</span>
    <span style="color: #fd971f;">(</span><span style="color: #eb4509;">when</span> <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">eq</span> <span style="color: #fd971f;">major-mode</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">org-mode</span><span style="color: #b6e63e;">)</span>
      <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">let</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">(</span>old-escapes <span style="color: #9c91e4;">'</span><span style="color: #b6e63e;">(</span><span style="color: #e2c770;">"%20"</span> <span style="color: #e2c770;">"%5B"</span> <span style="color: #e2c770;">"%5D"</span> <span style="color: #e2c770;">"%E0"</span> <span style="color: #e2c770;">"%E2"</span> <span style="color: #e2c770;">"%E7"</span> <span style="color: #e2c770;">"%E8"</span> <span style="color: #e2c770;">"%E9"</span>
                           <span style="color: #e2c770;">"%EA"</span> <span style="color: #e2c770;">"%EE"</span> <span style="color: #e2c770;">"%F4"</span> <span style="color: #e2c770;">"%F9"</span> <span style="color: #e2c770;">"%FB"</span> <span style="color: #e2c770;">"%3B"</span> <span style="color: #e2c770;">"%3D"</span> <span style="color: #e2c770;">"%2B"</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
        <span style="color: #eb4509;">(</span><span style="color: #eb4509;">unless</span> <span style="color: #fd971f;">(</span><span style="color: #fd971f;">boundp</span> <span style="color: #9c91e4;">'</span><span style="color: #fd971f;">warning-suppress-types</span><span style="color: #fd971f;">)</span>
          <span style="color: #fd971f;">(</span><span style="color: #eb4509;">setq</span> <span style="color: #fd971f;">warning-suppress-types</span> nil<span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
        <span style="color: #eb4509;">(</span><span style="color: #fd971f;">widen</span><span style="color: #eb4509;">)</span>
        <span style="color: #eb4509;">(</span><span style="color: #b6e63e;">show-all</span><span style="color: #eb4509;">)</span>
        <span style="color: #eb4509;">(</span><span style="color: #fd971f;">goto-char</span> <span style="color: #fd971f;">(</span><span style="color: #fd971f;">point-min</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
        <span style="color: #eb4509;">(</span><span style="color: #eb4509;">while</span> <span style="color: #fd971f;">(</span><span style="color: #fd971f;">re-search-forward</span> <span style="color: #fd971f;">org-any-link-re</span> nil t<span style="color: #fd971f;">)</span>
          <span style="color: #fd971f;">(</span><span style="color: #eb4509;">let</span> <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">(</span>end <span style="color: #fd971f;">(</span><span style="color: #fd971f;">match-end</span> <span style="color: #9c91e4; font-weight: bold;">0</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
            <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">goto-char</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">match-beginning</span> <span style="color: #9c91e4; font-weight: bold;">0</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
            <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">while</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">re-search-forward</span> <span style="color: #e2c770;">"%[0-9a-zA-Z]\\{2\\}"</span> end t<span style="color: #eb4509;">)</span>
              <span style="color: #eb4509;">(</span><span style="color: #eb4509;">let</span> <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">(</span>escape <span style="color: #eb4509;">(</span><span style="color: #b6e63e;">match-string-no-properties</span> <span style="color: #9c91e4; font-weight: bold;">0</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>
                <span style="color: #fd971f;">(</span><span style="color: #eb4509;">unless</span> <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">member</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">upcase</span> escape<span style="color: #eb4509;">)</span> old-escapes<span style="color: #b6e63e;">)</span>
                  <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">warn</span> <span style="color: #e2c770;">"Found unknown percent escape sequence %s at buffer %s, position %d"</span>
                        escape
                        <span style="color: #eb4509;">(</span><span style="color: #fd971f;">buffer-name</span><span style="color: #eb4509;">)</span>
                        <span style="color: #eb4509;">(</span><span style="color: #fd971f;">-</span> <span style="color: #fd971f;">(</span><span style="color: #fd971f;">point</span><span style="color: #fd971f;">)</span> <span style="color: #9c91e4; font-weight: bold;">3</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
            <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">goto-char</span> end<span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgeab2a9e" class="outline-3">
<h3 id="orgeab2a9e">Structure Movement and Editing</h3>
<div class="outline-text-3" id="text-orgeab2a9e">
</div>
<div id="outline-container-org884dfb9" class="outline-4">
<h4 id="org884dfb9">Go back to the previous top-level heading</h4>
<div class="outline-text-4" id="text-org884dfb9">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #eb4509;">(</span><span style="color: #eb4509;">defun</span> <span style="color: #b6e63e;">org-back-to-top-level-heading</span> <span style="color: #fd971f;">()</span>
  <span style="color: #7f7f80;">"Go back to the current top level heading."</span>
  <span style="color: #fd971f;">(</span><span style="color: #eb4509;">interactive</span><span style="color: #fd971f;">)</span>
  <span style="color: #fd971f;">(</span><span style="color: #eb4509;">or</span> <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">re-search-backward</span> <span style="color: #e2c770;">"^</span><span style="color: #e2c770;">\</span><span style="color: #e2c770;">* "</span> nil t<span style="color: #b6e63e;">)</span>
      <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">goto-char</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">point-min</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org-jump-to-child" class="outline-4">
<h4 id="org-jump-to-child">Go to a child of the current heading</h4>
<div class="outline-text-4" id="text-org-jump-to-child">
<ul class="org-ul">
<li><a href="http://langec.wordpress.com">Christoph Lange</a></li>
</ul>

<p>
<code>org-jump-to-child</code> in (keybinding suggested there: <code>C-c o c</code>) interactively prompts for the title of a child node, i.e. sub-heading, of the current heading and jumps to the child node having that title (in case of ambiguity: the <i>last</i> such node).
</p>

<p>
In the absence of a readily accessible structural representation of the tree outline, this is ipmlemented by walking over all child nodes and collecting their titles and their positions in the file.
</p>
</div>
</div>

<div id="outline-container-org-jump-to-id" class="outline-4">
<h4 id="org-jump-to-id">Go to a heading by its ID (<code>CUSTOM_ID</code> property)</h4>
<div class="outline-text-4" id="text-org-jump-to-id">
<ul class="org-ul">
<li><a href="http://langec.wordpress.com">Christoph Lange</a></li>
</ul>

<p>
<code>org-jump-to-id</code> in (keybinding suggested there: <code>C-c o j</code>) interactively prompts for the one of the <code>CUSTOM_ID</code> property values in the current document and jumps to the [first] node that has this ID.
</p>

<p>
This implementation works efficiently in a 5 MB org file with 100 IDs. Together with ido or helm I find it a very user-friendly way of jumping to frequently used headings.
</p>

<p>
I noticed that <code>org-babel-ref-goto-headline-id</code> does something similar, so maybe some code could be shared among the two functions.
</p>
</div>
</div>
<div id="outline-container-org6d09456" class="outline-4">
<h4 id="org6d09456">Show next/prev heading tidily</h4>
<div class="outline-text-4" id="text-org6d09456">
<ul class="org-ul">
<li>Dan Davison
These close the current heading and open the next/previous heading.</li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #eb4509;">(</span><span style="color: #eb4509;">defun</span> <span style="color: #b6e63e;">ded/org-show-next-heading-tidily</span> <span style="color: #fd971f;">()</span>
  <span style="color: #7f7f80;">"Show next entry, keeping other entries closed."</span>
  <span style="color: #fd971f;">(</span><span style="color: #eb4509;">if</span> <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">save-excursion</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">end-of-line</span><span style="color: #eb4509;">)</span> <span style="color: #eb4509;">(</span><span style="color: #b6e63e;">outline-invisible-p</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
      <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">progn</span> <span style="color: #eb4509;">(</span><span style="color: #b6e63e;">org-show-entry</span><span style="color: #eb4509;">)</span> <span style="color: #eb4509;">(</span><span style="color: #b6e63e;">show-children</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
    <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">outline-next-heading</span><span style="color: #b6e63e;">)</span>
    <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">unless</span> <span style="color: #eb4509;">(</span><span style="color: #eb4509;">and</span> <span style="color: #fd971f;">(</span><span style="color: #fd971f;">bolp</span><span style="color: #fd971f;">)</span> <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">org-on-heading-p</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
      <span style="color: #eb4509;">(</span><span style="color: #b6e63e;">org-up-heading-safe</span><span style="color: #eb4509;">)</span>
      <span style="color: #eb4509;">(</span><span style="color: #b6e63e;">hide-subtree</span><span style="color: #eb4509;">)</span>
      <span style="color: #eb4509;">(</span><span style="color: #b6e63e;">error</span> <span style="color: #e2c770;">"Boundary reached"</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
    <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">org-overview</span><span style="color: #b6e63e;">)</span>
    <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">org-reveal</span> t<span style="color: #b6e63e;">)</span>
    <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">org-show-entry</span><span style="color: #b6e63e;">)</span>
    <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">show-children</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>

<span style="color: #eb4509;">(</span><span style="color: #eb4509;">defun</span> <span style="color: #b6e63e;">ded/org-show-previous-heading-tidily</span> <span style="color: #fd971f;">()</span>
  <span style="color: #7f7f80;">"Show previous entry, keeping other entries closed."</span>
  <span style="color: #fd971f;">(</span><span style="color: #eb4509;">let</span> <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">(</span>pos <span style="color: #fd971f;">(</span><span style="color: #fd971f;">point</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
    <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">outline-previous-heading</span><span style="color: #b6e63e;">)</span>
    <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">unless</span> <span style="color: #eb4509;">(</span><span style="color: #eb4509;">and</span> <span style="color: #fd971f;">(</span><span style="color: #fd971f;">&lt;</span> <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">point</span><span style="color: #b6e63e;">)</span> pos<span style="color: #fd971f;">)</span> <span style="color: #fd971f;">(</span><span style="color: #fd971f;">bolp</span><span style="color: #fd971f;">)</span> <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">org-on-heading-p</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
      <span style="color: #eb4509;">(</span><span style="color: #fd971f;">goto-char</span> pos<span style="color: #eb4509;">)</span>
      <span style="color: #eb4509;">(</span><span style="color: #b6e63e;">hide-subtree</span><span style="color: #eb4509;">)</span>
      <span style="color: #eb4509;">(</span><span style="color: #b6e63e;">error</span> <span style="color: #e2c770;">"Boundary reached"</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
    <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">org-overview</span><span style="color: #b6e63e;">)</span>
    <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">org-reveal</span> t<span style="color: #b6e63e;">)</span>
    <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">org-show-entry</span><span style="color: #b6e63e;">)</span>
    <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">show-children</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>

<span style="color: #eb4509;">(</span><span style="color: #eb4509;">setq</span> <span style="color: #fd971f;">org-use-speed-commands</span> t<span style="color: #eb4509;">)</span>
<span style="color: #eb4509;">(</span><span style="color: #b6e63e;">add-to-list</span> <span style="color: #9c91e4;">'</span><span style="color: #fd971f;">org-speed-commands-user</span>
             <span style="color: #9c91e4;">'</span><span style="color: #fd971f;">(</span><span style="color: #e2c770;">"n"</span> ded/org-show-next-heading-tidily<span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
<span style="color: #eb4509;">(</span><span style="color: #b6e63e;">add-to-list</span> <span style="color: #9c91e4;">'</span><span style="color: #fd971f;">org-speed-commands-user</span>
             <span style="color: #9c91e4;">'</span><span style="color: #fd971f;">(</span><span style="color: #e2c770;">"p"</span> ded/org-show-previous-heading-tidily<span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgce28e41" class="outline-4">
<h4 id="orgce28e41">Promote all items in subtree</h4>
<div class="outline-text-4" id="text-orgce28e41">
<ul class="org-ul">
<li>Matt Lundin</li>
</ul>

<p>
This function will promote all items in a subtree. Since I use
subtrees primarily to organize projects, the function is somewhat
unimaginatively called my-org-un-project:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #eb4509;">(</span><span style="color: #eb4509;">defun</span> <span style="color: #b6e63e;">my-org-un-project</span> <span style="color: #fd971f;">()</span>
  <span style="color: #fd971f;">(</span><span style="color: #eb4509;">interactive</span><span style="color: #fd971f;">)</span>
  <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">org-map-entries</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">org-do-promote</span> <span style="color: #e2c770;">"LEVEL&gt;1"</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">tree</span><span style="color: #fd971f;">)</span>
  <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">org-cycle</span> t<span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-heading-to-link" class="outline-4">
<h4 id="heading-to-link">Turn a heading into an Org link</h4>
<div class="outline-text-4" id="text-heading-to-link">
<p>
From David Maus:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span style="color: #eb4509;">(</span><span style="color: #eb4509;">defun</span> <span style="color: #b6e63e;">dmj:turn-headline-into-org-mode-link</span> <span style="color: #fd971f;">()</span>
    <span style="color: #7f7f80;">"Replace word at point by an Org mode link."</span>
    <span style="color: #fd971f;">(</span><span style="color: #eb4509;">interactive</span><span style="color: #fd971f;">)</span>
    <span style="color: #fd971f;">(</span><span style="color: #eb4509;">when</span> <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">org-at-heading-p</span><span style="color: #b6e63e;">)</span>
      <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">let</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">(</span>hl-text <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">nth</span> <span style="color: #9c91e4; font-weight: bold;">4</span> <span style="color: #eb4509;">(</span><span style="color: #b6e63e;">org-heading-components</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
        <span style="color: #eb4509;">(</span><span style="color: #eb4509;">unless</span> <span style="color: #fd971f;">(</span><span style="color: #eb4509;">or</span> <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">null</span> hl-text<span style="color: #b6e63e;">)</span>
                    <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">org-string-match-p</span> <span style="color: #e2c770;">"^[ \t]*:[</span><span style="color: #9c91e4; font-weight: bold;">^</span><span style="color: #e2c770;">:]+:$"</span> hl-text<span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>
          <span style="color: #fd971f;">(</span><span style="color: #fd971f;">beginning-of-line</span><span style="color: #fd971f;">)</span>
          <span style="color: #fd971f;">(</span><span style="color: #fd971f;">search-forward</span> hl-text <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">point-at-eol</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>
          <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">replace-string</span>
           hl-text
           <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">format</span> <span style="color: #e2c770;">"[[file:%s.org][%s]]"</span>
                   <span style="color: #eb4509;">(</span><span style="color: #b6e63e;">org-link-escape</span> hl-text<span style="color: #eb4509;">)</span>
                   <span style="color: #eb4509;">(</span><span style="color: #b6e63e;">org-link-escape</span> hl-text <span style="color: #9c91e4;">'</span><span style="color: #fd971f;">(</span><span style="color: #b6e63e;">(</span>?\] . <span style="color: #e2c770;">"%5D"</span><span style="color: #b6e63e;">)</span> <span style="color: #b6e63e;">(</span>?\[ . <span style="color: #e2c770;">"%5B"</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
           nil <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">-</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">point</span><span style="color: #eb4509;">)</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">length</span> hl-text<span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span> <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">point</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org1767f2d" class="outline-4">
<h4 id="org1767f2d">Using M-up and M-down to transpose paragraphs</h4>
<div class="outline-text-4" id="text-org1767f2d">
<p>
From Paul Sexton: By default, if used within ordinary paragraphs in
org mode, <code>M-up</code> and <code>M-down</code> transpose <b>lines</b> (not sentences).  The
following code makes these keys transpose paragraphs, keeping the
point at the start of the moved paragraph. Behavior in tables and
headings is unaffected. It would be easy to modify this to transpose
sentences.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #eb4509;">(</span><span style="color: #eb4509;">defun</span> <span style="color: #b6e63e;">org-transpose-paragraphs</span> <span style="color: #fd971f;">(</span>arg<span style="color: #fd971f;">)</span>
 <span style="color: #fd971f;">(</span><span style="color: #eb4509;">interactive</span><span style="color: #fd971f;">)</span>
 <span style="color: #fd971f;">(</span><span style="color: #eb4509;">when</span> <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">and</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">not</span> <span style="color: #fd971f;">(</span><span style="color: #eb4509;">or</span> <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">org-at-table-p</span><span style="color: #b6e63e;">)</span> <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">org-on-heading-p</span><span style="color: #b6e63e;">)</span> <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">org-at-item-p</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
            <span style="color: #eb4509;">(</span><span style="color: #b6e63e;">thing-at-point</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">sentence</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
   <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">transpose-paragraphs</span> arg<span style="color: #b6e63e;">)</span>
   <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">backward-paragraph</span><span style="color: #b6e63e;">)</span>
   <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">re-search-forward</span> <span style="color: #e2c770;">"[[:graph:]]"</span><span style="color: #b6e63e;">)</span>
   <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">goto-char</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">match-beginning</span> <span style="color: #9c91e4; font-weight: bold;">0</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
   t<span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>

<span style="color: #eb4509;">(</span><span style="color: #b6e63e;">add-to-list</span> <span style="color: #9c91e4;">'</span><span style="color: #fd971f;">org-metaup-hook</span>
 <span style="color: #fd971f;">(</span><span style="color: #eb4509;">lambda</span> <span style="color: #b6e63e;">()</span> <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">interactive</span><span style="color: #b6e63e;">)</span> <span style="color: #b6e63e;">(</span>org-transpose-paragraphs <span style="color: #9c91e4; font-weight: bold;">-1</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
<span style="color: #eb4509;">(</span><span style="color: #b6e63e;">add-to-list</span> <span style="color: #9c91e4;">'</span><span style="color: #fd971f;">org-metadown-hook</span>
 <span style="color: #fd971f;">(</span><span style="color: #eb4509;">lambda</span> <span style="color: #b6e63e;">()</span> <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">interactive</span><span style="color: #b6e63e;">)</span> <span style="color: #b6e63e;">(</span>org-transpose-paragraphs <span style="color: #9c91e4; font-weight: bold;">1</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org42a8b99" class="outline-4">
<h4 id="org42a8b99">Changelog support for org headers</h4>
<div class="outline-text-4" id="text-org42a8b99">
<p>
&#x2013; James TD Smith
</p>

<p>
Put the following in your <code>.emacs</code>, and <code>C-x 4 a</code> and other functions which
use <code>add-log-current-defun</code> like <code>magit-add-log</code> will pick up the nearest org
headline as the &ldquo;current function&rdquo; if you add a changelog entry from an org
buffer.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span style="color: #eb4509;">(</span><span style="color: #eb4509;">defun</span> <span style="color: #b6e63e;">org-log-current-defun</span> <span style="color: #fd971f;">()</span>
    <span style="color: #fd971f;">(</span><span style="color: #eb4509;">save-excursion</span>
      <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">org-back-to-heading</span><span style="color: #b6e63e;">)</span>
      <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">if</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">looking-at</span> <span style="color: #fd971f;">org-complex-heading-regexp</span><span style="color: #eb4509;">)</span>
          <span style="color: #eb4509;">(</span><span style="color: #b6e63e;">match-string</span> <span style="color: #9c91e4; font-weight: bold;">4</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>

  <span style="color: #eb4509;">(</span><span style="color: #b6e63e;">add-hook</span> <span style="color: #9c91e4;">'</span><span style="color: #fd971f;">org-mode-hook</span>
            <span style="color: #fd971f;">(</span><span style="color: #eb4509;">lambda</span> <span style="color: #b6e63e;">()</span>
              <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">make-variable-buffer-local</span> <span style="color: #9c91e4;">'</span><span style="color: #fd971f;">add-log-current-defun-function</span><span style="color: #b6e63e;">)</span>
              <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">setq</span> <span style="color: #fd971f;">add-log-current-defun-function</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">org-log-current-defun</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org094c193" class="outline-4">
<h4 id="org094c193">Different org-cycle-level behavior</h4>
<div class="outline-text-4" id="text-org094c193">
<p>
&#x2013; Ryan Thompson
</p>

<p>
In recent org versions, when your point (cursor) is at the end of an
empty header line (like after you first created the header), the TAB
key (<code>org-cycle</code>) has a special behavior: it cycles the headline through
all possible levels. However, I did not like the way it determined
&ldquo;all possible levels,&rdquo; so I rewrote the whole function, along with a
couple of supporting functions.
</p>

<p>
The original function&rsquo;s definition of &ldquo;all possible levels&rdquo; was &ldquo;every
level from 1 to one more than the initial level of the current
headline before you started cycling.&rdquo; My new definition is &ldquo;every
level from 1 to one more than the previous headline&rsquo;s level.&rdquo; So, if
you have a headline at level 4 and you use ALT+RET to make a new
headline below it, it will cycle between levels 1 and 5, inclusive.
</p>

<p>
The main advantage of my custom <code>org-cycle-level</code> function is that it
is stateless: the next level in the cycle is determined entirely by
the contents of the buffer, and not what command you executed last.
This makes it more predictable, I hope.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #eb4509;">(</span><span style="color: #fd971f;">require</span> <span style="color: #9c91e4;">'</span><span style="color: #fd971f;">cl</span><span style="color: #eb4509;">)</span>

<span style="color: #eb4509;">(</span><span style="color: #eb4509;">defun</span> <span style="color: #b6e63e;">org-point-at-end-of-empty-headline</span> <span style="color: #fd971f;">()</span>
  <span style="color: #7f7f80;">"If point is at the end of an empty headline, return t, else nil."</span>
  <span style="color: #fd971f;">(</span><span style="color: #eb4509;">and</span> <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">looking-at</span> <span style="color: #e2c770;">"[ \t]*$"</span><span style="color: #b6e63e;">)</span>
       <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">save-excursion</span>
         <span style="color: #eb4509;">(</span><span style="color: #fd971f;">beginning-of-line</span> <span style="color: #9c91e4; font-weight: bold;">1</span><span style="color: #eb4509;">)</span>
         <span style="color: #eb4509;">(</span><span style="color: #fd971f;">looking-at</span> <span style="color: #fd971f;">(</span><span style="color: #fd971f;">concat</span> <span style="color: #e2c770;">"^</span><span style="color: #9c91e4; font-weight: bold;">\\</span><span style="color: #9c91e4; font-weight: bold;">(</span><span style="color: #e2c770;">\\*+</span><span style="color: #9c91e4; font-weight: bold;">\\</span><span style="color: #9c91e4; font-weight: bold;">)</span><span style="color: #e2c770;">[ \t]+</span><span style="color: #9c91e4; font-weight: bold;">\\</span><span style="color: #9c91e4; font-weight: bold;">(</span><span style="color: #e2c770;">"</span> <span style="color: #fd971f;">org-todo-regexp</span> <span style="color: #e2c770;">"</span><span style="color: #9c91e4; font-weight: bold;">\\</span><span style="color: #9c91e4; font-weight: bold;">)</span><span style="color: #e2c770;">?[ \t]*"</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>

<span style="color: #eb4509;">(</span><span style="color: #eb4509;">defun</span> <span style="color: #b6e63e;">org-level-increment</span> <span style="color: #fd971f;">()</span>
  <span style="color: #7f7f80;">"Return the number of stars that will be added or removed at a</span>
<span style="color: #7f7f80;">time to headlines when structure editing, based on the value of</span>
<span style="color: #7f7f80;">`</span><span style="color: #fd971f;">org-odd-levels-only</span><span style="color: #7f7f80;">'."</span>
  <span style="color: #fd971f;">(</span><span style="color: #eb4509;">if</span> <span style="color: #fd971f;">org-odd-levels-only</span> <span style="color: #9c91e4; font-weight: bold;">2</span> <span style="color: #9c91e4; font-weight: bold;">1</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>

<span style="color: #eb4509;">(</span><span style="color: #eb4509;">defvar</span> <span style="color: #fd971f;">org-previous-line-level-cached</span> nil<span style="color: #eb4509;">)</span>

<span style="color: #eb4509;">(</span><span style="color: #eb4509;">defun</span> <span style="color: #b6e63e;">org-recalculate-previous-line-level</span> <span style="color: #fd971f;">()</span>
  <span style="color: #7f7f80;">"Same as `</span><span style="color: #fd971f;">org-get-previous-line-level</span><span style="color: #7f7f80;">', but does not use cached</span>
<span style="color: #7f7f80;">value. It does *set* the cached value, though."</span>
  <span style="color: #fd971f;">(</span><span style="color: #fd971f;">set</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">org-previous-line-level-cached</span>
       <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">let</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">(</span>current-level <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">org-current-level</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>
             <span style="color: #fd971f;">(</span>prev-level <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">when</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">&gt;</span> <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">line-number-at-pos</span><span style="color: #fd971f;">)</span> <span style="color: #9c91e4; font-weight: bold;">1</span><span style="color: #eb4509;">)</span>
                           <span style="color: #eb4509;">(</span><span style="color: #eb4509;">save-excursion</span>
                             <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">previous-line</span><span style="color: #fd971f;">)</span>
                             <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">org-current-level</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
         <span style="color: #eb4509;">(</span><span style="color: #eb4509;">cond</span> <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">(</span><span style="color: #fd971f;">null</span> current-level<span style="color: #b6e63e;">)</span> nil<span style="color: #fd971f;">)</span> <span style="color: #696969;">; </span><span style="color: #696969;">Before first headline</span>
               <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">(</span><span style="color: #fd971f;">null</span> prev-level<span style="color: #b6e63e;">)</span> <span style="color: #9c91e4; font-weight: bold;">0</span><span style="color: #fd971f;">)</span>      <span style="color: #696969;">; </span><span style="color: #696969;">At first headline</span>
               <span style="color: #fd971f;">(</span>prev-level<span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>

<span style="color: #eb4509;">(</span><span style="color: #eb4509;">defun</span> <span style="color: #b6e63e;">org-get-previous-line-level</span> <span style="color: #fd971f;">()</span>
  <span style="color: #7f7f80;">"Return the outline depth of the last headline before the</span>
<span style="color: #7f7f80;">current line. Returns 0 for the first headline in the buffer, and</span>
<span style="color: #7f7f80;">nil if before the first headline."</span>
  <span style="color: #696969;">;; </span><span style="color: #696969;">This calculation is quite expensive, with all the regex searching</span>
  <span style="color: #696969;">;; </span><span style="color: #696969;">and stuff. Since org-cycle-level won't change lines, we can reuse</span>
  <span style="color: #696969;">;; </span><span style="color: #696969;">the last value of this command.</span>
  <span style="color: #fd971f;">(</span><span style="color: #eb4509;">or</span> <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">and</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">eq</span> <span style="color: #fd971f;">last-command</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">org-cycle-level</span><span style="color: #eb4509;">)</span>
           org-previous-line-level-cached<span style="color: #b6e63e;">)</span>
      <span style="color: #b6e63e;">(</span>org-recalculate-previous-line-level<span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>

<span style="color: #eb4509;">(</span><span style="color: #eb4509;">defun</span> <span style="color: #b6e63e;">org-cycle-level</span> <span style="color: #fd971f;">()</span>
  <span style="color: #fd971f;">(</span><span style="color: #eb4509;">interactive</span><span style="color: #fd971f;">)</span>
  <span style="color: #fd971f;">(</span><span style="color: #eb4509;">let</span> <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">(</span><span style="color: #fd971f;">org-adapt-indentation</span> nil<span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
    <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">when</span> <span style="color: #eb4509;">(</span><span style="color: #b6e63e;">org-point-at-end-of-empty-headline</span><span style="color: #eb4509;">)</span>
      <span style="color: #eb4509;">(</span><span style="color: #eb4509;">setq</span> <span style="color: #fd971f;">this-command</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">org-cycle-level</span><span style="color: #eb4509;">)</span> <span style="color: #696969;">;</span><span style="color: #696969;">Only needed for caching</span>
      <span style="color: #eb4509;">(</span><span style="color: #eb4509;">let</span> <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">(</span>cur-level <span style="color: #eb4509;">(</span><span style="color: #b6e63e;">org-current-level</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
            <span style="color: #b6e63e;">(</span>prev-level <span style="color: #eb4509;">(</span><span style="color: #b6e63e;">org-get-previous-line-level</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>
        <span style="color: #fd971f;">(</span><span style="color: #eb4509;">cond</span>
         <span style="color: #696969;">;; </span><span style="color: #696969;">If first headline in file, promote to top-level.</span>
         <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">(</span><span style="color: #fd971f;">=</span> prev-level <span style="color: #9c91e4; font-weight: bold;">0</span><span style="color: #eb4509;">)</span>
          <span style="color: #eb4509;">(</span><span style="color: #eb4509;">loop</span> repeat <span style="color: #fd971f;">(</span><span style="color: #fd971f;">/</span> <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">-</span> cur-level <span style="color: #9c91e4; font-weight: bold;">1</span><span style="color: #b6e63e;">)</span> <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">org-level-increment</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>
                do <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">org-do-promote</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
         <span style="color: #696969;">;; </span><span style="color: #696969;">If same level as prev, demote one.</span>
         <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">(</span><span style="color: #fd971f;">=</span> prev-level cur-level<span style="color: #eb4509;">)</span>
          <span style="color: #eb4509;">(</span><span style="color: #b6e63e;">org-do-demote</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
         <span style="color: #696969;">;; </span><span style="color: #696969;">If parent is top-level, promote to top level if not already.</span>
         <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">(</span><span style="color: #fd971f;">=</span> prev-level <span style="color: #9c91e4; font-weight: bold;">1</span><span style="color: #eb4509;">)</span>
          <span style="color: #eb4509;">(</span><span style="color: #eb4509;">loop</span> repeat <span style="color: #fd971f;">(</span><span style="color: #fd971f;">/</span> <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">-</span> cur-level <span style="color: #9c91e4; font-weight: bold;">1</span><span style="color: #b6e63e;">)</span> <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">org-level-increment</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>
                do <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">org-do-promote</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
         <span style="color: #696969;">;; </span><span style="color: #696969;">If top-level, return to prev-level.</span>
         <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">(</span><span style="color: #fd971f;">=</span> cur-level <span style="color: #9c91e4; font-weight: bold;">1</span><span style="color: #eb4509;">)</span>
          <span style="color: #eb4509;">(</span><span style="color: #eb4509;">loop</span> repeat <span style="color: #fd971f;">(</span><span style="color: #fd971f;">/</span> <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">-</span> prev-level <span style="color: #9c91e4; font-weight: bold;">1</span><span style="color: #b6e63e;">)</span> <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">org-level-increment</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>
                do <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">org-do-demote</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
         <span style="color: #696969;">;; </span><span style="color: #696969;">If less than prev-level, promote one.</span>
         <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">(</span><span style="color: #fd971f;">&lt;</span> cur-level prev-level<span style="color: #eb4509;">)</span>
          <span style="color: #eb4509;">(</span><span style="color: #b6e63e;">org-do-promote</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
         <span style="color: #696969;">;; </span><span style="color: #696969;">If deeper than prev-level, promote until higher than</span>
         <span style="color: #696969;">;; </span><span style="color: #696969;">prev-level.</span>
         <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">(</span><span style="color: #fd971f;">&gt;</span> cur-level prev-level<span style="color: #eb4509;">)</span>
          <span style="color: #eb4509;">(</span><span style="color: #eb4509;">loop</span> repeat <span style="color: #fd971f;">(</span><span style="color: #fd971f;">+</span> <span style="color: #9c91e4; font-weight: bold;">1</span> <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">/</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">-</span> cur-level prev-level<span style="color: #eb4509;">)</span> <span style="color: #eb4509;">(</span><span style="color: #b6e63e;">org-level-increment</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>
                do <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">org-do-promote</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>
        t<span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgd8ca056" class="outline-4">
<h4 id="orgd8ca056">Count words in an Org buffer</h4>
<div class="outline-text-4" id="text-orgd8ca056">
<p>
Paul Sexton <a href="https://orgmode.org/list/loom.20110220T224023-532@post.gmane.org">posted</a> this function to count words in an Org buffer:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #eb4509;">(</span><span style="color: #eb4509;">defun</span> <span style="color: #b6e63e;">org-word-count</span> <span style="color: #fd971f;">(</span>beg end
                           <span style="color: #66d9ef;">&amp;optional</span> count-latex-macro-args?
                           count-footnotes?<span style="color: #fd971f;">)</span>
  <span style="color: #7f7f80;">"Report the number of words in the Org mode buffer or selected region.</span>
<span style="color: #7f7f80;">Ignores:</span>
<span style="color: #7f7f80;">- comments</span>
<span style="color: #7f7f80;">- tables</span>
<span style="color: #7f7f80;">- source code blocks (#+BEGIN_SRC ... #+END_SRC, and inline blocks)</span>
<span style="color: #7f7f80;">- hyperlinks (but does count words in hyperlink descriptions)</span>
<span style="color: #7f7f80;">- tags, priorities, and </span><span style="color: #e2c770; font-weight: bold;">TODO</span><span style="color: #7f7f80;"> keywords in headers</span>
<span style="color: #7f7f80;">- sections tagged as 'not for export'.</span>

<span style="color: #7f7f80;">The text of footnote definitions is ignored, unless the optional argument</span>
<span style="color: #7f7f80;">COUNT-FOOTNOTES? is non-nil.</span>

<span style="color: #7f7f80;">If the optional argument COUNT-LATEX-MACRO-ARGS? is non-nil, the word count</span>
<span style="color: #7f7f80;">includes LaTeX macro arguments (the material between {curly braces}).</span>
<span style="color: #7f7f80;">Otherwise, and by default, every LaTeX macro counts as 1 word regardless</span>
<span style="color: #7f7f80;">of its arguments."</span>
  <span style="color: #fd971f;">(</span><span style="color: #eb4509;">interactive</span> <span style="color: #e2c770;">"r"</span><span style="color: #fd971f;">)</span>
  <span style="color: #fd971f;">(</span><span style="color: #eb4509;">unless</span> <span style="color: #fd971f;">mark-active</span>
    <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">setf</span> beg <span style="color: #eb4509;">(</span><span style="color: #fd971f;">point-min</span><span style="color: #eb4509;">)</span>
    end <span style="color: #eb4509;">(</span><span style="color: #fd971f;">point-max</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>
  <span style="color: #fd971f;">(</span><span style="color: #eb4509;">let</span> <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">(</span>wc <span style="color: #9c91e4; font-weight: bold;">0</span><span style="color: #eb4509;">)</span>
  <span style="color: #eb4509;">(</span>latex-macro-regexp <span style="color: #e2c770;">"\\\\[</span><span style="color: #fd971f;">A-Za-z</span><span style="color: #e2c770;">]+</span><span style="color: #9c91e4; font-weight: bold;">\\</span><span style="color: #9c91e4; font-weight: bold;">(</span><span style="color: #e2c770;">\\[[</span><span style="color: #9c91e4; font-weight: bold;">^</span><span style="color: #e2c770;">]]*\\]</span><span style="color: #9c91e4; font-weight: bold;">\\</span><span style="color: #9c91e4; font-weight: bold;">|</span><span style="color: #9c91e4; font-weight: bold;">\\</span><span style="color: #9c91e4; font-weight: bold;">)</span><span style="color: #e2c770;">{</span><span style="color: #9c91e4; font-weight: bold;">\\</span><span style="color: #9c91e4; font-weight: bold;">(</span><span style="color: #e2c770;">[</span><span style="color: #9c91e4; font-weight: bold;">^</span><span style="color: #e2c770;">}]*</span><span style="color: #9c91e4; font-weight: bold;">\\</span><span style="color: #9c91e4; font-weight: bold;">)</span><span style="color: #e2c770;">}"</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
    <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">save-excursion</span>
      <span style="color: #eb4509;">(</span><span style="color: #fd971f;">goto-char</span> beg<span style="color: #eb4509;">)</span>
      <span style="color: #eb4509;">(</span><span style="color: #eb4509;">while</span> <span style="color: #fd971f;">(</span><span style="color: #fd971f;">&lt;</span> <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">point</span><span style="color: #b6e63e;">)</span> end<span style="color: #fd971f;">)</span>
        <span style="color: #fd971f;">(</span><span style="color: #eb4509;">cond</span>
         <span style="color: #696969;">;; </span><span style="color: #696969;">Ignore comments.</span>
         <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">(</span><span style="color: #eb4509;">or</span> <span style="color: #fd971f;">(</span>org-in-commented-line<span style="color: #fd971f;">)</span> <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">org-at-table-p</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
          nil<span style="color: #b6e63e;">)</span>
         <span style="color: #696969;">;; </span><span style="color: #696969;">Ignore hyperlinks. But if link has a description, count</span>
         <span style="color: #696969;">;; </span><span style="color: #696969;">the words within the description.</span>
         <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">(</span><span style="color: #fd971f;">looking-at</span> <span style="color: #fd971f;">org-bracket-link-analytic-regexp</span><span style="color: #eb4509;">)</span>
          <span style="color: #eb4509;">(</span><span style="color: #eb4509;">when</span> <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">match-string-no-properties</span> <span style="color: #9c91e4; font-weight: bold;">5</span><span style="color: #fd971f;">)</span>
            <span style="color: #fd971f;">(</span><span style="color: #eb4509;">let</span> <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">(</span>desc <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">match-string-no-properties</span> <span style="color: #9c91e4; font-weight: bold;">5</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
              <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">save-match-data</span>
                <span style="color: #eb4509;">(</span><span style="color: #eb4509;">incf</span> wc <span style="color: #fd971f;">(</span><span style="color: #fd971f;">length</span> <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">remove</span> <span style="color: #e2c770;">""</span> <span style="color: #eb4509;">(</span><span style="color: #b6e63e;">org-split-string</span>
                                             desc <span style="color: #e2c770;">"\\W"</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
          <span style="color: #eb4509;">(</span><span style="color: #fd971f;">goto-char</span> <span style="color: #fd971f;">(</span><span style="color: #fd971f;">match-end</span> <span style="color: #9c91e4; font-weight: bold;">0</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
         <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">(</span><span style="color: #fd971f;">looking-at</span> <span style="color: #fd971f;">org-any-link-re</span><span style="color: #eb4509;">)</span>
          <span style="color: #eb4509;">(</span><span style="color: #fd971f;">goto-char</span> <span style="color: #fd971f;">(</span><span style="color: #fd971f;">match-end</span> <span style="color: #9c91e4; font-weight: bold;">0</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
         <span style="color: #696969;">;; </span><span style="color: #696969;">Ignore source code blocks.</span>
         <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">(</span>org-in-regexps-block-p <span style="color: #e2c770;">"^#\\+BEGIN_SRC\\W"</span> <span style="color: #e2c770;">"^#\\+END_SRC\\W"</span><span style="color: #eb4509;">)</span>
          nil<span style="color: #b6e63e;">)</span>
         <span style="color: #696969;">;; </span><span style="color: #696969;">Ignore inline source blocks, counting them as 1 word.</span>
         <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">(</span><span style="color: #eb4509;">save-excursion</span>
            <span style="color: #fd971f;">(</span><span style="color: #fd971f;">backward-char</span><span style="color: #fd971f;">)</span>
            <span style="color: #fd971f;">(</span><span style="color: #fd971f;">looking-at</span> org-babel-inline-src-block-regexp<span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
          <span style="color: #eb4509;">(</span><span style="color: #fd971f;">goto-char</span> <span style="color: #fd971f;">(</span><span style="color: #fd971f;">match-end</span> <span style="color: #9c91e4; font-weight: bold;">0</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
          <span style="color: #eb4509;">(</span><span style="color: #eb4509;">setf</span> wc <span style="color: #fd971f;">(</span><span style="color: #fd971f;">+</span> <span style="color: #9c91e4; font-weight: bold;">2</span> wc<span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
         <span style="color: #696969;">;; </span><span style="color: #696969;">Count latex macros as 1 word, ignoring their arguments.</span>
         <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">(</span><span style="color: #eb4509;">save-excursion</span>
            <span style="color: #fd971f;">(</span><span style="color: #fd971f;">backward-char</span><span style="color: #fd971f;">)</span>
            <span style="color: #fd971f;">(</span><span style="color: #fd971f;">looking-at</span> latex-macro-regexp<span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
          <span style="color: #eb4509;">(</span><span style="color: #fd971f;">goto-char</span> <span style="color: #fd971f;">(</span><span style="color: #eb4509;">if</span> count-latex-macro-args?
                         <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">match-beginning</span> <span style="color: #9c91e4; font-weight: bold;">2</span><span style="color: #b6e63e;">)</span>
                       <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">match-end</span> <span style="color: #9c91e4; font-weight: bold;">0</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
          <span style="color: #eb4509;">(</span><span style="color: #eb4509;">setf</span> wc <span style="color: #fd971f;">(</span><span style="color: #fd971f;">+</span> <span style="color: #9c91e4; font-weight: bold;">2</span> wc<span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
         <span style="color: #696969;">;; </span><span style="color: #696969;">Ignore footnotes.</span>
         <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">(</span><span style="color: #eb4509;">and</span> <span style="color: #fd971f;">(</span><span style="color: #fd971f;">not</span> count-footnotes?<span style="color: #fd971f;">)</span>
               <span style="color: #fd971f;">(</span><span style="color: #eb4509;">or</span> <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">org-footnote-at-definition-p</span><span style="color: #b6e63e;">)</span>
                   <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">org-footnote-at-reference-p</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
          nil<span style="color: #b6e63e;">)</span>
         <span style="color: #b6e63e;">(</span>t
          <span style="color: #eb4509;">(</span><span style="color: #eb4509;">let</span> <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">(</span>contexts <span style="color: #eb4509;">(</span><span style="color: #b6e63e;">org-context</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>
            <span style="color: #fd971f;">(</span><span style="color: #eb4509;">cond</span>
             <span style="color: #696969;">;; </span><span style="color: #696969;">Ignore tags and </span><span style="color: #e2c770; font-weight: bold;">TODO</span><span style="color: #696969;"> keywords, etc.</span>
             <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">(</span><span style="color: #eb4509;">or</span> <span style="color: #fd971f;">(</span><span style="color: #fd971f;">assoc</span> <span style="color: #fd971f;">:todo-keyword</span> contexts<span style="color: #fd971f;">)</span>
                  <span style="color: #fd971f;">(</span><span style="color: #fd971f;">assoc</span> <span style="color: #fd971f;">:priority</span> contexts<span style="color: #fd971f;">)</span>
                  <span style="color: #fd971f;">(</span><span style="color: #fd971f;">assoc</span> <span style="color: #fd971f;">:keyword</span> contexts<span style="color: #fd971f;">)</span>
                  <span style="color: #fd971f;">(</span><span style="color: #fd971f;">assoc</span> <span style="color: #fd971f;">:checkbox</span> contexts<span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
              nil<span style="color: #b6e63e;">)</span>
             <span style="color: #696969;">;; </span><span style="color: #696969;">Ignore sections marked with tags that are</span>
             <span style="color: #696969;">;; </span><span style="color: #696969;">excluded from export.</span>
             <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">(</span><span style="color: #fd971f;">assoc</span> <span style="color: #fd971f;">:tags</span> contexts<span style="color: #eb4509;">)</span>
              <span style="color: #eb4509;">(</span><span style="color: #eb4509;">if</span> <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">intersection</span> <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">org-get-tags-at</span><span style="color: #b6e63e;">)</span> <span style="color: #fd971f;">org-export-exclude-tags</span>
                                <span style="color: #fd971f;">:test</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">equal</span><span style="color: #fd971f;">)</span>
                  <span style="color: #fd971f;">(</span>org-forward-same-level <span style="color: #9c91e4; font-weight: bold;">1</span><span style="color: #fd971f;">)</span>
                nil<span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
             <span style="color: #b6e63e;">(</span>t
              <span style="color: #eb4509;">(</span><span style="color: #eb4509;">incf</span> wc<span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>
        <span style="color: #fd971f;">(</span><span style="color: #fd971f;">re-search-forward</span> <span style="color: #e2c770;">"\\w+\\W*"</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
    <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">message</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">format</span> <span style="color: #e2c770;">"%d words in %s."</span> wc
                     <span style="color: #fd971f;">(</span><span style="color: #eb4509;">if</span> <span style="color: #fd971f;">mark-active</span> <span style="color: #e2c770;">"region"</span> <span style="color: #e2c770;">"buffer"</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-check-for-misplaced-timestamps" class="outline-4">
<h4 id="check-for-misplaced-timestamps">Check for misplaced SCHEDULED and DEADLINE cookies</h4>
<div class="outline-text-4" id="text-check-for-misplaced-timestamps">
<p>
The <code>SCHEDULED</code> and <code>DEADLINE</code> cookies should be used on the line <b>right
below</b> the headline &#x2013; like this:
</p>

<div class="org-src-container">
<pre class="src src-org"><span style="color: #eb4509; font-weight: bold;">*</span><span style="color: #eb4509; font-weight: bold;"> A headline</span>
  <span style="color: #7f7f80;">SCHEDULED:</span> <span style="color: #a020f0;">&lt;2012-04-09 lun.&gt;</span>
</pre>
</div>

<p>
This is what <code>org-scheduled</code> and <code>org-deadline</code> (and other similar
commands) do.  And the manual explicitely tell people to stick to this
format (see the section &ldquo;8.3.1 Inserting deadlines or schedules&rdquo;).
</p>

<p>
If you think you might have subtrees with misplaced <code>SCHEDULED</code> and
<code>DEADLINE</code> cookies, this command lets you check the current buffer:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #eb4509;">(</span><span style="color: #eb4509;">defun</span> <span style="color: #b6e63e;">org-check-misformatted-subtree</span> <span style="color: #fd971f;">()</span>
  <span style="color: #7f7f80;">"Check misformatted entries in the current buffer."</span>
  <span style="color: #fd971f;">(</span><span style="color: #eb4509;">interactive</span><span style="color: #fd971f;">)</span>
  <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">show-all</span><span style="color: #fd971f;">)</span>
  <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">org-map-entries</span>
   <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">lambda</span> <span style="color: #eb4509;">()</span>
     <span style="color: #eb4509;">(</span><span style="color: #eb4509;">when</span> <span style="color: #fd971f;">(</span><span style="color: #eb4509;">and</span> <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">move-beginning-of-line</span> <span style="color: #9c91e4; font-weight: bold;">2</span><span style="color: #b6e63e;">)</span>
    <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">not</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">looking-at</span> <span style="color: #fd971f;">org-heading-regexp</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>
       <span style="color: #fd971f;">(</span><span style="color: #eb4509;">if</span> <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">or</span> <span style="color: #eb4509;">(</span><span style="color: #eb4509;">and</span> <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">org-get-scheduled-time</span> <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">point</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>
        <span style="color: #fd971f;">(</span><span style="color: #fd971f;">not</span> <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">looking-at</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">concat</span> <span style="color: #e2c770;">"^.*"</span> <span style="color: #fd971f;">org-scheduled-regexp</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
         <span style="color: #eb4509;">(</span><span style="color: #eb4509;">and</span> <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">org-get-deadline-time</span> <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">point</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>
        <span style="color: #fd971f;">(</span><span style="color: #fd971f;">not</span> <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">looking-at</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">concat</span> <span style="color: #e2c770;">"^.*"</span> <span style="color: #fd971f;">org-deadline-regexp</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
     <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">when</span> <span style="color: #eb4509;">(</span><span style="color: #b6e63e;">y-or-n-p</span> <span style="color: #e2c770;">"Fix this subtree? "</span><span style="color: #eb4509;">)</span>
       <span style="color: #eb4509;">(</span><span style="color: #fd971f;">message</span> <span style="color: #e2c770;">"Call the function again when you're done fixing this subtree."</span><span style="color: #eb4509;">)</span>
       <span style="color: #eb4509;">(</span><span style="color: #fd971f;">recursive-edit</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
   <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">message</span> <span style="color: #e2c770;">"All subtrees checked."</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org37f0229" class="outline-4">
<h4 id="org37f0229">Sorting list by checkbox type</h4>
<div class="outline-text-4" id="text-org37f0229">
<p>
You can use a custom function to sort list by checkbox type.
Here is a function suggested by Carsten:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #eb4509;">(</span><span style="color: #eb4509;">defun</span> <span style="color: #b6e63e;">org-sort-list-by-checkbox-type</span> <span style="color: #fd971f;">()</span>
  <span style="color: #7f7f80;">"Sort list items according to Checkbox state."</span>
  <span style="color: #fd971f;">(</span><span style="color: #eb4509;">interactive</span><span style="color: #fd971f;">)</span>
  <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">org-sort-list</span>
   nil ?f
   <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">lambda</span> <span style="color: #eb4509;">()</span>
     <span style="color: #eb4509;">(</span><span style="color: #eb4509;">if</span> <span style="color: #fd971f;">(</span><span style="color: #fd971f;">looking-at</span> <span style="color: #fd971f;">org-list-full-item-re</span><span style="color: #fd971f;">)</span>
   <span style="color: #fd971f;">(</span><span style="color: #fd971f;">cdr</span> <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">assoc</span> <span style="color: #eb4509;">(</span><span style="color: #b6e63e;">match-string</span> <span style="color: #9c91e4; font-weight: bold;">3</span><span style="color: #eb4509;">)</span>
         <span style="color: #9c91e4;">'</span><span style="color: #eb4509;">(</span><span style="color: #fd971f;">(</span><span style="color: #e2c770;">"[X]"</span> . <span style="color: #9c91e4; font-weight: bold;">1</span><span style="color: #fd971f;">)</span> <span style="color: #fd971f;">(</span><span style="color: #e2c770;">"[-]"</span> . <span style="color: #9c91e4; font-weight: bold;">2</span><span style="color: #fd971f;">)</span> <span style="color: #fd971f;">(</span><span style="color: #e2c770;">"[ ]"</span> . <span style="color: #9c91e4; font-weight: bold;">3</span><span style="color: #fd971f;">)</span> <span style="color: #fd971f;">(</span>nil . <span style="color: #9c91e4; font-weight: bold;">4</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>
       <span style="color: #9c91e4; font-weight: bold;">4</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
</pre>
</div>

<p>
Use the function above directly on the list.  If you want to use an
equivalent function after <code>C-c ^ f</code>, use this one instead:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span style="color: #eb4509;">(</span><span style="color: #eb4509;">defun</span> <span style="color: #b6e63e;">org-sort-list-by-checkbox-type-1</span> <span style="color: #fd971f;">()</span>
    <span style="color: #fd971f;">(</span><span style="color: #eb4509;">lambda</span> <span style="color: #b6e63e;">()</span>
      <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">if</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">looking-at</span> <span style="color: #fd971f;">org-list-full-item-re</span><span style="color: #eb4509;">)</span>
          <span style="color: #eb4509;">(</span><span style="color: #fd971f;">cdr</span> <span style="color: #fd971f;">(</span><span style="color: #fd971f;">assoc</span> <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">match-string</span> <span style="color: #9c91e4; font-weight: bold;">3</span><span style="color: #b6e63e;">)</span>
                      <span style="color: #9c91e4;">'</span><span style="color: #b6e63e;">(</span><span style="color: #eb4509;">(</span><span style="color: #e2c770;">"[X]"</span> . <span style="color: #9c91e4; font-weight: bold;">1</span><span style="color: #eb4509;">)</span> <span style="color: #eb4509;">(</span><span style="color: #e2c770;">"[-]"</span> . <span style="color: #9c91e4; font-weight: bold;">2</span><span style="color: #eb4509;">)</span> <span style="color: #eb4509;">(</span><span style="color: #e2c770;">"[ ]"</span> . <span style="color: #9c91e4; font-weight: bold;">3</span><span style="color: #eb4509;">)</span> <span style="color: #eb4509;">(</span>nil . <span style="color: #9c91e4; font-weight: bold;">4</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
        <span style="color: #9c91e4; font-weight: bold;">4</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgdf3e5af" class="outline-4">
<h4 id="orgdf3e5af">Adding Licenses to org files</h4>
<div class="outline-text-4" id="text-orgdf3e5af">
<p>
You can add pretty standard licenses, such as creative commons or gfdl
to org articles using <code>org-license.el</code>.
</p>
</div>
</div>
</div>

<div id="outline-container-Tables" class="outline-3">
<h3 id="Tables">Org Table</h3>
<div class="outline-text-3" id="text-Tables">
</div>

<div id="outline-container-align-tables-in-file" class="outline-4">
<h4 id="align-tables-in-file">Align all tables in a file</h4>
<div class="outline-text-4" id="text-align-tables-in-file">
<p>
Andrew Young provided this function in <a href="https://orgmode.org/list/502F4EDF.3080800@wilkesley.net">this thread</a>:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span style="color: #eb4509;">(</span><span style="color: #eb4509;">defun</span> <span style="color: #b6e63e;">my-align-all-tables</span> <span style="color: #fd971f;">()</span>
    <span style="color: #fd971f;">(</span><span style="color: #eb4509;">interactive</span><span style="color: #fd971f;">)</span>
    <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">org-table-map-tables</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">org-table-align</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">quietly</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-transpose-table" class="outline-4">
<h4 id="transpose-table">Transpose table</h4>
<div class="outline-text-4" id="text-transpose-table">
<p>
Since Org 7.8, you can use <code>org-table-transpose-table-at-point</code> (which
see.)  There are also other solutions:
</p>

<ul class="org-ul">
<li>with org-babel and Emacs Lisp: provided by Thomas S. Dye in the mailing
list, see <a href="https://orgmode.org/list/4BBCE264.3000407@alumni.ethz.ch">gmane</a> or <a href="http://lists.gnu.org/archive/html/emacs-orgmode/2010-04/msg00239.html">gnu</a></li>

<li>with org-babel and R: provided by Dan Davison in the mailing list (old
<code>#+TBLR:</code> syntax), see <a href="https://orgmode.org/list/20081230193550.GA7961@stats.ox.ac.uk">gmane</a> or <a href="http://lists.gnu.org/archive/html/emacs-orgmode/2008-12/msg00454.html">gnu</a></li>

<li>with field coordinates in formulas (<code>@#</code> and <code>$#</code>): see <a href="#field-coordinates-in-formulas-transpose-table">Worg</a>.</li>
</ul>
</div>
</div>

<div id="outline-container-org2818e72" class="outline-4">
<h4 id="org2818e72">Manipulate hours/minutes/seconds in table formulas</h4>
<div class="outline-text-4" id="text-org2818e72">
<p>
Both Bastien and Martin Halder have posted code (<a href="https://orgmode.org/list/00BD91C6-C610-4CDD-B3E0-E9FECDAA372C@gmail.com">Bastien&rsquo;s code</a> and
<a href="https://orgmode.org/list/00BD91C6-C610-4CDD-B3E0-E9FECDAA372C@gmail.com">Martin&rsquo;s code</a>) for interpreting <code>dd:dd</code> or <code>dd:dd:dd</code> strings (where
&ldquo;<code>d</code>&rdquo; is any digit) as time values in Org-mode table formula.  These
functions have now been wrapped up into a <code>with-time</code> macro which can
be used in table formula to translate table cell values to and from
numerical values for algebraic manipulation.
</p>

<p>
Here is the code implementing this macro.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span style="color: #eb4509;">(</span><span style="color: #eb4509;">defun</span> <span style="color: #b6e63e;">org-time-string-to-seconds</span> <span style="color: #fd971f;">(</span>s<span style="color: #fd971f;">)</span>
    <span style="color: #7f7f80;">"Convert a string HH:MM:SS to a number of seconds."</span>
    <span style="color: #fd971f;">(</span><span style="color: #eb4509;">cond</span>
     <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">(</span><span style="color: #eb4509;">and</span> <span style="color: #fd971f;">(</span><span style="color: #fd971f;">stringp</span> s<span style="color: #fd971f;">)</span>
           <span style="color: #fd971f;">(</span><span style="color: #fd971f;">string-match</span> <span style="color: #e2c770;">"</span><span style="color: #9c91e4; font-weight: bold;">\\</span><span style="color: #9c91e4; font-weight: bold;">(</span><span style="color: #e2c770;">[0-9]+</span><span style="color: #9c91e4; font-weight: bold;">\\</span><span style="color: #9c91e4; font-weight: bold;">)</span><span style="color: #e2c770;">:</span><span style="color: #9c91e4; font-weight: bold;">\\</span><span style="color: #9c91e4; font-weight: bold;">(</span><span style="color: #e2c770;">[0-9]+</span><span style="color: #9c91e4; font-weight: bold;">\\</span><span style="color: #9c91e4; font-weight: bold;">)</span><span style="color: #e2c770;">:</span><span style="color: #9c91e4; font-weight: bold;">\\</span><span style="color: #9c91e4; font-weight: bold;">(</span><span style="color: #e2c770;">[0-9]+</span><span style="color: #9c91e4; font-weight: bold;">\\</span><span style="color: #9c91e4; font-weight: bold;">)</span><span style="color: #e2c770;">"</span> s<span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
      <span style="color: #eb4509;">(</span><span style="color: #eb4509;">let</span> <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">(</span>hour <span style="color: #eb4509;">(</span><span style="color: #fd971f;">string-to-number</span> <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">match-string</span> <span style="color: #9c91e4; font-weight: bold;">1</span> s<span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
            <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">min</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">string-to-number</span> <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">match-string</span> <span style="color: #9c91e4; font-weight: bold;">2</span> s<span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
            <span style="color: #b6e63e;">(</span>sec <span style="color: #eb4509;">(</span><span style="color: #fd971f;">string-to-number</span> <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">match-string</span> <span style="color: #9c91e4; font-weight: bold;">3</span> s<span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>
        <span style="color: #fd971f;">(</span><span style="color: #fd971f;">+</span> <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">*</span> hour <span style="color: #9c91e4; font-weight: bold;">3600</span><span style="color: #b6e63e;">)</span> <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">*</span> min <span style="color: #9c91e4; font-weight: bold;">60</span><span style="color: #b6e63e;">)</span> sec<span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
     <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">(</span><span style="color: #eb4509;">and</span> <span style="color: #fd971f;">(</span><span style="color: #fd971f;">stringp</span> s<span style="color: #fd971f;">)</span>
           <span style="color: #fd971f;">(</span><span style="color: #fd971f;">string-match</span> <span style="color: #e2c770;">"</span><span style="color: #9c91e4; font-weight: bold;">\\</span><span style="color: #9c91e4; font-weight: bold;">(</span><span style="color: #e2c770;">[0-9]+</span><span style="color: #9c91e4; font-weight: bold;">\\</span><span style="color: #9c91e4; font-weight: bold;">)</span><span style="color: #e2c770;">:</span><span style="color: #9c91e4; font-weight: bold;">\\</span><span style="color: #9c91e4; font-weight: bold;">(</span><span style="color: #e2c770;">[0-9]+</span><span style="color: #9c91e4; font-weight: bold;">\\</span><span style="color: #9c91e4; font-weight: bold;">)</span><span style="color: #e2c770;">"</span> s<span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
      <span style="color: #eb4509;">(</span><span style="color: #eb4509;">let</span> <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">(</span><span style="color: #fd971f;">min</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">string-to-number</span> <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">match-string</span> <span style="color: #9c91e4; font-weight: bold;">1</span> s<span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
            <span style="color: #b6e63e;">(</span>sec <span style="color: #eb4509;">(</span><span style="color: #fd971f;">string-to-number</span> <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">match-string</span> <span style="color: #9c91e4; font-weight: bold;">2</span> s<span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>
        <span style="color: #fd971f;">(</span><span style="color: #fd971f;">+</span> <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">*</span> min <span style="color: #9c91e4; font-weight: bold;">60</span><span style="color: #b6e63e;">)</span> sec<span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
     <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">(</span><span style="color: #fd971f;">stringp</span> s<span style="color: #eb4509;">)</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">string-to-number</span> s<span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
     <span style="color: #b6e63e;">(</span>t s<span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>

  <span style="color: #eb4509;">(</span><span style="color: #eb4509;">defun</span> <span style="color: #b6e63e;">org-time-seconds-to-string</span> <span style="color: #fd971f;">(</span>secs<span style="color: #fd971f;">)</span>
    <span style="color: #7f7f80;">"Convert a number of seconds to a time string."</span>
    <span style="color: #fd971f;">(</span><span style="color: #eb4509;">cond</span> <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">(</span><span style="color: #fd971f;">&gt;=</span> secs <span style="color: #9c91e4; font-weight: bold;">3600</span><span style="color: #eb4509;">)</span> <span style="color: #eb4509;">(</span><span style="color: #b6e63e;">format-seconds</span> <span style="color: #e2c770;">"%h:%.2m:%.2s"</span> secs<span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
          <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">(</span><span style="color: #fd971f;">&gt;=</span> secs <span style="color: #9c91e4; font-weight: bold;">60</span><span style="color: #eb4509;">)</span> <span style="color: #eb4509;">(</span><span style="color: #b6e63e;">format-seconds</span> <span style="color: #e2c770;">"%m:%.2s"</span> secs<span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
          <span style="color: #b6e63e;">(</span>t <span style="color: #eb4509;">(</span><span style="color: #b6e63e;">format-seconds</span> <span style="color: #e2c770;">"%s"</span> secs<span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>

  <span style="color: #eb4509;">(</span><span style="color: #eb4509;">defmacro</span> <span style="color: #b6e63e;">with-time</span> <span style="color: #fd971f;">(</span>time-output-p <span style="color: #66d9ef;">&amp;rest</span> exprs<span style="color: #fd971f;">)</span>
    <span style="color: #7f7f80;">"Evaluate an org-table formula, converting all fields that look</span>
<span style="color: #7f7f80;">  like time data to integer seconds.  If TIME-OUTPUT-P then return</span>
<span style="color: #7f7f80;">  the result as a time value."</span>
    <span style="color: #fd971f;">(</span><span style="color: #fd971f;">list</span>
     <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">if</span> time-output-p <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">org-time-seconds-to-string</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">identity</span><span style="color: #b6e63e;">)</span>
     <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">cons</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">progn</span>
           <span style="color: #eb4509;">(</span><span style="color: #fd971f;">mapcar</span>
            <span style="color: #fd971f;">(</span><span style="color: #eb4509;">lambda</span> <span style="color: #b6e63e;">(</span>expr<span style="color: #b6e63e;">)</span>
              <span style="color: #9c91e4;">`</span>,<span style="color: #b6e63e;">(</span><span style="color: #fd971f;">cons</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">car</span> expr<span style="color: #eb4509;">)</span>
                      <span style="color: #eb4509;">(</span><span style="color: #fd971f;">mapcar</span>
                       <span style="color: #fd971f;">(</span><span style="color: #eb4509;">lambda</span> <span style="color: #b6e63e;">(</span>el<span style="color: #b6e63e;">)</span>
                         <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">if</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">listp</span> el<span style="color: #eb4509;">)</span>
                             <span style="color: #eb4509;">(</span><span style="color: #fd971f;">list</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">with-time</span> nil el<span style="color: #eb4509;">)</span>
                           <span style="color: #eb4509;">(</span><span style="color: #b6e63e;">org-time-string-to-seconds</span> el<span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>
                       <span style="color: #fd971f;">(</span><span style="color: #fd971f;">cdr</span> expr<span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>
            <span style="color: #9c91e4;">`</span>,@exprs<span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
</pre>
</div>

<p>
Which allows the following forms of table manipulation such as adding
and subtracting time values.
</p>
<pre class="example">
| Date             | Start | Lunch |  Back |   End |  Sum |
|------------------+-------+-------+-------+-------+------|
| [2011-03-01 Tue] |  8:00 | 12:00 | 12:30 | 18:15 | 9:45 |
#+TBLFM: $6='(with-time t (+ (- $5 $4) (- $3 $2)))
</pre>


<p>
and dividing time values by integers
</p>
<pre class="example">
|  time | miles | minutes/mile |
|-------+-------+--------------|
| 34:43 |   2.9 |        11:58 |
| 32:15 |  2.77 |        11:38 |
| 33:56 |   3.0 |        11:18 |
| 52:22 |  4.62 |        11:20 |
#+TBLFM: $3='(with-time t (/ $1 $2))
</pre>


<p>
<b>Update</b>: As of Org version 7.6, you can use the <code>T</code> flag (both in Calc and
Elisp formulas) to compute time durations.  For example:
</p>

<pre class="example">
| Task 1 | Task 2 |   Total |
|--------+--------+---------|
|  35:00 |  35:00 | 1:10:00 |
#+TBLFM: @2$3=$1+$2;T
</pre>
</div>
</div>

<div id="outline-container-org93902ed" class="outline-4">
<h4 id="org93902ed">Dates computation</h4>
<div class="outline-text-4" id="text-org93902ed">
<p>
Xin Shi <a href="https://orgmode.org/list/5236d6f90907211206y20951c9dtc711cf71afc520e2@mail.gmail.com">asked</a> for a way to calculate the duration of
dates stored in an org table.
</p>

<p>
Nick Dokos <a href="https://orgmode.org/list/10926.1248205548@alphaville.usa.hp.com">suggested</a>:
</p>

<p>
Try the following:
</p>

<pre class="example">
| Start Date |   End Date | Duration |
|------------+------------+----------|
| 2004.08.07 | 2005.07.08 |      335 |
#+TBLFM: $3=(date(&lt;$2&gt;)-date(&lt;$1&gt;))
</pre>


<p>
See <a href="https://orgmode.org/list/17380.1218757692@alphaville.usa.hp.com">this thread</a> as well as <a href="https://orgmode.org/list/48A5BADA.4070507@cs.tu-berlin.de">this post</a> (which is really a followup on the
above).  The problem that this last article pointed out was solved in <a href="https://orgmode.org/list/18981.1220565299@alphaville.usa.hp.com">this
post</a> and Chris Randle&rsquo;s original musings are <a href="https://orgmode.org/list/00be01c8a9f4$a310ca00$6580a8c0@CUBE">here</a>.
</p>
</div>
</div>

<div id="outline-container-orgc2f288e" class="outline-4">
<h4 id="orgc2f288e">Hex computation</h4>
<div class="outline-text-4" id="text-orgc2f288e">
<p>
As with Times computation, the following code allows Computation with
Hex values in Org-mode tables using the <code>with-hex</code> macro.
</p>

<p>
Here is the code implementing this macro.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span style="color: #eb4509;">(</span><span style="color: #eb4509;">defun</span> <span style="color: #b6e63e;">org-hex-strip-lead</span> <span style="color: #fd971f;">(</span>str<span style="color: #fd971f;">)</span>
    <span style="color: #fd971f;">(</span><span style="color: #eb4509;">if</span> <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">and</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">&gt;</span> <span style="color: #fd971f;">(</span><span style="color: #fd971f;">length</span> str<span style="color: #fd971f;">)</span> <span style="color: #9c91e4; font-weight: bold;">2</span><span style="color: #eb4509;">)</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">string=</span> <span style="color: #fd971f;">(</span><span style="color: #fd971f;">substring</span> str <span style="color: #9c91e4; font-weight: bold;">0</span> <span style="color: #9c91e4; font-weight: bold;">2</span><span style="color: #fd971f;">)</span> <span style="color: #e2c770;">"0x"</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
        <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">substring</span> str <span style="color: #9c91e4; font-weight: bold;">2</span><span style="color: #b6e63e;">)</span> str<span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>

  <span style="color: #eb4509;">(</span><span style="color: #eb4509;">defun</span> <span style="color: #b6e63e;">org-hex-to-hex</span> <span style="color: #fd971f;">(</span>int<span style="color: #fd971f;">)</span>
    <span style="color: #fd971f;">(</span><span style="color: #fd971f;">format</span> <span style="color: #e2c770;">"0x%x"</span> int<span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>

  <span style="color: #eb4509;">(</span><span style="color: #eb4509;">defun</span> <span style="color: #b6e63e;">org-hex-to-dec</span> <span style="color: #fd971f;">(</span>str<span style="color: #fd971f;">)</span>
    <span style="color: #fd971f;">(</span><span style="color: #eb4509;">cond</span>
     <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">(</span><span style="color: #eb4509;">and</span> <span style="color: #fd971f;">(</span><span style="color: #fd971f;">stringp</span> str<span style="color: #fd971f;">)</span>
           <span style="color: #fd971f;">(</span><span style="color: #fd971f;">string-match</span> <span style="color: #e2c770;">"</span><span style="color: #9c91e4; font-weight: bold;">\\</span><span style="color: #9c91e4; font-weight: bold;">(</span><span style="color: #e2c770;">[0-9a-f]+</span><span style="color: #9c91e4; font-weight: bold;">\\</span><span style="color: #9c91e4; font-weight: bold;">)</span><span style="color: #e2c770;">"</span> <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">setf</span> str <span style="color: #eb4509;">(</span>org-hex-strip-lead str<span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
      <span style="color: #eb4509;">(</span><span style="color: #eb4509;">let</span> <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">(</span>out <span style="color: #9c91e4; font-weight: bold;">0</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>
        <span style="color: #fd971f;">(</span><span style="color: #fd971f;">mapc</span>
         <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">lambda</span> <span style="color: #eb4509;">(</span>ch<span style="color: #eb4509;">)</span>
           <span style="color: #eb4509;">(</span><span style="color: #eb4509;">setf</span> out <span style="color: #fd971f;">(</span><span style="color: #fd971f;">+</span> <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">*</span> out <span style="color: #9c91e4; font-weight: bold;">16</span><span style="color: #b6e63e;">)</span>
                        <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">if</span> <span style="color: #eb4509;">(</span><span style="color: #eb4509;">and</span> <span style="color: #fd971f;">(</span><span style="color: #fd971f;">&gt;=</span> ch <span style="color: #9c91e4; font-weight: bold;">48</span><span style="color: #fd971f;">)</span> <span style="color: #fd971f;">(</span><span style="color: #fd971f;">&lt;=</span> ch <span style="color: #9c91e4; font-weight: bold;">57</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">-</span> ch <span style="color: #9c91e4; font-weight: bold;">48</span><span style="color: #eb4509;">)</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">-</span> ch <span style="color: #9c91e4; font-weight: bold;">87</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
         <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">coerce</span> <span style="color: #eb4509;">(</span><span style="color: #b6e63e;">match-string</span> <span style="color: #9c91e4; font-weight: bold;">1</span> str<span style="color: #eb4509;">)</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">list</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>
        out<span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
     <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">(</span><span style="color: #fd971f;">stringp</span> str<span style="color: #eb4509;">)</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">string-to-number</span> str<span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
     <span style="color: #b6e63e;">(</span>t str<span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>

  <span style="color: #eb4509;">(</span><span style="color: #eb4509;">defmacro</span> <span style="color: #b6e63e;">with-hex</span> <span style="color: #fd971f;">(</span>hex-output-p <span style="color: #66d9ef;">&amp;rest</span> exprs<span style="color: #fd971f;">)</span>
    <span style="color: #7f7f80;">"Evaluate an org-table formula, converting all fields that look</span>
<span style="color: #7f7f80;">      like hexadecimal to decimal integers.  If HEX-OUTPUT-P then</span>
<span style="color: #7f7f80;">      return the result as a hex value."</span>
    <span style="color: #fd971f;">(</span><span style="color: #fd971f;">list</span>
     <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">if</span> hex-output-p <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">org-hex-to-hex</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">identity</span><span style="color: #b6e63e;">)</span>
     <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">cons</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">progn</span>
           <span style="color: #eb4509;">(</span><span style="color: #fd971f;">mapcar</span>
            <span style="color: #fd971f;">(</span><span style="color: #eb4509;">lambda</span> <span style="color: #b6e63e;">(</span>expr<span style="color: #b6e63e;">)</span>
              <span style="color: #9c91e4;">`</span>,<span style="color: #b6e63e;">(</span><span style="color: #fd971f;">cons</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">car</span> expr<span style="color: #eb4509;">)</span>
                      <span style="color: #eb4509;">(</span><span style="color: #fd971f;">mapcar</span> <span style="color: #fd971f;">(</span><span style="color: #eb4509;">lambda</span> <span style="color: #b6e63e;">(</span>el<span style="color: #b6e63e;">)</span>
                                <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">if</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">listp</span> el<span style="color: #eb4509;">)</span>
                                    <span style="color: #eb4509;">(</span><span style="color: #fd971f;">list</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">with-hex</span> nil el<span style="color: #eb4509;">)</span>
                                  <span style="color: #eb4509;">(</span>org-hex-to-dec el<span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>
                              <span style="color: #fd971f;">(</span><span style="color: #fd971f;">cdr</span> expr<span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>
            <span style="color: #9c91e4;">`</span>,@exprs<span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
</pre>
</div>

<p>
Which allows the following forms of table manipulation such as adding
and subtracting hex values.
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-right" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-right">0x10</td>
<td class="org-right">0x0</td>
<td class="org-left">#ERROR</td>
<td class="org-left">#ERROR</td>
</tr>

<tr>
<td class="org-right">0x20</td>
<td class="org-right">0x1</td>
<td class="org-left">#ERROR</td>
<td class="org-left">#ERROR</td>
</tr>

<tr>
<td class="org-right">0x30</td>
<td class="org-right">0x2</td>
<td class="org-left">#ERROR</td>
<td class="org-left">#ERROR</td>
</tr>

<tr>
<td class="org-right">0xf0</td>
<td class="org-right">0xf</td>
<td class="org-left">#ERROR</td>
<td class="org-left">#ERROR</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-field-coordinates-in-formulas" class="outline-4">
<h4 id="field-coordinates-in-formulas">Field coordinates in formulas (<code>@#</code> and <code>$#</code>)</h4>
<div class="outline-text-4" id="text-field-coordinates-in-formulas">
<p>
&#x2013; Michael Brand
</p>

<p>
Following are some use cases that can be implemented with the field
coordinates in formulas described in the corresponding chapter in the
<a href="https://orgmode.org/manual/References.html#References">Org manual</a>.
</p>
</div>

<ul class="org-ul">
<li><a id="field-coordinates-in-formulas-copy-col-to-col"></a>Copy a column from a remote table into a column<br />
<div class="outline-text-5" id="text-field-coordinates-in-formulas-copy-col-to-col">
<p>
current column <code>$3</code> = remote column <code>$2</code>:
</p>
<pre class="example">
#+TBLFM: $3 = remote(FOO, @@#$2)
</pre>
</div>
</li>

<li><a id="field-coordinates-in-formulas-copy-row-to-col"></a>Copy a row from a remote table transposed into a column<br />
<div class="outline-text-5" id="text-field-coordinates-in-formulas-copy-row-to-col">
<p>
current column <code>$1</code> = transposed remote row <code>@1</code>:
</p>
<pre class="example">
#+TBLFM: $1 = remote(FOO, @$#$@#)
</pre>
</div>
</li>

<li><a id="field-coordinates-in-formulas-transpose-table"></a>Transpose table<br />
<div class="outline-text-5" id="text-field-coordinates-in-formulas-transpose-table">
<p>
&#x2013; Michael Brand
</p>

<p>
This is more like a demonstration of using field coordinates in formulas
and is bound to be slow for large tables. See the discussion in the mailing
list on
<a href="https://orgmode.org/list/82e274891002251643k327135aajea270914244abff7@mail.gmail.com">gmane</a> or
<a href="http://lists.gnu.org/archive/html/emacs-orgmode/2010-04/msg00086.html">gnu</a>.
For more efficient solutions see
<a href="#transpose-table">Worg</a>.
</p>

<p>
To transpose this 4x7 table
</p>

<pre class="example">
#+TBLNAME: FOO
| year | 2004 | 2005 | 2006 | 2007 | 2008 | 2009 |
|------+------+------+------+------+------+------|
| min  |  401 |  501 |  601 |  701 |  801 |  901 |
| avg  |  402 |  502 |  602 |  702 |  802 |  902 |
| max  |  403 |  503 |  603 |  703 |  803 |  903 |
</pre>


<p>
start with a 7x4 table without any horizontal line (to have filled
also the column header) and yet empty:
</p>

<pre class="example">
|   |   |   |   |
|   |   |   |   |
|   |   |   |   |
|   |   |   |   |
|   |   |   |   |
|   |   |   |   |
|   |   |   |   |
</pre>


<p>
Then add the <code>TBLFM</code> line below.  After recalculation this will end up with
the transposed copy:
</p>

<pre class="example">
| year | min | avg | max |
| 2004 | 401 | 402 | 403 |
| 2005 | 501 | 502 | 503 |
| 2006 | 601 | 602 | 603 |
| 2007 | 701 | 702 | 703 |
| 2008 | 801 | 802 | 803 |
| 2009 | 901 | 902 | 903 |
#+TBLFM: @&lt;$&lt;..@&gt;$&gt; = remote(FOO, @$#$@#)
</pre>


<p>
The formula simply exchanges row and column numbers by taking
</p>
<ul class="org-ul">
<li>the absolute remote row number <code>@$#</code> from the current column number <code>$#</code></li>
<li>the absolute remote column number <code>$@#</code> from the current row number <code>@#</code></li>
</ul>

<p>
Formulas to be taken over from the remote table will have to be transformed
manually.
</p>
</div>
</li>

<li><a id="org6119b25"></a>Dynamic variation of ranges<br />
<div class="outline-text-5" id="text-org6119b25">
<p>
&#x2013; Michael Brand
</p>

<p>
In this example all columns next to <code>quote</code> are calculated from the column
<code>quote</code> and show the average change of the time series <code>quote[year]</code>
during the period of the preceding <code>1</code>, <code>2</code>, <code>3</code> or <code>4</code> years:
</p>

<pre class="example">
| year | quote |   1 a |   2 a |   3 a |   4 a |
|------+-------+-------+-------+-------+-------|
| 2005 |    10 |       |       |       |       |
| 2006 |    12 | 0.200 |       |       |       |
| 2007 |    14 | 0.167 | 0.183 |       |       |
| 2008 |    16 | 0.143 | 0.155 | 0.170 |       |
| 2009 |    18 | 0.125 | 0.134 | 0.145 | 0.158 |
#+TBLFM: @I$3..@&gt;$&gt;=if(@# &gt;= $#, ($2 / subscr(@-I$2..@+I$2, @# + 1 - $#)) ^ (1 / ($# - 2)) - 1, string("")) +.0; f-3
</pre>


<p>
The important part of the formula without the field blanking is:
</p>

<pre class="example">
($2 / subscr(@-I$2..@+I$2, @# + 1 - $#)) ^ (1 / ($# - 2)) - 1
</pre>


<p>
which is the Emacs Calc implementation of the equation
</p>

<p>
<i>AvgChange(i, a) = (quote[i] / quote[i - a]) ^ (1 / a) - 1</i>
</p>

<p>
where <i>i</i> is the current time and <i>a</i> is the length of the preceding period.
</p>
</div>
</li>
</ul>
</div>

<div id="outline-container-field-same-row-or-column" class="outline-4">
<h4 id="field-same-row-or-column">Rearrange one or more field within the same row or column</h4>
<div class="outline-text-4" id="text-field-same-row-or-column">
<p>
&#x2013; Michael Brand
</p>
</div>

<ul class="org-ul">
<li><a id="column-sequence-in-row"></a>Rearrange the column sequence in one row only<br />
<div class="outline-text-5" id="text-column-sequence-in-row">
<p>
The functions below can be used to change the column sequence in one
row only, without affecting the other rows above and below like with
<code>M-&lt;left&gt;</code> or <code>M-&lt;right&gt;</code> (<code>org-table-move-column</code>).  See also the
docstring of the functions for more explanations.  The original table
that serves as the starting point for the examples:
</p>

<pre class="example">
| a | b | c  | d  |
| e | 9 | 10 | 11 |
| f | g | h  | i  |
</pre>
</div>

<ul class="org-ul">
<li><a id="orgbf8bc7c"></a>Move current field in row<br />
<ul class="org-ul">
<li><a id="org399f2c8"></a>Left<br />
<div class="outline-text-7" id="text-org399f2c8">
<ol class="org-ol">
<li>place point at &ldquo;10&rdquo; in original table</li>
<li><code>M-x f-org-table-move-field-in-row-left</code></li>
<li>point is at moved &ldquo;10&rdquo;</li>
</ol>

<pre class="example">
| a | b  | c | d  |
| e | 10 | 9 | 11 |
| f | g  | h | i  |
</pre>
</div>
</li>

<li><a id="org23bbc33"></a>Right<br />
<div class="outline-text-7" id="text-org23bbc33">
<ol class="org-ol">
<li>place point at &ldquo;9&rdquo; in original table</li>
<li><code>M-x f-org-table-move-field-in-row-right</code></li>
<li>point is at moved &ldquo;9&rdquo;</li>
</ol>

<pre class="example">
| a | b  | c | d  |
| e | 10 | 9 | 11 |
| f | g  | h | i  |
</pre>
</div>
</li>
</ul>
</li>

<li><a id="org89c1494"></a>Rotate rest of row (range from current field to end of row)<br />
<ul class="org-ul">
<li><a id="org96f3787"></a>Left<br />
<div class="outline-text-7" id="text-org96f3787">
<ol class="org-ol">
<li>place point at @2$2 in original table</li>
<li><code>M-x f-org-table-rotate-rest-of-row-left</code></li>
<li>point is still at @2$2</li>
</ol>

<pre class="example">
| a | b  | c  | d |
| e | 10 | 11 | 9 |
| f | g  | h  | i |
</pre>
</div>
</li>

<li><a id="orgc8132f6"></a>Right<br />
<div class="outline-text-7" id="text-orgc8132f6">
<ol class="org-ol">
<li>place point at @2$2 in original table</li>
<li><code>M-x f-org-table-rotate-rest-of-row-right</code></li>
<li>point is still at @2$2</li>
</ol>

<pre class="example">
| a | b  | c | d  |
| e | 11 | 9 | 10 |
| f | g  | h | i  |
</pre>
</div>
</li>
</ul>
</li>

<li><a id="org0af0b23"></a>Open field in row (table size grows)<br />
<div class="outline-text-6" id="text-org0af0b23">
<p>
This is just for completeness, interactively the same as typing <code>|
S-TAB</code>.
</p>

<ol class="org-ol">
<li>place point at @2$2 in original table</li>
<li><code>M-x f-org-table-open-field-in-row-grow</code></li>
<li>point is still at @2$2</li>
</ol>

<pre class="example">
| a | b | c | d  |    |
| e |   | 9 | 10 | 11 |
| f | g | h | i  |    |
</pre>
</div>
</li>
</ul>
</li>

<li><a id="row-sequence-in-column"></a>Rearrange the row sequence in one column only<br />
<div class="outline-text-5" id="text-row-sequence-in-column">
<p>
The functions below can be used to change the column sequence in one
column only, without affecting the other columns left and right like
with <code>M-&lt;up&gt;</code> or <code>M-&lt;down&gt;</code> (<code>org-table-move-row</code>).  See also the
docstring of the functions for more explanations.  The original table
that serves as the starting point for the examples:
</p>

<pre class="example">
| a |  b | c |
|---+----+---|
| d |  9 | e |
| f | 10 | g |
|---+----+---|
| h | 11 | i |
</pre>
</div>

<ul class="org-ul">
<li><a id="org978194b"></a>Move current field in column<br />
<ul class="org-ul">
<li><a id="org87801ce"></a>Up<br />
<div class="outline-text-7" id="text-org87801ce">
<ol class="org-ol">
<li>place point at &ldquo;10&rdquo; in original table</li>
<li><code>M-x f-org-table-move-field-in-column-up</code></li>
<li>point is at moved &ldquo;10&rdquo;</li>
</ol>

<pre class="example">
| a |  b | c |
|---+----+---|
| d | 10 | e |
| f |  9 | g |
|---+----+---|
| h | 11 | i |
</pre>
</div>
</li>

<li><a id="org6019c0a"></a>Down<br />
<div class="outline-text-7" id="text-org6019c0a">
<ol class="org-ol">
<li>place point at &ldquo;9&rdquo; in original table</li>
<li><code>M-x f-org-table-move-field-in-column-down</code></li>
<li>point is at moved &ldquo;9&rdquo;</li>
</ol>

<pre class="example">
| a |  b | c |
|---+----+---|
| d | 10 | e |
| f |  9 | g |
|---+----+---|
| h | 11 | i |
</pre>
</div>
</li>
</ul>
</li>

<li><a id="orgbc79ed7"></a>Rotate rest of column (range from current field to end of column)<br />
<ul class="org-ul">
<li><a id="orga6cb61b"></a>Up<br />
<div class="outline-text-7" id="text-orga6cb61b">
<ol class="org-ol">
<li>place point at @2$2 in original table</li>
<li><code>M-x f-org-table-rotate-rest-of-column-up</code></li>
<li>point is still at @2$2</li>
</ol>

<pre class="example">
| a |  b | c |
|---+----+---|
| d | 10 | e |
| f | 11 | g |
|---+----+---|
| h |  9 | i |
</pre>
</div>
</li>

<li><a id="org351a24a"></a>Down<br />
<div class="outline-text-7" id="text-org351a24a">
<ol class="org-ol">
<li>place point at @2$2 in original table</li>
<li><code>M-x f-org-table-rotate-rest-of-column-down</code></li>
<li>point is still at @2$2</li>
</ol>

<pre class="example">
| a |  b | c |
|---+----+---|
| d | 11 | e |
| f |  9 | g |
|---+----+---|
| h | 10 | i |
</pre>
</div>
</li>
</ul>
</li>

<li><a id="org5e618df"></a>Open field in column (table size grows)<br />
<div class="outline-text-6" id="text-org5e618df">
<ol class="org-ol">
<li>place point at @2$2 in original table</li>
<li><code>M-x f-org-table-open-field-in-column-grow</code></li>
<li>point is still at @2$2</li>
</ol>

<pre class="example">
| a |  b | c |
|---+----+---|
| d |    | e |
| f |  9 | g |
|---+----+---|
| h | 10 | i |
|   | 11 |   |
</pre>
</div>
</li>
</ul>
</li>

<li><a id="org68fbc33"></a>Key bindings for some of the functions<br />
<div class="outline-text-5" id="text-org68fbc33">
<p>
I have this in an Org buffer to change temporarily to the desired
behavior with <code>C-c C-c</code> on one of the three code snippets:
</p>

<pre class="example">
- move in row:
  #+begin_src emacs-lisp :results silent
    (org-defkey org-mode-map [(meta left)]
                'f-org-table-move-field-in-row-left)
    (org-defkey org-mode-map [(meta right)]
                'f-org-table-move-field-in-row-right)
    (org-defkey org-mode-map [(left)]  'org-table-previous-field)
    (org-defkey org-mode-map [(right)] 'org-table-next-field)
  #+end_src

- rotate in row:
  #+begin_src emacs-lisp :results silent
    (org-defkey org-mode-map [(meta left)]
                'f-org-table-rotate-rest-of-row-left)
    (org-defkey org-mode-map [(meta right)]
                'f-org-table-rotate-rest-of-row-right)
    (org-defkey org-mode-map [(left)]  'org-table-previous-field)
    (org-defkey org-mode-map [(right)] 'org-table-next-field)
  #+end_src

- back to original:
  #+begin_src emacs-lisp :results silent
    (org-defkey org-mode-map [(meta left)]  'org-metaleft)
    (org-defkey org-mode-map [(meta right)] 'org-metaright)
    (org-defkey org-mode-map [(left)]  'backward-char)
    (org-defkey org-mode-map [(right)] 'forward-char)
  #+end_src
</pre>
</div>
</li>

<li><a id="orgd675203"></a>Implementation<br />
<div class="outline-text-5" id="text-orgd675203">
<p>
The functions
</p>

<pre class="example">
f-org-table-move-field-in-column-up
f-org-table-move-field-in-column-down
f-org-table-rotate-rest-of-column-up
f-org-table-rotate-rest-of-column-down
</pre>


<p>
are not yet implemented.  They could be done similar to
<code>f-org-table-open-field-in-column-grow</code>.  A workaround without keeping
horizontal separator lines is to interactively or programmatically
simply:
</p>

<ol class="org-ol">
<li>Transpose the table, see
<a href="#transpose-table">Org hacks</a>.</li>
<li>Use <code>f-org-table-*-column-in-row-*</code>, see
<a href="https://orgmode.org/worg/org-hacks.html#column-sequence-in-row">previous
section</a>.</li>
<li>Transpose the table.</li>
</ol>

<p>
The other functions:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span style="color: #eb4509;">(</span><span style="color: #eb4509;">defun</span> <span style="color: #b6e63e;">f-org-table-move-field-in-row-left</span> <span style="color: #fd971f;">()</span>
    <span style="color: #7f7f80;">"Move current field in row to the left."</span>
    <span style="color: #fd971f;">(</span><span style="color: #eb4509;">interactive</span><span style="color: #fd971f;">)</span>
    <span style="color: #fd971f;">(</span>f-org-table-move-field-in-row <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">left</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
  <span style="color: #eb4509;">(</span><span style="color: #eb4509;">defun</span> <span style="color: #b6e63e;">f-org-table-move-field-in-row-right</span> <span style="color: #fd971f;">()</span>
    <span style="color: #7f7f80;">"Move current field in row to the right."</span>
    <span style="color: #fd971f;">(</span><span style="color: #eb4509;">interactive</span><span style="color: #fd971f;">)</span>
    <span style="color: #fd971f;">(</span>f-org-table-move-field-in-row nil<span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>

  <span style="color: #eb4509;">(</span><span style="color: #eb4509;">defun</span> <span style="color: #b6e63e;">f-org-table-move-field-in-row</span> <span style="color: #fd971f;">(</span><span style="color: #66d9ef;">&amp;optional</span> left<span style="color: #fd971f;">)</span>
    <span style="color: #7f7f80;">"Move current field in row to the right.</span>
<span style="color: #7f7f80;">  With arg LEFT, move to the left.  For repeated invocation the</span>
<span style="color: #7f7f80;">  point follows the moved field.  Does not fix formulas."</span>
    <span style="color: #696969;">;; </span><span style="color: #696969;">Derived from `</span><span style="color: #fd971f;">org-table-move-column</span><span style="color: #696969;">'</span>
    <span style="color: #fd971f;">(</span><span style="color: #eb4509;">interactive</span> <span style="color: #e2c770;">"P"</span><span style="color: #fd971f;">)</span>
    <span style="color: #fd971f;">(</span><span style="color: #eb4509;">if</span> <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">not</span> <span style="color: #eb4509;">(</span><span style="color: #b6e63e;">org-at-table-p</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
        <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">error</span> <span style="color: #e2c770;">"Not at a table"</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>
    <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">org-table-find-dataline</span><span style="color: #fd971f;">)</span>
    <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">org-table-check-inside-data-field</span><span style="color: #fd971f;">)</span>
    <span style="color: #fd971f;">(</span><span style="color: #eb4509;">let*</span> <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">(</span>col <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">org-table-current-column</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
           <span style="color: #eb4509;">(</span>col1 <span style="color: #fd971f;">(</span><span style="color: #eb4509;">if</span> left <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">1-</span> col<span style="color: #b6e63e;">)</span> col<span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
           <span style="color: #696969;">;; </span><span style="color: #696969;">Current cursor position</span>
           <span style="color: #eb4509;">(</span>colpos <span style="color: #fd971f;">(</span><span style="color: #eb4509;">if</span> left <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">1-</span> col<span style="color: #b6e63e;">)</span> <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">1+</span> col<span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
      <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">if</span> <span style="color: #eb4509;">(</span><span style="color: #eb4509;">and</span> left <span style="color: #fd971f;">(</span><span style="color: #fd971f;">=</span> col <span style="color: #9c91e4; font-weight: bold;">1</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
          <span style="color: #eb4509;">(</span><span style="color: #b6e63e;">error</span> <span style="color: #e2c770;">"Cannot move column further left"</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
      <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">if</span> <span style="color: #eb4509;">(</span><span style="color: #eb4509;">and</span> <span style="color: #fd971f;">(</span><span style="color: #fd971f;">not</span> left<span style="color: #fd971f;">)</span> <span style="color: #fd971f;">(</span><span style="color: #fd971f;">looking-at</span> <span style="color: #e2c770;">"[</span><span style="color: #9c91e4; font-weight: bold;">^</span><span style="color: #e2c770;">|\n]*|[</span><span style="color: #9c91e4; font-weight: bold;">^</span><span style="color: #e2c770;">|\n]*$"</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
          <span style="color: #eb4509;">(</span><span style="color: #b6e63e;">error</span> <span style="color: #e2c770;">"Cannot move column further right"</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
      <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">org-table-goto-column</span> col1 t<span style="color: #b6e63e;">)</span>
      <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">and</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">looking-at</span> <span style="color: #e2c770;">"|</span><span style="color: #9c91e4; font-weight: bold;">\\</span><span style="color: #9c91e4; font-weight: bold;">(</span><span style="color: #e2c770;">[</span><span style="color: #9c91e4; font-weight: bold;">^</span><span style="color: #e2c770;">|\n]+</span><span style="color: #9c91e4; font-weight: bold;">\\</span><span style="color: #9c91e4; font-weight: bold;">)</span><span style="color: #e2c770;">|</span><span style="color: #9c91e4; font-weight: bold;">\\</span><span style="color: #9c91e4; font-weight: bold;">(</span><span style="color: #e2c770;">[</span><span style="color: #9c91e4; font-weight: bold;">^</span><span style="color: #e2c770;">|\n]+</span><span style="color: #9c91e4; font-weight: bold;">\\</span><span style="color: #9c91e4; font-weight: bold;">)</span><span style="color: #e2c770;">|"</span><span style="color: #eb4509;">)</span>
           <span style="color: #eb4509;">(</span><span style="color: #fd971f;">replace-match</span> <span style="color: #e2c770;">"|\\2|\\1|"</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
      <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">org-table-goto-column</span> colpos<span style="color: #b6e63e;">)</span>
      <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">org-table-align</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>

  <span style="color: #eb4509;">(</span><span style="color: #eb4509;">defun</span> <span style="color: #b6e63e;">f-org-table-rotate-rest-of-row-left</span> <span style="color: #fd971f;">()</span>
    <span style="color: #7f7f80;">"Rotate rest of row to the left."</span>
    <span style="color: #fd971f;">(</span><span style="color: #eb4509;">interactive</span><span style="color: #fd971f;">)</span>
    <span style="color: #fd971f;">(</span>f-org-table-rotate-rest-of-row <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">left</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
  <span style="color: #eb4509;">(</span><span style="color: #eb4509;">defun</span> <span style="color: #b6e63e;">f-org-table-rotate-rest-of-row-right</span> <span style="color: #fd971f;">()</span>
    <span style="color: #7f7f80;">"Rotate rest of row to the right."</span>
    <span style="color: #fd971f;">(</span><span style="color: #eb4509;">interactive</span><span style="color: #fd971f;">)</span>
    <span style="color: #fd971f;">(</span>f-org-table-rotate-rest-of-row nil<span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>

  <span style="color: #eb4509;">(</span><span style="color: #eb4509;">defun</span> <span style="color: #b6e63e;">f-org-table-rotate-rest-of-row</span> <span style="color: #fd971f;">(</span><span style="color: #66d9ef;">&amp;optional</span> left<span style="color: #fd971f;">)</span>
    <span style="color: #7f7f80;">"Rotate rest of row to the right.</span>
<span style="color: #7f7f80;">  With arg LEFT, rotate to the left.  For both directions the</span>
<span style="color: #7f7f80;">  boundaries of the rotation range are the current field and the</span>
<span style="color: #7f7f80;">  field at the end of the row.  For repeated invocation the point</span>
<span style="color: #7f7f80;">  stays on the original current field.  Does not fix formulas."</span>
    <span style="color: #696969;">;; </span><span style="color: #696969;">Derived from `</span><span style="color: #fd971f;">org-table-move-column</span><span style="color: #696969;">'</span>
    <span style="color: #fd971f;">(</span><span style="color: #eb4509;">interactive</span> <span style="color: #e2c770;">"P"</span><span style="color: #fd971f;">)</span>
    <span style="color: #fd971f;">(</span><span style="color: #eb4509;">if</span> <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">not</span> <span style="color: #eb4509;">(</span><span style="color: #b6e63e;">org-at-table-p</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
        <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">error</span> <span style="color: #e2c770;">"Not at a table"</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>
    <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">org-table-find-dataline</span><span style="color: #fd971f;">)</span>
    <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">org-table-check-inside-data-field</span><span style="color: #fd971f;">)</span>
    <span style="color: #fd971f;">(</span><span style="color: #eb4509;">let</span> <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">(</span>col <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">org-table-current-column</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
      <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">org-table-goto-column</span> col t<span style="color: #b6e63e;">)</span>
      <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">and</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">looking-at</span> <span style="color: #fd971f;">(</span><span style="color: #eb4509;">if</span> left
                           <span style="color: #e2c770;">"|</span><span style="color: #9c91e4; font-weight: bold;">\\</span><span style="color: #9c91e4; font-weight: bold;">(</span><span style="color: #e2c770;">[</span><span style="color: #9c91e4; font-weight: bold;">^</span><span style="color: #e2c770;">|\n]+</span><span style="color: #9c91e4; font-weight: bold;">\\</span><span style="color: #9c91e4; font-weight: bold;">)</span><span style="color: #e2c770;">|</span><span style="color: #9c91e4; font-weight: bold;">\\</span><span style="color: #9c91e4; font-weight: bold;">(</span><span style="color: #e2c770;">[</span><span style="color: #9c91e4; font-weight: bold;">^</span><span style="color: #e2c770;">\n]+</span><span style="color: #9c91e4; font-weight: bold;">\\</span><span style="color: #9c91e4; font-weight: bold;">)</span><span style="color: #e2c770;">|$"</span>
                         <span style="color: #e2c770;">"|</span><span style="color: #9c91e4; font-weight: bold;">\\</span><span style="color: #9c91e4; font-weight: bold;">(</span><span style="color: #e2c770;">[</span><span style="color: #9c91e4; font-weight: bold;">^</span><span style="color: #e2c770;">\n]+</span><span style="color: #9c91e4; font-weight: bold;">\\</span><span style="color: #9c91e4; font-weight: bold;">)</span><span style="color: #e2c770;">|</span><span style="color: #9c91e4; font-weight: bold;">\\</span><span style="color: #9c91e4; font-weight: bold;">(</span><span style="color: #e2c770;">[</span><span style="color: #9c91e4; font-weight: bold;">^</span><span style="color: #e2c770;">|\n]+</span><span style="color: #9c91e4; font-weight: bold;">\\</span><span style="color: #9c91e4; font-weight: bold;">)</span><span style="color: #e2c770;">|$"</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
           <span style="color: #eb4509;">(</span><span style="color: #fd971f;">replace-match</span> <span style="color: #e2c770;">"|\\2|\\1|"</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
      <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">org-table-goto-column</span> col<span style="color: #b6e63e;">)</span>
      <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">org-table-align</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>

  <span style="color: #eb4509;">(</span><span style="color: #eb4509;">defun</span> <span style="color: #b6e63e;">f-org-table-open-field-in-row-grow</span> <span style="color: #fd971f;">()</span>
    <span style="color: #7f7f80;">"Open field in row, move fields to the right by growing table."</span>
    <span style="color: #fd971f;">(</span><span style="color: #eb4509;">interactive</span><span style="color: #fd971f;">)</span>
    <span style="color: #fd971f;">(</span><span style="color: #fd971f;">insert</span> <span style="color: #e2c770;">"|"</span><span style="color: #fd971f;">)</span>
    <span style="color: #fd971f;">(</span><span style="color: #fd971f;">backward-char</span><span style="color: #fd971f;">)</span>
    <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">org-table-align</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>

  <span style="color: #eb4509;">(</span><span style="color: #eb4509;">defun</span> <span style="color: #b6e63e;">f-org-table-open-field-in-column-grow</span> <span style="color: #fd971f;">()</span>
    <span style="color: #7f7f80;">"Open field in column, move all fields downwards by growing table."</span>
    <span style="color: #fd971f;">(</span><span style="color: #eb4509;">interactive</span><span style="color: #fd971f;">)</span>
    <span style="color: #fd971f;">(</span><span style="color: #eb4509;">let</span> <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">(</span>col <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">org-table-current-column</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
          <span style="color: #eb4509;">(</span>p   <span style="color: #fd971f;">(</span><span style="color: #fd971f;">point</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
      <span style="color: #696969;">;; </span><span style="color: #696969;">Cut all fields downwards in same column</span>
      <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">goto-char</span> <span style="color: #eb4509;">(</span><span style="color: #b6e63e;">org-table-end</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
      <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">forward-line</span> <span style="color: #9c91e4; font-weight: bold;">-1</span><span style="color: #b6e63e;">)</span>
      <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">while</span> <span style="color: #eb4509;">(</span><span style="color: #b6e63e;">org-at-table-hline-p</span><span style="color: #eb4509;">)</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">forward-line</span> <span style="color: #9c91e4; font-weight: bold;">-1</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
      <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">org-table-goto-column</span> col<span style="color: #b6e63e;">)</span>
      <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">org-table-cut-region</span> p <span style="color: #eb4509;">(</span><span style="color: #fd971f;">point</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
      <span style="color: #696969;">;; </span><span style="color: #696969;">Paste at one field below</span>
      <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">goto-char</span> p<span style="color: #b6e63e;">)</span>
      <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">forward-line</span><span style="color: #b6e63e;">)</span>
      <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">org-table-goto-column</span> col<span style="color: #b6e63e;">)</span>
      <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">org-table-paste-rectangle</span><span style="color: #b6e63e;">)</span>
      <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">goto-char</span> p<span style="color: #b6e63e;">)</span>
      <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">org-table-align</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
</pre>
</div>
</div>
</li>

<li><a id="org7ef8cf7"></a>Reasons why this is not put into the Org core<br />
<div class="outline-text-5" id="text-org7ef8cf7">
<p>
I consider this as only a hack for several reasons:
</p>

<ul class="org-ul">
<li>Generalization: The existing function <code>org-table-move-column</code> could
be enhanced with additional optional parameters to incorporate these
functionalities and could be used as the only function for better
maintainability.  Now it&rsquo;s only a copy/paste hack of several similar
functions with simple modifications.</li>
<li>Bindings: Should be convenient for repetition like <code>M-&lt;right&gt;</code>.
What should be bound where, what has to be left unbound?</li>
<li>Does not fix formulas.  Could be resolved for field formulas but
most probably not for column or range formulas and this can lead to
confusion.  AFAIK all table manipulations found in Org core fix
formulas.</li>
<li>Completeness: Not all variations and combinations are covered yet
<ul class="org-ul">
<li>move, rotate with range to end, rotate with range to begin, rotate
all</li>
<li>left-right, up-down</li>
</ul></li>
</ul>
</div>
</li>
</ul>
</div>
</div>

<div id="outline-container-org3276319" class="outline-3">
<h3 id="org3276319">Capture and Remember</h3>
<div class="outline-text-3" id="text-org3276319">
</div>
<div id="outline-container-org6117d7a" class="outline-4">
<h4 id="org6117d7a">Customize the size of the frame for remember</h4>
<div class="outline-text-4" id="text-org6117d7a">
<p>
(Note: this hack is likely out of date due to the development of
<code>org-capture</code>.)
</p>

<p>
On emacs-orgmode, Ryan C. Thompson suggested this:
</p>

<blockquote>
<p>
I am using org-remember set to open a new frame when used,
and the default frame size is much too large. To fix this, I have
designed some advice and a custom variable to implement custom
parameters for the remember frame:
</p>
</blockquote>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #eb4509;">(</span><span style="color: #eb4509;">defcustom</span> <span style="color: #fd971f;">remember-frame-alist</span> nil
  <span style="color: #7f7f80;">"Additional frame parameters for dedicated remember frame."</span>
  <span style="color: #fd971f;">:type</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">alist</span>
  <span style="color: #fd971f;">:group</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">remember</span><span style="color: #eb4509;">)</span>

<span style="color: #eb4509;">(</span><span style="color: #eb4509;">defadvice</span> <span style="color: #b6e63e;">remember</span> <span style="color: #fd971f;">(</span>around remember-frame-parameters activate<span style="color: #fd971f;">)</span>
  <span style="color: #7f7f80;">"Set some frame parameters for the remember frame."</span>
  <span style="color: #fd971f;">(</span><span style="color: #eb4509;">let</span> <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">(</span><span style="color: #fd971f;">default-frame-alist</span> <span style="color: #fd971f;">(</span><span style="color: #fd971f;">append</span> remember-frame-alist
                                     <span style="color: #fd971f;">default-frame-alist</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
    ad-do-it<span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
</pre>
</div>

<p>
Setting remember-frame-alist to <code>((width . 80) (height . 15)))</code> give a
reasonable size for the frame.
</p>
</div>
</div>
<div id="outline-container-org225be6d" class="outline-4">
<h4 id="org225be6d"><a href="https://github.com/PhilHudson/org-capture-vars.el">User-defined capture template variables with prompt and completion list</a></h4>
</div>
<div id="outline-container-org90c4936" class="outline-4">
<h4 id="org90c4936"><a href="https://github.com/alphapapa/unpackaged.el#ensure-blank-lines-between-headings-and-before-contents">Ensure blank lines between headings and before contents</a></h4>
</div>
</div>
<div id="outline-container-org9c46336" class="outline-3">
<h3 id="org9c46336">Handling Links</h3>
<div class="outline-text-3" id="text-org9c46336">
</div>
<div id="outline-container-org90b24f4" class="outline-4">
<h4 id="org90b24f4"><a href="#heading-to-link">Turn a heading into an org link</a></h4>
</div>
<div id="outline-container-org860f0c6" class="outline-4">
<h4 id="org860f0c6">Quickaccess to the link part of hyperlinks</h4>
<div class="outline-text-4" id="text-org860f0c6">
<p>
Christian Moe <a href="https://orgmode.org/list/4E0307D5.8080105@christianmoe.com">asked</a>, if there is a simpler way to copy the link part
of an org hyperling other than to use `C-c C-l C-a C-k C-g&rsquo;,
which is indeed kind of cumbersome.
</p>

<p>
The thread offered <a href="https://orgmode.org/list/871uy9ghdw.fsf@gnu.org">two ways</a>:
</p>

<p>
Using a <a href="http://www.gnu.org/software/emacs/manual/html_node/emacs/Keyboard-Macros.html">keyboard macro</a>:
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #eb4509;">(</span><span style="color: #fd971f;">fset</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">getlink</span>
      <span style="color: #fd971f;">(</span><span style="color: #eb4509;">lambda</span> <span style="color: #b6e63e;">(</span><span style="color: #66d9ef;">&amp;optional</span> arg<span style="color: #b6e63e;">)</span>
        <span style="color: #7f7f80;">"Keyboard macro."</span>
        <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">interactive</span> <span style="color: #e2c770;">"p"</span><span style="color: #b6e63e;">)</span>
        <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">kmacro-exec-ring-item</span> <span style="color: #eb4509;">(</span><span style="color: #eb4509;">quote</span> <span style="color: #fd971f;">(</span><span style="color: #e2c770;">"\C-c\C-l\C-a\C-k\C-g"</span> <span style="color: #9c91e4; font-weight: bold;">0</span> <span style="color: #e2c770;">"%d"</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span> arg<span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
</pre>
</div>

<p>
or a function:
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #eb4509;">(</span><span style="color: #eb4509;">defun</span> <span style="color: #b6e63e;">my-org-extract-link</span> <span style="color: #fd971f;">()</span>
  <span style="color: #7f7f80;">"Extract the link location at point and put it on the killring."</span>
  <span style="color: #fd971f;">(</span><span style="color: #eb4509;">interactive</span><span style="color: #fd971f;">)</span>
  <span style="color: #fd971f;">(</span><span style="color: #eb4509;">when</span> <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">org-in-regexp</span> <span style="color: #fd971f;">org-bracket-link-regexp</span> <span style="color: #9c91e4; font-weight: bold;">1</span><span style="color: #b6e63e;">)</span>
    <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">kill-new</span> <span style="color: #eb4509;">(</span><span style="color: #b6e63e;">org-link-unescape</span> <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">org-match-string-no-properties</span> <span style="color: #9c91e4; font-weight: bold;">1</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
</pre>
</div>

<p>
They put the link destination on the killring and can be easily bound to a key.
</p>
</div>
</div>

<div id="outline-container-orgbf5b90e" class="outline-4">
<h4 id="orgbf5b90e">Insert link with HTML title as default description</h4>
<div class="outline-text-4" id="text-orgbf5b90e">
<p>
When using `org-insert-link&rsquo; (`C-c C-l&rsquo;) it might be useful to extract contents
from HTML &lt;title&gt; tag and use it as a default link description. Here is a way to
accomplish this:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #eb4509;">(</span><span style="color: #fd971f;">require</span> <span style="color: #9c91e4;">'</span><span style="color: #fd971f;">mm-url</span><span style="color: #eb4509;">)</span> <span style="color: #696969;">; </span><span style="color: #696969;">to include mm-url-decode-entities-string</span>

<span style="color: #eb4509;">(</span><span style="color: #eb4509;">defun</span> <span style="color: #b6e63e;">my-org-insert-link</span> <span style="color: #fd971f;">()</span>
  <span style="color: #7f7f80;">"Insert org link where default description is set to html title."</span>
  <span style="color: #fd971f;">(</span><span style="color: #eb4509;">interactive</span><span style="color: #fd971f;">)</span>
  <span style="color: #fd971f;">(</span><span style="color: #eb4509;">let*</span> <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">(</span>url <span style="color: #fd971f;">(</span><span style="color: #fd971f;">read-string</span> <span style="color: #e2c770;">"URL: "</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
         <span style="color: #eb4509;">(</span>title <span style="color: #fd971f;">(</span>get-html-title-from-url url<span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
    <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">org-insert-link</span> nil url title<span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>

<span style="color: #eb4509;">(</span><span style="color: #eb4509;">defun</span> <span style="color: #b6e63e;">get-html-title-from-url</span> <span style="color: #fd971f;">(</span>url<span style="color: #fd971f;">)</span>
  <span style="color: #7f7f80;">"Return content in &lt;title&gt; tag."</span>
  <span style="color: #fd971f;">(</span><span style="color: #eb4509;">let</span> <span style="color: #b6e63e;">(</span>x1 x2 <span style="color: #eb4509;">(</span>download-buffer <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">url-retrieve-synchronously</span> url<span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
    <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">save-excursion</span>
      <span style="color: #eb4509;">(</span><span style="color: #fd971f;">set-buffer</span> download-buffer<span style="color: #eb4509;">)</span>
      <span style="color: #eb4509;">(</span><span style="color: #b6e63e;">beginning-of-buffer</span><span style="color: #eb4509;">)</span>
      <span style="color: #eb4509;">(</span><span style="color: #eb4509;">setq</span> x1 <span style="color: #fd971f;">(</span><span style="color: #fd971f;">search-forward</span> <span style="color: #e2c770;">"&lt;title&gt;"</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
      <span style="color: #eb4509;">(</span><span style="color: #fd971f;">search-forward</span> <span style="color: #e2c770;">"&lt;/title&gt;"</span><span style="color: #eb4509;">)</span>
      <span style="color: #eb4509;">(</span><span style="color: #eb4509;">setq</span> x2 <span style="color: #fd971f;">(</span><span style="color: #fd971f;">search-backward</span> <span style="color: #e2c770;">"&lt;"</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
      <span style="color: #eb4509;">(</span><span style="color: #b6e63e;">mm-url-decode-entities-string</span> <span style="color: #fd971f;">(</span><span style="color: #fd971f;">buffer-substring-no-properties</span> x1 x2<span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
</pre>
</div>

<p>
Then just use `M-x my-org-insert-link&rsquo; instead of `org-insert-link&rsquo;.
</p>
</div>
</div>
</div>

<div id="outline-container-archiving" class="outline-3">
<h3 id="archiving">Archiving Content in Org-Mode</h3>
<div class="outline-text-3" id="text-archiving">
</div>

<div id="outline-container-orga959431" class="outline-4">
<h4 id="orga959431">Preserve top level headings when archiving to a file</h4>
<div class="outline-text-4" id="text-orga959431">
<ul class="org-ul">
<li>Matt Lundin</li>
</ul>

<p>
To preserve (somewhat) the integrity of your archive structure while
archiving lower level items to a file, you can use the following
defadvice:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #eb4509;">(</span><span style="color: #eb4509;">defadvice</span> <span style="color: #b6e63e;">org-archive-subtree</span> <span style="color: #fd971f;">(</span>around my-org-archive-subtree activate<span style="color: #fd971f;">)</span>
  <span style="color: #fd971f;">(</span><span style="color: #eb4509;">let</span> <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">(</span><span style="color: #fd971f;">org-archive-location</span>
         <span style="color: #fd971f;">(</span><span style="color: #eb4509;">if</span> <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">save-excursion</span> <span style="color: #eb4509;">(</span><span style="color: #b6e63e;">org-back-to-heading</span><span style="color: #eb4509;">)</span>
                             <span style="color: #eb4509;">(</span><span style="color: #fd971f;">&gt;</span> <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">org-outline-level</span><span style="color: #fd971f;">)</span> <span style="color: #9c91e4; font-weight: bold;">1</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
             <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">concat</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">car</span> <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">split-string</span> <span style="color: #fd971f;">org-archive-location</span> <span style="color: #e2c770;">"::"</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
                     <span style="color: #e2c770;">"::* "</span>
                     <span style="color: #eb4509;">(</span><span style="color: #fd971f;">car</span> <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">org-get-outline-path</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
           <span style="color: #fd971f;">org-archive-location</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
    ad-do-it<span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
</pre>
</div>

<p>
Thus, if you have an outline structure such as&#x2026;
</p>

<div class="org-src-container">
<pre class="src src-org"><span style="color: #eb4509; font-weight: bold;">*</span><span style="color: #eb4509; font-weight: bold;"> Heading</span>
<span style="color: #bebebe; background-color: #010000;">*</span><span style="color: #f0b144; font-weight: bold;">*</span><span style="color: #f0b144; font-weight: bold;"> Subheading</span>
<span style="color: #bebebe; background-color: #010000;">**</span><span style="color: #8ec298; font-weight: bold;">*</span><span style="color: #8ec298; font-weight: bold;"> Subsubheading</span>
</pre>
</div>

<p>
&#x2026;archiving &ldquo;Subsubheading&rdquo; to a new file will set the location in
the new file to the top level heading:
</p>

<div class="org-src-container">
<pre class="src src-org"><span style="color: #eb4509; font-weight: bold;">*</span><span style="color: #eb4509; font-weight: bold;"> Heading</span>
<span style="color: #bebebe; background-color: #010000;">*</span><span style="color: #f0b144; font-weight: bold;">*</span><span style="color: #f0b144; font-weight: bold;"> Subsubheading</span>
</pre>
</div>

<p>
While this hack obviously destroys the outline hierarchy somewhat, it
at least preserves the logic of level one groupings.
</p>

<p>
A slightly more complex version of this hack will not only keep the
archive organized by top-level headings, but will also preserve the
tags found on those headings:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span style="color: #eb4509;">(</span><span style="color: #eb4509;">defun</span> <span style="color: #b6e63e;">my-org-inherited-no-file-tags</span> <span style="color: #fd971f;">()</span>
    <span style="color: #fd971f;">(</span><span style="color: #eb4509;">let</span> <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">(</span>tags <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">org-entry-get</span> nil <span style="color: #e2c770;">"ALLTAGS"</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">selective</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
          <span style="color: #eb4509;">(</span>ltags <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">org-entry-get</span> nil <span style="color: #e2c770;">"TAGS"</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
      <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">mapc</span> <span style="color: #eb4509;">(</span><span style="color: #eb4509;">lambda</span> <span style="color: #fd971f;">(</span>tag<span style="color: #fd971f;">)</span>
              <span style="color: #fd971f;">(</span><span style="color: #eb4509;">setq</span> tags
                    <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">replace-regexp-in-string</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">concat</span> tag <span style="color: #e2c770;">":"</span><span style="color: #eb4509;">)</span> <span style="color: #e2c770;">""</span> tags<span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
            <span style="color: #eb4509;">(</span><span style="color: #fd971f;">append</span> <span style="color: #fd971f;">org-file-tags</span> <span style="color: #fd971f;">(</span><span style="color: #eb4509;">when</span> ltags <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">split-string</span> ltags <span style="color: #e2c770;">":"</span> t<span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
      <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">if</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">string=</span> <span style="color: #e2c770;">":"</span> tags<span style="color: #eb4509;">)</span> nil tags<span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>

  <span style="color: #eb4509;">(</span><span style="color: #eb4509;">defadvice</span> <span style="color: #b6e63e;">org-archive-subtree</span> <span style="color: #fd971f;">(</span>around my-org-archive-subtree-low-level activate<span style="color: #fd971f;">)</span>
    <span style="color: #fd971f;">(</span><span style="color: #eb4509;">let</span> <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">(</span>tags <span style="color: #fd971f;">(</span>my-org-inherited-no-file-tags<span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
          <span style="color: #eb4509;">(</span><span style="color: #fd971f;">org-archive-location</span>
           <span style="color: #fd971f;">(</span><span style="color: #eb4509;">if</span> <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">save-excursion</span> <span style="color: #eb4509;">(</span><span style="color: #b6e63e;">org-back-to-heading</span><span style="color: #eb4509;">)</span>
                               <span style="color: #eb4509;">(</span><span style="color: #fd971f;">&gt;</span> <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">org-outline-level</span><span style="color: #fd971f;">)</span> <span style="color: #9c91e4; font-weight: bold;">1</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
               <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">concat</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">car</span> <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">split-string</span> <span style="color: #fd971f;">org-archive-location</span> <span style="color: #e2c770;">"::"</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
                       <span style="color: #e2c770;">"::* "</span>
                       <span style="color: #eb4509;">(</span><span style="color: #fd971f;">car</span> <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">org-get-outline-path</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
             <span style="color: #fd971f;">org-archive-location</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
      ad-do-it
      <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">with-current-buffer</span> <span style="color: #eb4509;">(</span><span style="color: #b6e63e;">find-file-noselect</span> <span style="color: #fd971f;">(</span>org-extract-archive-file<span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
        <span style="color: #eb4509;">(</span><span style="color: #eb4509;">save-excursion</span>
          <span style="color: #fd971f;">(</span><span style="color: #eb4509;">while</span> <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">org-up-heading-safe</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>
          <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">org-set-tags-to</span> tags<span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org7c5bc17" class="outline-4">
<h4 id="org7c5bc17">Archive in a date tree</h4>
<div class="outline-text-4" id="text-org7c5bc17">
<p>
Posted to Org-mode mailing list by Osamu Okano <span class="timestamp-wrapper"><span class="timestamp">[2010-04-21 Wed]</span></span>.
</p>

<p>
(Make sure org-datetree.el is loaded for this to work.)
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #696969;">;; </span><span style="color: #696969;">(setq org-archive-location "%s_archive::date-tree")</span>
<span style="color: #eb4509;">(</span><span style="color: #eb4509;">defadvice</span> <span style="color: #b6e63e;">org-archive-subtree</span>
  <span style="color: #fd971f;">(</span>around org-archive-subtree-to-data-tree activate<span style="color: #fd971f;">)</span>
  <span style="color: #7f7f80;">"org-archive-subtree to date-tree"</span>
  <span style="color: #fd971f;">(</span><span style="color: #eb4509;">if</span>
      <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">string=</span> <span style="color: #e2c770;">"date-tree"</span>
               <span style="color: #eb4509;">(</span>org-extract-archive-heading
                <span style="color: #fd971f;">(</span>org-get-local-archive-location<span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
      <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">let*</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">(</span>dct <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">decode-time</span> <span style="color: #eb4509;">(</span><span style="color: #b6e63e;">org-current-time</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>
             <span style="color: #fd971f;">(</span>y <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">nth</span> <span style="color: #9c91e4; font-weight: bold;">5</span> dct<span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>
             <span style="color: #fd971f;">(</span>m <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">nth</span> <span style="color: #9c91e4; font-weight: bold;">4</span> dct<span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>
             <span style="color: #fd971f;">(</span>d <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">nth</span> <span style="color: #9c91e4; font-weight: bold;">3</span> dct<span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>
             <span style="color: #fd971f;">(</span>this-buffer <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">current-buffer</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>
             <span style="color: #fd971f;">(</span>location <span style="color: #b6e63e;">(</span>org-get-local-archive-location<span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>
             <span style="color: #fd971f;">(</span>afile <span style="color: #b6e63e;">(</span>org-extract-archive-file location<span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>
             <span style="color: #fd971f;">(</span><span style="color: #fd971f;">org-archive-location</span>
              <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">format</span> <span style="color: #e2c770;">"%s::*** %04d-%02d-%02d %s"</span> afile y m d
                      <span style="color: #eb4509;">(</span><span style="color: #fd971f;">format-time-string</span> <span style="color: #e2c770;">"%A"</span> <span style="color: #fd971f;">(</span><span style="color: #fd971f;">encode-time</span> <span style="color: #9c91e4; font-weight: bold;">0</span> <span style="color: #9c91e4; font-weight: bold;">0</span> <span style="color: #9c91e4; font-weight: bold;">0</span> d m y<span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
        <span style="color: #eb4509;">(</span><span style="color: #fd971f;">message</span> <span style="color: #e2c770;">"afile=%s"</span> afile<span style="color: #eb4509;">)</span>
        <span style="color: #eb4509;">(</span><span style="color: #eb4509;">unless</span> afile
          <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">error</span> <span style="color: #e2c770;">"Invalid `</span><span style="color: #fd971f;">org-archive-location</span><span style="color: #e2c770;">'"</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
        <span style="color: #eb4509;">(</span><span style="color: #eb4509;">save-excursion</span>
          <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">switch-to-buffer</span> <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">find-file-noselect</span> afile<span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>
          <span style="color: #fd971f;">(</span>org-datetree-find-year-create y<span style="color: #fd971f;">)</span>
          <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">org-datetree-find-month-create</span> y m<span style="color: #fd971f;">)</span>
          <span style="color: #fd971f;">(</span>org-datetree-find-day-create y m d<span style="color: #fd971f;">)</span>
          <span style="color: #fd971f;">(</span><span style="color: #fd971f;">widen</span><span style="color: #fd971f;">)</span>
          <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">switch-to-buffer</span> this-buffer<span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
        ad-do-it<span style="color: #b6e63e;">)</span>
    ad-do-it<span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org62a9570" class="outline-4">
<h4 id="org62a9570">Add inherited tags to archived entries</h4>
<div class="outline-text-4" id="text-org62a9570">
<p>
To make <code>org-archive-subtree</code> keep inherited tags, Osamu OKANO suggests to
advise the function like this:
</p>

<pre class="example">
(defadvice org-archive-subtree
  (before add-inherited-tags-before-org-archive-subtree activate)
    "add inherited tags before org-archive-subtree"
    (org-set-tags-to (org-get-tags-at)))
</pre>
</div>
</div>
</div>

<div id="outline-container-orga2b9150" class="outline-3">
<h3 id="orga2b9150">Using and Managing Org-Metadata</h3>
<div class="outline-text-3" id="text-orga2b9150">
</div>
<div id="outline-container-remove-redundant-tags" class="outline-4">
<h4 id="remove-redundant-tags">Remove redundant tags of headlines</h4>
<div class="outline-text-4" id="text-remove-redundant-tags">
<p>
&#x2013; David Maus
</p>

<p>
A small function that processes all headlines in current buffer and
removes tags that are local to a headline and inherited by a parent
headline or the #+FILETAGS: statement.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span style="color: #eb4509;">(</span><span style="color: #eb4509;">defun</span> <span style="color: #b6e63e;">dmj/org-remove-redundant-tags</span> <span style="color: #fd971f;">()</span>
    <span style="color: #7f7f80;">"Remove redundant tags of headlines in current buffer.</span>

<span style="color: #7f7f80;">  A tag is considered redundant if it is local to a headline and</span>
<span style="color: #7f7f80;">  inherited by a parent headline."</span>
    <span style="color: #fd971f;">(</span><span style="color: #eb4509;">interactive</span><span style="color: #fd971f;">)</span>
    <span style="color: #fd971f;">(</span><span style="color: #eb4509;">when</span> <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">eq</span> <span style="color: #fd971f;">major-mode</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">org-mode</span><span style="color: #b6e63e;">)</span>
      <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">save-excursion</span>
        <span style="color: #eb4509;">(</span><span style="color: #b6e63e;">org-map-entries</span>
         <span style="color: #fd971f;">(</span><span style="color: #eb4509;">lambda</span> <span style="color: #b6e63e;">()</span>
           <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">let</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">(</span>alltags <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">split-string</span> <span style="color: #eb4509;">(</span><span style="color: #eb4509;">or</span> <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">org-entry-get</span> <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">point</span><span style="color: #b6e63e;">)</span> <span style="color: #e2c770;">"ALLTAGS"</span><span style="color: #fd971f;">)</span> <span style="color: #e2c770;">""</span><span style="color: #eb4509;">)</span> <span style="color: #e2c770;">":"</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>
                 local inherited tag<span style="color: #eb4509;">)</span>
             <span style="color: #eb4509;">(</span><span style="color: #eb4509;">dolist</span> <span style="color: #fd971f;">(</span>tag alltags<span style="color: #fd971f;">)</span>
               <span style="color: #fd971f;">(</span><span style="color: #eb4509;">if</span> <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">get-text-property</span> <span style="color: #9c91e4; font-weight: bold;">0</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">inherited</span> tag<span style="color: #b6e63e;">)</span>
                   <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">push</span> tag inherited<span style="color: #b6e63e;">)</span> <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">push</span> tag local<span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
             <span style="color: #eb4509;">(</span><span style="color: #eb4509;">dolist</span> <span style="color: #fd971f;">(</span>tag local<span style="color: #fd971f;">)</span>
               <span style="color: #fd971f;">(</span><span style="color: #eb4509;">if</span> <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">member</span> tag inherited<span style="color: #b6e63e;">)</span> <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">org-toggle-tag</span> tag <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">off</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>
         t nil<span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-remove-empty-property-drawers" class="outline-4">
<h4 id="remove-empty-property-drawers">Remove empty property drawers</h4>
<div class="outline-text-4" id="text-remove-empty-property-drawers">
<p>
David Maus proposed this:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #eb4509;">(</span><span style="color: #eb4509;">defun</span> <span style="color: #b6e63e;">dmj:org:remove-empty-propert-drawers</span> <span style="color: #fd971f;">()</span>
  <span style="color: #7f7f80;">"*Remove all empty property drawers in current file."</span>
  <span style="color: #fd971f;">(</span><span style="color: #eb4509;">interactive</span><span style="color: #fd971f;">)</span>
  <span style="color: #fd971f;">(</span><span style="color: #eb4509;">unless</span> <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">eq</span> <span style="color: #fd971f;">major-mode</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">org-mode</span><span style="color: #b6e63e;">)</span>
    <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">error</span> <span style="color: #e2c770;">"You need to turn on Org mode for this function."</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>
  <span style="color: #fd971f;">(</span><span style="color: #eb4509;">save-excursion</span>
    <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">goto-char</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">point-min</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
    <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">while</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">re-search-forward</span> <span style="color: #e2c770;">":PROPERTIES:"</span> nil t<span style="color: #eb4509;">)</span>
      <span style="color: #eb4509;">(</span><span style="color: #eb4509;">save-excursion</span>
  <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">org-remove-empty-drawer-at</span> <span style="color: #e2c770;">"PROPERTIES"</span> <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">match-beginning</span> <span style="color: #9c91e4; font-weight: bold;">0</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgd59deb9" class="outline-4">
<h4 id="orgd59deb9">Group task list by a property</h4>
<div class="outline-text-4" id="text-orgd59deb9">
<p>
This advice allows you to group a task list in Org-Mode.  To use it,
set the variable <code>org-agenda-group-by-property</code> to the name of a
property in the option list for a TODO or TAGS search.  The resulting
agenda view will group tasks by that property prior to searching.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #eb4509;">(</span><span style="color: #eb4509;">defvar</span> <span style="color: #fd971f;">org-agenda-group-by-property</span> nil
  <span style="color: #7f7f80;">"Set this in org-mode agenda views to group tasks by property"</span><span style="color: #eb4509;">)</span>

<span style="color: #eb4509;">(</span><span style="color: #eb4509;">defun</span> <span style="color: #b6e63e;">org-group-bucket-items</span> <span style="color: #fd971f;">(</span>prop items<span style="color: #fd971f;">)</span>
  <span style="color: #fd971f;">(</span><span style="color: #eb4509;">let</span> <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">(</span>buckets <span style="color: #fd971f;">()</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
    <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">dolist</span> <span style="color: #eb4509;">(</span>item items<span style="color: #eb4509;">)</span>
      <span style="color: #eb4509;">(</span><span style="color: #eb4509;">let*</span> <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">(</span>marker <span style="color: #eb4509;">(</span><span style="color: #fd971f;">get-text-property</span> <span style="color: #9c91e4; font-weight: bold;">0</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">org-marker</span> item<span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
             <span style="color: #b6e63e;">(</span>pvalue <span style="color: #eb4509;">(</span><span style="color: #b6e63e;">org-entry-get</span> marker prop t<span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
             <span style="color: #b6e63e;">(</span>cell <span style="color: #eb4509;">(</span><span style="color: #fd971f;">assoc</span> pvalue buckets<span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>
        <span style="color: #fd971f;">(</span><span style="color: #eb4509;">if</span> cell
            <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">setcdr</span> cell <span style="color: #eb4509;">(</span><span style="color: #fd971f;">cons</span> item <span style="color: #fd971f;">(</span><span style="color: #fd971f;">cdr</span> cell<span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
          <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">setq</span> buckets <span style="color: #eb4509;">(</span><span style="color: #fd971f;">cons</span> <span style="color: #fd971f;">(</span><span style="color: #fd971f;">cons</span> pvalue <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">list</span> item<span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>
                              buckets<span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
    <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">setq</span> buckets <span style="color: #eb4509;">(</span><span style="color: #fd971f;">mapcar</span> <span style="color: #fd971f;">(</span><span style="color: #eb4509;">lambda</span> <span style="color: #b6e63e;">(</span>bucket<span style="color: #b6e63e;">)</span>
                            <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">cons</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">car</span> bucket<span style="color: #eb4509;">)</span>
                                  <span style="color: #eb4509;">(</span><span style="color: #fd971f;">reverse</span> <span style="color: #fd971f;">(</span><span style="color: #fd971f;">cdr</span> bucket<span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>
                          buckets<span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
    <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">sort</span> buckets <span style="color: #eb4509;">(</span><span style="color: #eb4509;">lambda</span> <span style="color: #fd971f;">(</span>i1 i2<span style="color: #fd971f;">)</span>
                    <span style="color: #fd971f;">(</span><span style="color: #fd971f;">string&lt;</span> <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">car</span> i1<span style="color: #b6e63e;">)</span> <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">car</span> i2<span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>

<span style="color: #eb4509;">(</span><span style="color: #eb4509;">defadvice</span> <span style="color: #b6e63e;">org-finalize-agenda-entries</span> <span style="color: #fd971f;">(</span>around org-group-agenda-finalize
                                               <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">list</span> <span style="color: #66d9ef;">&amp;optional</span> nosort<span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>
  <span style="color: #7f7f80;">"Prepare bucketed agenda entry lists"</span>
  <span style="color: #fd971f;">(</span><span style="color: #eb4509;">if</span> org-agenda-group-by-property
      <span style="color: #696969;">;; </span><span style="color: #696969;">bucketed, handle appropriately</span>
      <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">let</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">(</span>text <span style="color: #e2c770;">""</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
        <span style="color: #eb4509;">(</span><span style="color: #eb4509;">dolist</span> <span style="color: #fd971f;">(</span>bucket <span style="color: #b6e63e;">(</span>org-group-bucket-items
                         org-agenda-group-by-property
                         list<span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>
          <span style="color: #fd971f;">(</span><span style="color: #eb4509;">let</span> <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">(</span>header <span style="color: #fd971f;">(</span><span style="color: #fd971f;">concat</span> <span style="color: #e2c770;">"Property "</span>
                                org-agenda-group-by-property
                                <span style="color: #e2c770;">" is "</span>
                                <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">or</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">car</span> bucket<span style="color: #eb4509;">)</span> <span style="color: #e2c770;">"&lt;nil&gt;"</span><span style="color: #b6e63e;">)</span> <span style="color: #e2c770;">":\n"</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
            <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">add-text-properties</span> <span style="color: #9c91e4; font-weight: bold;">0</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">1-</span> <span style="color: #fd971f;">(</span><span style="color: #fd971f;">length</span> header<span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
                                 <span style="color: #eb4509;">(</span><span style="color: #fd971f;">list</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">face</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">org-agenda-structure</span><span style="color: #eb4509;">)</span>
                                 header<span style="color: #b6e63e;">)</span>
            <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">setq</span> text
                  <span style="color: #eb4509;">(</span><span style="color: #fd971f;">concat</span> text header
                          <span style="color: #696969;">;; </span><span style="color: #696969;">recursively process</span>
                          <span style="color: #fd971f;">(</span><span style="color: #eb4509;">let</span> <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">(</span>org-agenda-group-by-property nil<span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
                            <span style="color: #b6e63e;">(</span>org-finalize-agenda-entries
                             <span style="color: #eb4509;">(</span><span style="color: #fd971f;">cdr</span> bucket<span style="color: #eb4509;">)</span> nosort<span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>
                          <span style="color: #e2c770;">"\n\n"</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
        <span style="color: #eb4509;">(</span><span style="color: #eb4509;">setq</span> ad-return-value text<span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
    ad-do-it<span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
<span style="color: #eb4509;">(</span><span style="color: #b6e63e;">ad-activate</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">org-finalize-agenda-entries</span><span style="color: #eb4509;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgbe5a967" class="outline-4">
<h4 id="orgbe5a967">A way to tag a task so that when clocking-out user is prompted to take a note.</h4>
<div class="outline-text-4" id="text-orgbe5a967">
<p>
Thanks to Richard Riley (see <a href="https://orgmode.org/list/vuoc49jfwp.fsf@news.eternal-september.org">this post on the mailing list</a>).
</p>

<p>
A small hook run when clocking out of a task that prompts for a note
when the tag &ldquo;<code>clockout_note</code>&rdquo; is found in a headline. It uses the tag
(&ldquo;<code>clockout_note</code>&rdquo;) so inheritance can also be used&#x2026;
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span style="color: #eb4509;">(</span><span style="color: #eb4509;">defun</span> <span style="color: #b6e63e;">rgr/check-for-clock-out-note</span><span style="color: #fd971f;">()</span>
        <span style="color: #fd971f;">(</span><span style="color: #eb4509;">interactive</span><span style="color: #fd971f;">)</span>
        <span style="color: #fd971f;">(</span><span style="color: #eb4509;">save-excursion</span>
          <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">org-back-to-heading</span><span style="color: #b6e63e;">)</span>
          <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">let</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">(</span>tags <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">org-get-tags</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
            <span style="color: #eb4509;">(</span><span style="color: #eb4509;">and</span> tags <span style="color: #fd971f;">(</span><span style="color: #fd971f;">message</span> <span style="color: #e2c770;">"tags: %s "</span> tags<span style="color: #fd971f;">)</span>
                 <span style="color: #fd971f;">(</span><span style="color: #eb4509;">when</span> <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">member</span> <span style="color: #e2c770;">"clocknote"</span> tags<span style="color: #b6e63e;">)</span>
                   <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">org-add-note</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>

  <span style="color: #eb4509;">(</span><span style="color: #b6e63e;">add-hook</span> <span style="color: #9c91e4;">'</span><span style="color: #fd971f;">org-clock-out-hook</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">rgr/check-for-clock-out-note</span><span style="color: #eb4509;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orge247149" class="outline-4">
<h4 id="orge247149">Dynamically adjust tag position</h4>
<div class="outline-text-4" id="text-orge247149">
<p>
Here is a bit of code that allows you to have the tags always
right-adjusted in the buffer.
</p>

<p>
This is useful when you have bigger window than default window-size
and you dislike the aesthetics of having the tag in the middle of the
line.
</p>

<p>
This hack solves the problem of adjusting it whenever you change the
window size.
Before saving it will revert the file to having the tag position be
left-adjusted so that if you track your files with version control,
you won&rsquo;t run into artificial diffs just because the window-size
changed.
</p>

<p>
<b>IMPORTANT</b>: This is probably slow on very big files.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #eb4509;">(</span><span style="color: #eb4509;">setq</span> ba/org-adjust-tags-column t<span style="color: #eb4509;">)</span>

<span style="color: #eb4509;">(</span><span style="color: #eb4509;">defun</span> <span style="color: #b6e63e;">ba/org-adjust-tags-column-reset-tags</span> <span style="color: #fd971f;">()</span>
  <span style="color: #7f7f80;">"In org-mode buffers it will reset tag position according to</span>
<span style="color: #7f7f80;">`</span><span style="color: #fd971f;">org-tags-column</span><span style="color: #7f7f80;">'."</span>
  <span style="color: #fd971f;">(</span><span style="color: #eb4509;">when</span> <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">and</span>
         <span style="color: #eb4509;">(</span><span style="color: #fd971f;">not</span> <span style="color: #fd971f;">(</span><span style="color: #fd971f;">string=</span> <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">buffer-name</span><span style="color: #b6e63e;">)</span> <span style="color: #e2c770;">"*Remember*"</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
         <span style="color: #eb4509;">(</span><span style="color: #fd971f;">eql</span> <span style="color: #fd971f;">major-mode</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">org-mode</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
    <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">let</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">(</span>b-m-p <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">buffer-modified-p</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
      <span style="color: #eb4509;">(</span><span style="color: #eb4509;">condition-case</span> nil
          <span style="color: #fd971f;">(</span><span style="color: #eb4509;">save-excursion</span>
            <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">goto-char</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">point-min</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
            <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">command-execute</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">outline-next-visible-heading</span><span style="color: #b6e63e;">)</span>
            <span style="color: #696969;">;; </span><span style="color: #696969;">disable (message) that org-set-tags generates</span>
            <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">flet</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">(</span><span style="color: #fd971f;">message</span> <span style="color: #b6e63e;">(</span><span style="color: #66d9ef;">&amp;rest</span> ignored<span style="color: #b6e63e;">)</span> nil<span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
              <span style="color: #eb4509;">(</span><span style="color: #b6e63e;">org-set-tags</span> <span style="color: #9c91e4; font-weight: bold;">1</span> t<span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
            <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">set-buffer-modified-p</span> b-m-p<span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>
        <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">error</span> nil<span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>

<span style="color: #eb4509;">(</span><span style="color: #eb4509;">defun</span> <span style="color: #b6e63e;">ba/org-adjust-tags-column-now</span> <span style="color: #fd971f;">()</span>
  <span style="color: #7f7f80;">"Right-adjust `</span><span style="color: #fd971f;">org-tags-column</span><span style="color: #7f7f80;">' value, then reset tag position."</span>
  <span style="color: #fd971f;">(</span><span style="color: #fd971f;">set</span> <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">make-local-variable</span> <span style="color: #9c91e4;">'</span><span style="color: #fd971f;">org-tags-column</span><span style="color: #b6e63e;">)</span>
       <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">-</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">-</span> <span style="color: #fd971f;">(</span><span style="color: #fd971f;">window-width</span><span style="color: #fd971f;">)</span> <span style="color: #fd971f;">(</span><span style="color: #fd971f;">length</span> <span style="color: #fd971f;">org-ellipsis</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>
  <span style="color: #fd971f;">(</span>ba/org-adjust-tags-column-reset-tags<span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>

<span style="color: #eb4509;">(</span><span style="color: #eb4509;">defun</span> <span style="color: #b6e63e;">ba/org-adjust-tags-column-maybe</span> <span style="color: #fd971f;">()</span>
  <span style="color: #7f7f80;">"If `</span><span style="color: #fd971f;">ba/org-adjust-tags-column</span><span style="color: #7f7f80;">' is set to non-nil, adjust tags."</span>
  <span style="color: #fd971f;">(</span><span style="color: #eb4509;">when</span> ba/org-adjust-tags-column
    <span style="color: #b6e63e;">(</span>ba/org-adjust-tags-column-now<span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>

<span style="color: #eb4509;">(</span><span style="color: #eb4509;">defun</span> <span style="color: #b6e63e;">ba/org-adjust-tags-column-before-save</span> <span style="color: #fd971f;">()</span>
  <span style="color: #7f7f80;">"Tags need to be left-adjusted when saving."</span>
  <span style="color: #fd971f;">(</span><span style="color: #eb4509;">when</span> ba/org-adjust-tags-column
     <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">setq</span> <span style="color: #fd971f;">org-tags-column</span> <span style="color: #9c91e4; font-weight: bold;">1</span><span style="color: #b6e63e;">)</span>
     <span style="color: #b6e63e;">(</span>ba/org-adjust-tags-column-reset-tags<span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>

<span style="color: #eb4509;">(</span><span style="color: #eb4509;">defun</span> <span style="color: #b6e63e;">ba/org-adjust-tags-column-after-save</span> <span style="color: #fd971f;">()</span>
  <span style="color: #7f7f80;">"Revert left-adjusted tag position done by before-save hook."</span>
  <span style="color: #fd971f;">(</span>ba/org-adjust-tags-column-maybe<span style="color: #fd971f;">)</span>
  <span style="color: #fd971f;">(</span><span style="color: #fd971f;">set-buffer-modified-p</span> nil<span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>

<span style="color: #696969;">; </span><span style="color: #696969;">automatically align tags on right-hand side</span>
<span style="color: #eb4509;">(</span><span style="color: #b6e63e;">add-hook</span> <span style="color: #9c91e4;">'</span><span style="color: #fd971f;">window-configuration-change-hook</span>
          <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">ba/org-adjust-tags-column-maybe</span><span style="color: #eb4509;">)</span>
<span style="color: #eb4509;">(</span><span style="color: #b6e63e;">add-hook</span> <span style="color: #9c91e4;">'</span><span style="color: #fd971f;">before-save-hook</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">ba/org-adjust-tags-column-before-save</span><span style="color: #eb4509;">)</span>
<span style="color: #eb4509;">(</span><span style="color: #b6e63e;">add-hook</span> <span style="color: #9c91e4;">'</span><span style="color: #fd971f;">after-save-hook</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">ba/org-adjust-tags-column-after-save</span><span style="color: #eb4509;">)</span>
<span style="color: #eb4509;">(</span><span style="color: #b6e63e;">add-hook</span> <span style="color: #9c91e4;">'</span><span style="color: #fd971f;">org-agenda-mode-hook</span> <span style="color: #fd971f;">(</span><span style="color: #eb4509;">lambda</span> <span style="color: #b6e63e;">()</span>
                                  <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">setq</span> <span style="color: #fd971f;">org-agenda-tags-column</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">-</span> <span style="color: #fd971f;">(</span><span style="color: #fd971f;">window-width</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>

<span style="color: #696969;">; </span><span style="color: #696969;">between invoking org-refile and displaying the prompt (which</span>
<span style="color: #696969;">; </span><span style="color: #696969;">triggers window-configuration-change-hook) tags might adjust,</span>
<span style="color: #696969;">; </span><span style="color: #696969;">which invalidates the org-refile cache</span>
<span style="color: #eb4509;">(</span><span style="color: #eb4509;">defadvice</span> <span style="color: #b6e63e;">org-refile</span> <span style="color: #fd971f;">(</span>around org-refile-disable-adjust-tags<span style="color: #fd971f;">)</span>
  <span style="color: #7f7f80;">"Disable dynamically adjusting tags"</span>
  <span style="color: #fd971f;">(</span><span style="color: #eb4509;">let</span> <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">(</span>ba/org-adjust-tags-column nil<span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
    ad-do-it<span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
<span style="color: #eb4509;">(</span><span style="color: #b6e63e;">ad-activate</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">org-refile</span><span style="color: #eb4509;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgbdb88b5" class="outline-4">
<h4 id="orgbdb88b5">Use an &ldquo;attach&rdquo; link type to open files without worrying about their location</h4>
<div class="outline-text-4" id="text-orgbdb88b5">
<p>
&#x2013; Darlan Cavalcante Moreira
</p>

<p>
In the setup part in my org-files I put:
</p>

<div class="org-src-container">
<pre class="src src-org"><span style="color: #7f7f80;">#+LINK: attach elisp:(org-open-file (org-attach-expand "%s"))</span>
</pre>
</div>

<p>
Now I can use the &ldquo;attach&rdquo; link type, but org will ask me if I want to
allow executing the elisp code.  To avoid this you can even set
org-confirm-elisp-link-function to nil (I don&rsquo;t like this because it allows
any elisp code in links) or you can set org-confirm-elisp-link-not-regexp
appropriately.
</p>

<p>
In my case I use
</p>

<pre class="example">
(setq org-confirm-elisp-link-not-regexp "org-open-file")
</pre>


<p>
This works very well.
</p>
</div>
</div>
</div>

<div id="outline-container-org31aec6b" class="outline-3">
<h3 id="org31aec6b">Org Agenda and Task Management</h3>
<div class="outline-text-3" id="text-org31aec6b">
</div>
<div id="outline-container-org9dde2f1" class="outline-4">
<h4 id="org9dde2f1">Make it easier to set org-agenda-files from multiple directories</h4>
<div class="outline-text-4" id="text-org9dde2f1">
<ul class="org-ul">
<li>Matt Lundin</li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #eb4509;">(</span><span style="color: #eb4509;">defun</span> <span style="color: #b6e63e;">my-org-list-files</span> <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">dirs</span> ext<span style="color: #fd971f;">)</span>
  <span style="color: #7f7f80;">"Function to create list of org files in multiple subdirectories.</span>
<span style="color: #7f7f80;">This can be called to generate a list of files for</span>
<span style="color: #7f7f80;">org-agenda-files or org-refile-targets.</span>

<span style="color: #7f7f80;">DIRS is a list of directories.</span>

<span style="color: #7f7f80;">EXT is a list of the extensions of files to be included."</span>
  <span style="color: #fd971f;">(</span><span style="color: #eb4509;">let</span> <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">(</span><span style="color: #b6e63e;">dirs</span> <span style="color: #fd971f;">(</span><span style="color: #eb4509;">if</span> <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">listp</span> dirs<span style="color: #b6e63e;">)</span>
                  dirs
                <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">list</span> dirs<span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
        <span style="color: #eb4509;">(</span>ext <span style="color: #fd971f;">(</span><span style="color: #eb4509;">if</span> <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">listp</span> ext<span style="color: #b6e63e;">)</span>
                 ext
               <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">list</span> ext<span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
        files<span style="color: #b6e63e;">)</span>
    <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">mapc</span>
     <span style="color: #eb4509;">(</span><span style="color: #eb4509;">lambda</span> <span style="color: #fd971f;">(</span>x<span style="color: #fd971f;">)</span>
       <span style="color: #fd971f;">(</span><span style="color: #fd971f;">mapc</span>
        <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">lambda</span> <span style="color: #eb4509;">(</span>y<span style="color: #eb4509;">)</span>
          <span style="color: #eb4509;">(</span><span style="color: #eb4509;">setq</span> files
                <span style="color: #fd971f;">(</span><span style="color: #fd971f;">append</span> files
                        <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">file-expand-wildcards</span>
                         <span style="color: #eb4509;">(</span><span style="color: #fd971f;">concat</span> <span style="color: #fd971f;">(</span><span style="color: #fd971f;">file-name-as-directory</span> x<span style="color: #fd971f;">)</span> <span style="color: #e2c770;">"*"</span> y<span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
        ext<span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
     dirs<span style="color: #b6e63e;">)</span>
    <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">mapc</span>
     <span style="color: #eb4509;">(</span><span style="color: #eb4509;">lambda</span> <span style="color: #fd971f;">(</span>x<span style="color: #fd971f;">)</span>
       <span style="color: #fd971f;">(</span><span style="color: #eb4509;">when</span> <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">or</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">string-match</span> <span style="color: #e2c770;">"/.#"</span> x<span style="color: #eb4509;">)</span>
                 <span style="color: #eb4509;">(</span><span style="color: #fd971f;">string-match</span> <span style="color: #e2c770;">"#$"</span> x<span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
         <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">setq</span> files <span style="color: #eb4509;">(</span><span style="color: #fd971f;">delete</span> x files<span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
     files<span style="color: #b6e63e;">)</span>
    files<span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>

<span style="color: #eb4509;">(</span><span style="color: #eb4509;">defvar</span> <span style="color: #fd971f;">my-org-agenda-directories</span> <span style="color: #9c91e4;">'</span><span style="color: #fd971f;">(</span><span style="color: #e2c770;">"~/org/"</span><span style="color: #fd971f;">)</span>
  <span style="color: #7f7f80;">"List of directories containing org files."</span><span style="color: #eb4509;">)</span>
<span style="color: #eb4509;">(</span><span style="color: #eb4509;">defvar</span> <span style="color: #fd971f;">my-org-agenda-extensions</span> <span style="color: #9c91e4;">'</span><span style="color: #fd971f;">(</span><span style="color: #e2c770;">".org"</span><span style="color: #fd971f;">)</span>
  <span style="color: #7f7f80;">"List of extensions of agenda files"</span><span style="color: #eb4509;">)</span>

<span style="color: #eb4509;">(</span><span style="color: #eb4509;">setq</span> my-org-agenda-directories <span style="color: #9c91e4;">'</span><span style="color: #fd971f;">(</span><span style="color: #e2c770;">"~/org/"</span> <span style="color: #e2c770;">"~/work/"</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
<span style="color: #eb4509;">(</span><span style="color: #eb4509;">setq</span> my-org-agenda-extensions <span style="color: #9c91e4;">'</span><span style="color: #fd971f;">(</span><span style="color: #e2c770;">".org"</span> <span style="color: #e2c770;">".ref"</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>

<span style="color: #eb4509;">(</span><span style="color: #eb4509;">defun</span> <span style="color: #b6e63e;">my-org-set-agenda-files</span> <span style="color: #fd971f;">()</span>
  <span style="color: #fd971f;">(</span><span style="color: #eb4509;">interactive</span><span style="color: #fd971f;">)</span>
  <span style="color: #fd971f;">(</span><span style="color: #eb4509;">setq</span> <span style="color: #fd971f;">org-agenda-files</span> <span style="color: #b6e63e;">(</span>my-org-list-files
                          my-org-agenda-directories
                          my-org-agenda-extensions<span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>

<span style="color: #eb4509;">(</span>my-org-set-agenda-files<span style="color: #eb4509;">)</span>
</pre>
</div>

<p>
The code above will set your &ldquo;default&rdquo; agenda files to all files
ending in &ldquo;.org&rdquo; and &ldquo;.ref&rdquo; in the directories &ldquo;~/org/&rdquo; and &ldquo;~/work/&rdquo;.
You can change these values by setting the variables
my-org-agenda-extensions and my-org-agenda-directories. The function
my-org-agenda-files-by-filetag uses these two variables to determine
which files to search for filetags (i.e., the larger set from which
the subset will be drawn).
</p>

<p>
You can also easily use my-org-list-files to &ldquo;mix and match&rdquo;
directories and extensions to generate different lists of agenda
files.
</p>
</div>
</div>

<div id="outline-container-set-agenda-files-by-filetag" class="outline-4">
<h4 id="set-agenda-files-by-filetag">Restrict org-agenda-files by filetag</h4>
<div class="outline-text-4" id="text-set-agenda-files-by-filetag">
<ul class="org-ul">
<li>Matt Lundin</li>
</ul>

<p>
It is often helpful to limit yourself to a subset of your agenda
files. For instance, at work, you might want to see only files related
to work (e.g., bugs, clientA, projectxyz, etc.). The FAQ has helpful
information on filtering tasks using <a href="org-faq.html#limit-agenda-with-tag-filtering">filetags</a> and <a href="org-faq.html#limit-agenda-with-category-match">custom agendacommands</a>. These solutions, however, require reapplying a filter each
time you call the agenda or writing several new custom agenda commands
for each context. Another solution is to use directories for different
types of tasks and to change your agenda files with a function that
sets org-agenda-files to the appropriate directory. But this relies on
hard and static boundaries between files.
</p>

<p>
The following functions allow for a more dynamic approach to selecting
a subset of files based on filetags:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #eb4509;">(</span><span style="color: #eb4509;">defun</span> <span style="color: #b6e63e;">my-org-agenda-restrict-files-by-filetag</span> <span style="color: #fd971f;">(</span><span style="color: #66d9ef;">&amp;optional</span> tag<span style="color: #fd971f;">)</span>
  <span style="color: #7f7f80;">"Restrict org agenda files only to those containing filetag."</span>
  <span style="color: #fd971f;">(</span><span style="color: #eb4509;">interactive</span><span style="color: #fd971f;">)</span>
  <span style="color: #fd971f;">(</span><span style="color: #eb4509;">let*</span> <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">(</span>tagslist <span style="color: #fd971f;">(</span>my-org-get-all-filetags<span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
         <span style="color: #eb4509;">(</span>ftag <span style="color: #fd971f;">(</span><span style="color: #eb4509;">or</span> tag
                   <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">completing-read</span> <span style="color: #e2c770;">"Tag: "</span>
                                    <span style="color: #eb4509;">(</span><span style="color: #fd971f;">mapcar</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">car</span> tagslist<span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
    <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">org-agenda-remove-restriction-lock</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">noupdate</span><span style="color: #b6e63e;">)</span>
    <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">put</span> <span style="color: #9c91e4;">'</span><span style="color: #fd971f;">org-agenda-files</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">org-restrict</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">cdr</span> <span style="color: #fd971f;">(</span><span style="color: #fd971f;">assoc</span> ftag tagslist<span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
    <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">setq</span> <span style="color: #fd971f;">org-agenda-overriding-restriction</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">files</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>

<span style="color: #eb4509;">(</span><span style="color: #eb4509;">defun</span> <span style="color: #b6e63e;">my-org-get-all-filetags</span> <span style="color: #fd971f;">()</span>
  <span style="color: #7f7f80;">"Get list of filetags from all default org-files."</span>
  <span style="color: #fd971f;">(</span><span style="color: #eb4509;">let</span> <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">(</span>files <span style="color: #fd971f;">org-agenda-files</span><span style="color: #eb4509;">)</span>
        tagslist x<span style="color: #b6e63e;">)</span>
    <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">save-window-excursion</span>
      <span style="color: #eb4509;">(</span><span style="color: #eb4509;">while</span> <span style="color: #fd971f;">(</span><span style="color: #eb4509;">setq</span> x <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">pop</span> files<span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>
        <span style="color: #fd971f;">(</span><span style="color: #fd971f;">set-buffer</span> <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">find-file-noselect</span> x<span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>
        <span style="color: #fd971f;">(</span><span style="color: #fd971f;">mapc</span>
         <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">lambda</span> <span style="color: #eb4509;">(</span>y<span style="color: #eb4509;">)</span>
           <span style="color: #eb4509;">(</span><span style="color: #eb4509;">let</span> <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">(</span>tagfiles <span style="color: #eb4509;">(</span><span style="color: #fd971f;">assoc</span> y tagslist<span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>
             <span style="color: #fd971f;">(</span><span style="color: #eb4509;">if</span> tagfiles
                 <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">setcdr</span> tagfiles <span style="color: #eb4509;">(</span><span style="color: #fd971f;">cons</span> x <span style="color: #fd971f;">(</span><span style="color: #fd971f;">cdr</span> tagfiles<span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
               <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">add-to-list</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">tagslist</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">list</span> y x<span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
         <span style="color: #b6e63e;">(</span>my-org-get-filetags<span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
      tagslist<span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>

<span style="color: #eb4509;">(</span><span style="color: #eb4509;">defun</span> <span style="color: #b6e63e;">my-org-get-filetags</span> <span style="color: #fd971f;">()</span>
  <span style="color: #7f7f80;">"Get list of filetags for current buffer"</span>
  <span style="color: #fd971f;">(</span><span style="color: #eb4509;">let</span> <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">(</span>ftags <span style="color: #fd971f;">org-file-tags</span><span style="color: #eb4509;">)</span>
        x<span style="color: #b6e63e;">)</span>
    <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">mapcar</span>
     <span style="color: #eb4509;">(</span><span style="color: #eb4509;">lambda</span> <span style="color: #fd971f;">(</span>x<span style="color: #fd971f;">)</span>
       <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">org-no-properties</span> x<span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
     ftags<span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
</pre>
</div>

<p>
Calling my-org-agenda-restrict-files-by-filetag results in a prompt
with all filetags in your &ldquo;normal&rdquo; agenda files. When you select a
tag, org-agenda-files will be restricted to only those files
containing the filetag. To release the restriction, type C-c C-x &gt;
(org-agenda-remove-restriction-lock).
</p>
</div>
</div>

<div id="outline-container-org44cb5e8" class="outline-4">
<h4 id="org44cb5e8">Highlight the agenda line under cursor</h4>
<div class="outline-text-4" id="text-org44cb5e8">
<p>
This is useful to make sure what task you are operating on.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #eb4509;">(</span><span style="color: #b6e63e;">add-hook</span> <span style="color: #9c91e4;">'</span><span style="color: #fd971f;">org-agenda-mode-hook</span> <span style="color: #fd971f;">(</span><span style="color: #eb4509;">lambda</span> <span style="color: #b6e63e;">()</span> <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">hl-line-mode</span> <span style="color: #9c91e4; font-weight: bold;">1</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
</pre>
</div>

<p>
Under XEmacs:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #696969;">;; </span><span style="color: #696969;">hl-line seems to be only for emacs</span>
<span style="color: #eb4509;">(</span><span style="color: #fd971f;">require</span> <span style="color: #9c91e4;">'</span><span style="color: #fd971f;">highline</span><span style="color: #eb4509;">)</span>
<span style="color: #eb4509;">(</span><span style="color: #b6e63e;">add-hook</span> <span style="color: #9c91e4;">'</span><span style="color: #fd971f;">org-agenda-mode-hook</span> <span style="color: #fd971f;">(</span><span style="color: #eb4509;">lambda</span> <span style="color: #b6e63e;">()</span> <span style="color: #b6e63e;">(</span>highline-mode <span style="color: #9c91e4; font-weight: bold;">1</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>

<span style="color: #696969;">;; </span><span style="color: #696969;">highline-mode does not work straightaway in tty mode.</span>
<span style="color: #696969;">;; </span><span style="color: #696969;">I use a black background</span>
<span style="color: #eb4509;">(</span><span style="color: #b6e63e;">custom-set-faces</span>
  <span style="color: #9c91e4;">'</span><span style="color: #fd971f;">(</span>highline-face <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">(</span><span style="color: #fd971f;">(</span><span style="color: #b6e63e;">(</span>type tty<span style="color: #b6e63e;">)</span> <span style="color: #b6e63e;">(</span>class color<span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>
                    <span style="color: #fd971f;">(</span><span style="color: #fd971f;">:background</span> <span style="color: #e2c770;">"white"</span> <span style="color: #fd971f;">:foreground</span> <span style="color: #e2c770;">"black"</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orga5da6c6" class="outline-4">
<h4 id="orga5da6c6">Split frame horizontally for agenda</h4>
<div class="outline-text-4" id="text-orga5da6c6">
<p>
If you would like to split the frame into two side-by-side windows when
displaying the agenda, try this hack from Jan Rehders, which uses the
`toggle-window-split&rsquo; from
</p>

<p>
<a href="http://www.emacswiki.org/cgi-bin/wiki/ToggleWindowSplit">http://www.emacswiki.org/cgi-bin/wiki/ToggleWindowSplit</a>
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #696969;">;; </span><span style="color: #696969;">Patch org-mode to use vertical splitting</span>
<span style="color: #eb4509;">(</span><span style="color: #eb4509;">defadvice</span> <span style="color: #b6e63e;">org-prepare-agenda</span> <span style="color: #fd971f;">(</span>after org-fix-split<span style="color: #fd971f;">)</span>
  <span style="color: #fd971f;">(</span>toggle-window-split<span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
<span style="color: #eb4509;">(</span><span style="color: #b6e63e;">ad-activate</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">org-prepare-agenda</span><span style="color: #eb4509;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org020e380" class="outline-4">
<h4 id="org020e380">Automatically add an appointment when clocking in a task</h4>
<div class="outline-text-4" id="text-org020e380">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #696969;">;; </span><span style="color: #696969;">Make sure you have a sensible value for `</span><span style="color: #fd971f;">appt-message-warning-time</span><span style="color: #696969;">'</span>
<span style="color: #eb4509;">(</span><span style="color: #eb4509;">defvar</span> <span style="color: #fd971f;">bzg-org-clock-in-appt-delay</span> <span style="color: #9c91e4; font-weight: bold;">100</span>
  <span style="color: #7f7f80;">"Number of minutes for setting an appointment by clocking-in"</span><span style="color: #eb4509;">)</span>
</pre>
</div>

<p>
This function let&rsquo;s you add an appointment for the current entry.
This can be useful when you need a reminder.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #eb4509;">(</span><span style="color: #eb4509;">defun</span> <span style="color: #b6e63e;">bzg-org-clock-in-add-appt</span> <span style="color: #fd971f;">(</span><span style="color: #66d9ef;">&amp;optional</span> n<span style="color: #fd971f;">)</span>
  <span style="color: #7f7f80;">"Add an appointment for the Org entry at point in N minutes."</span>
  <span style="color: #fd971f;">(</span><span style="color: #eb4509;">interactive</span><span style="color: #fd971f;">)</span>
  <span style="color: #fd971f;">(</span><span style="color: #eb4509;">save-excursion</span>
    <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">org-back-to-heading</span> t<span style="color: #b6e63e;">)</span>
    <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">looking-at</span> <span style="color: #fd971f;">org-complex-heading-regexp</span><span style="color: #b6e63e;">)</span>
    <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">let*</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">(</span>msg <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">match-string-no-properties</span> <span style="color: #9c91e4; font-weight: bold;">4</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>
     <span style="color: #fd971f;">(</span>ct-time <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">decode-time</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>
     <span style="color: #fd971f;">(</span>appt-min <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">+</span> <span style="color: #eb4509;">(</span><span style="color: #b6e63e;">cadr</span> ct-time<span style="color: #eb4509;">)</span>
      <span style="color: #eb4509;">(</span><span style="color: #eb4509;">or</span> n bzg-org-clock-in-appt-delay<span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>
     <span style="color: #fd971f;">(</span>appt-time <span style="color: #696969;">; </span><span style="color: #696969;">define the time for the appointment</span>
      <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">progn</span> <span style="color: #eb4509;">(</span><span style="color: #eb4509;">setf</span> <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">cadr</span> ct-time<span style="color: #fd971f;">)</span> appt-min<span style="color: #eb4509;">)</span> ct-time<span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
      <span style="color: #eb4509;">(</span><span style="color: #b6e63e;">appt-add</span> <span style="color: #fd971f;">(</span><span style="color: #fd971f;">format-time-string</span>
     <span style="color: #e2c770;">"%H:%M"</span> <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">apply</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">encode-time</span> appt-time<span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span> <span style="color: #e2c770;">msg</span><span style="color: #eb4509;">)</span>
      <span style="color: #eb4509;">(</span><span style="color: #eb4509;">if</span> <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">interactive-p</span><span style="color: #fd971f;">)</span> <span style="color: #fd971f;">(</span><span style="color: #fd971f;">message</span> <span style="color: #e2c770;">"New appointment for %s"</span> msg<span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
</pre>
</div>

<p>
You can advise <code>org-clock-in</code> so that <code>C-c C-x C-i</code> will automatically
add an appointment:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #eb4509;">(</span><span style="color: #eb4509;">defadvice</span> <span style="color: #b6e63e;">org-clock-in</span> <span style="color: #fd971f;">(</span>after org-clock-in-add-appt activate<span style="color: #fd971f;">)</span>
  <span style="color: #7f7f80;">"Add an appointment when clocking a task in."</span>
  <span style="color: #fd971f;">(</span>bzg-org-clock-in-add-appt<span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
</pre>
</div>

<p>
You may also want to delete the associated appointment when clocking
out.  This function does this:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #eb4509;">(</span><span style="color: #eb4509;">defun</span> <span style="color: #b6e63e;">bzg-org-clock-out-delete-appt</span> nil
  <span style="color: #7f7f80;">"When clocking out, delete any associated appointment."</span>
  <span style="color: #fd971f;">(</span><span style="color: #eb4509;">interactive</span><span style="color: #fd971f;">)</span>
  <span style="color: #fd971f;">(</span><span style="color: #eb4509;">save-excursion</span>
    <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">org-back-to-heading</span> t<span style="color: #b6e63e;">)</span>
    <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">looking-at</span> <span style="color: #fd971f;">org-complex-heading-regexp</span><span style="color: #b6e63e;">)</span>
    <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">let*</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">(</span>msg <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">match-string-no-properties</span> <span style="color: #9c91e4; font-weight: bold;">4</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
      <span style="color: #eb4509;">(</span><span style="color: #eb4509;">setq</span> appt-time-msg-list
      <span style="color: #fd971f;">(</span><span style="color: #fd971f;">delete</span> nil
        <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">mapcar</span>
         <span style="color: #eb4509;">(</span><span style="color: #eb4509;">lambda</span> <span style="color: #fd971f;">(</span>appt<span style="color: #fd971f;">)</span>
           <span style="color: #fd971f;">(</span><span style="color: #eb4509;">if</span> <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">not</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">string-match</span> <span style="color: #fd971f;">(</span><span style="color: #fd971f;">regexp-quote</span> msg<span style="color: #fd971f;">)</span>
                <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">cadr</span> appt<span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span> <span style="color: #e2c770;">appt</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
         appt-time-msg-list<span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
      <span style="color: #eb4509;">(</span>appt-check<span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
</pre>
</div>

<p>
And here is the advice for <code>org-clock-out</code> (<code>C-c C-x C-o</code>)
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #eb4509;">(</span><span style="color: #eb4509;">defadvice</span> <span style="color: #b6e63e;">org-clock-out</span> <span style="color: #fd971f;">(</span>before org-clock-out-delete-appt activate<span style="color: #fd971f;">)</span>
  <span style="color: #7f7f80;">"Delete an appointment when clocking a task out."</span>
  <span style="color: #fd971f;">(</span>bzg-org-clock-out-delete-appt<span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
</pre>
</div>

<p>
<b>IMPORTANT</b>: You can add appointment by clocking in in both an
<code>org-mode</code> and an <code>org-agenda-mode</code> buffer.  But clocking out from
agenda buffer with the advice above will bring an error.
</p>
</div>
</div>

<div id="outline-container-org76c939a" class="outline-4">
<h4 id="org76c939a">Using external programs for appointments reminders</h4>
<div class="outline-text-4" id="text-org76c939a">
<p>
Read this rich <a href="http://comments.gmane.org/gmane.emacs.orgmode/46641">thread</a> from the org-mode list.
</p>
</div>
</div>

<div id="outline-container-org04b6749" class="outline-4">
<h4 id="org04b6749">Remove from agenda time grid lines that are in an appointment</h4>
<div class="outline-text-4" id="text-org04b6749">
<p>
The agenda shows lines for the time grid.  Some people think that
these lines are a distraction when there are appointments at those
times.  You can get rid of the lines which coincide exactly with the
beginning of an appointment.  Michael Ekstrand has written a piece of
advice that also removes lines that are somewhere inside an
appointment:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #eb4509;">(</span><span style="color: #eb4509;">defun</span> <span style="color: #b6e63e;">org-time-to-minutes</span> <span style="color: #fd971f;">(</span>time<span style="color: #fd971f;">)</span>
  <span style="color: #7f7f80;">"Convert an HHMM time to minutes"</span>
  <span style="color: #fd971f;">(</span><span style="color: #fd971f;">+</span> <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">*</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">/</span> time <span style="color: #9c91e4; font-weight: bold;">100</span><span style="color: #eb4509;">)</span> <span style="color: #9c91e4; font-weight: bold;">60</span><span style="color: #b6e63e;">)</span> <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">%</span> time <span style="color: #9c91e4; font-weight: bold;">100</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>

<span style="color: #eb4509;">(</span><span style="color: #eb4509;">defun</span> <span style="color: #b6e63e;">org-time-from-minutes</span> <span style="color: #fd971f;">(</span>minutes<span style="color: #fd971f;">)</span>
  <span style="color: #7f7f80;">"Convert a number of minutes to an HHMM time"</span>
  <span style="color: #fd971f;">(</span><span style="color: #fd971f;">+</span> <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">*</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">/</span> minutes <span style="color: #9c91e4; font-weight: bold;">60</span><span style="color: #eb4509;">)</span> <span style="color: #9c91e4; font-weight: bold;">100</span><span style="color: #b6e63e;">)</span> <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">%</span> minutes <span style="color: #9c91e4; font-weight: bold;">60</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>

<span style="color: #eb4509;">(</span><span style="color: #eb4509;">defadvice</span> <span style="color: #b6e63e;">org-agenda-add-time-grid-maybe</span> <span style="color: #fd971f;">(</span>around mde-org-agenda-grid-tweakify
                                                  <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">list</span> ndays todayp<span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>
  <span style="color: #fd971f;">(</span><span style="color: #eb4509;">if</span> <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">member</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">remove-match</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">car</span> <span style="color: #fd971f;">org-agenda-time-grid</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
      <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">flet</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">(</span>extract-window
              <span style="color: #b6e63e;">(</span>line<span style="color: #b6e63e;">)</span>
              <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">let</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">(</span>start <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">get-text-property</span> <span style="color: #9c91e4; font-weight: bold;">1</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">time-of-day</span> line<span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>
                    <span style="color: #fd971f;">(</span>dur <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">get-text-property</span> <span style="color: #9c91e4; font-weight: bold;">1</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">duration</span> line<span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
                <span style="color: #eb4509;">(</span><span style="color: #eb4509;">cond</span>
                 <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">(</span><span style="color: #eb4509;">and</span> start dur<span style="color: #b6e63e;">)</span>
                  <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">cons</span> start
                        <span style="color: #eb4509;">(</span>org-time-from-minutes
                         <span style="color: #fd971f;">(</span><span style="color: #fd971f;">+</span> dur <span style="color: #b6e63e;">(</span>org-time-to-minutes start<span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>
                 <span style="color: #fd971f;">(</span>start start<span style="color: #fd971f;">)</span>
                 <span style="color: #fd971f;">(</span>t nil<span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
        <span style="color: #eb4509;">(</span><span style="color: #eb4509;">let*</span> <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">(</span>windows <span style="color: #eb4509;">(</span><span style="color: #fd971f;">delq</span> nil <span style="color: #fd971f;">(</span><span style="color: #fd971f;">mapcar</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">extract-window</span> list<span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
               <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">org-agenda-time-grid</span>
                <span style="color: #eb4509;">(</span><span style="color: #fd971f;">list</span> <span style="color: #fd971f;">(</span><span style="color: #fd971f;">car</span> <span style="color: #fd971f;">org-agenda-time-grid</span><span style="color: #fd971f;">)</span>
                      <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">cadr</span> <span style="color: #fd971f;">org-agenda-time-grid</span><span style="color: #fd971f;">)</span>
                      <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">remove-if</span>
                       <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">lambda</span> <span style="color: #eb4509;">(</span>time<span style="color: #eb4509;">)</span>
                         <span style="color: #eb4509;">(</span><span style="color: #b6e63e;">find-if</span> <span style="color: #fd971f;">(</span><span style="color: #eb4509;">lambda</span> <span style="color: #b6e63e;">(</span>w<span style="color: #b6e63e;">)</span>
                                    <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">if</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">numberp</span> w<span style="color: #eb4509;">)</span>
                                        <span style="color: #eb4509;">(</span><span style="color: #fd971f;">equal</span> w time<span style="color: #eb4509;">)</span>
                                      <span style="color: #eb4509;">(</span><span style="color: #eb4509;">and</span> <span style="color: #fd971f;">(</span><span style="color: #fd971f;">&gt;=</span> time <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">car</span> w<span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>
                                           <span style="color: #fd971f;">(</span><span style="color: #fd971f;">&lt;</span> time <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">cdr</span> w<span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>
                                  windows<span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
                       <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">caddr</span> <span style="color: #fd971f;">org-agenda-time-grid</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>
          ad-do-it<span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
    ad-do-it<span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
<span style="color: #eb4509;">(</span><span style="color: #b6e63e;">ad-activate</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">org-agenda-add-time-grid-maybe</span><span style="color: #eb4509;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org9e5321e" class="outline-4">
<h4 id="org9e5321e">Disable version control for Org mode agenda files</h4>
<div class="outline-text-4" id="text-org9e5321e">
<p>
&#x2013; David Maus
</p>

<p>
Even if you use Git to track your agenda files you might not need
vc-mode to be enabled for these files.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #eb4509;">(</span><span style="color: #b6e63e;">add-hook</span> <span style="color: #9c91e4;">'</span><span style="color: #fd971f;">find-file-hook</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">dmj/disable-vc-for-agenda-files-hook</span><span style="color: #eb4509;">)</span>
<span style="color: #eb4509;">(</span><span style="color: #eb4509;">defun</span> <span style="color: #b6e63e;">dmj/disable-vc-for-agenda-files-hook</span> <span style="color: #fd971f;">()</span>
  <span style="color: #7f7f80;">"Disable vc-mode for Org agenda files."</span>
  <span style="color: #fd971f;">(</span><span style="color: #eb4509;">if</span> <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">and</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">fboundp</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">org-agenda-file-p</span><span style="color: #eb4509;">)</span>
           <span style="color: #eb4509;">(</span><span style="color: #b6e63e;">org-agenda-file-p</span> <span style="color: #fd971f;">(</span><span style="color: #fd971f;">buffer-file-name</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
      <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">remove-hook</span> <span style="color: #9c91e4;">'</span><span style="color: #fd971f;">find-file-hook</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">vc-find-file-hook</span><span style="color: #b6e63e;">)</span>
    <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">add-hook</span> <span style="color: #9c91e4;">'</span><span style="color: #fd971f;">find-file-hook</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">vc-find-file-hook</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org9f3aefa" class="outline-4">
<h4 id="org9f3aefa">Easy customization of TODO colors</h4>
<div class="outline-text-4" id="text-org9f3aefa">
<p>
&#x2013; Ryan C. Thompson
</p>

<p>
Here is some code I came up with some code to make it easier to
customize the colors of various TODO keywords. As long as you just
want a different color and nothing else, you can customize the
variable org-todo-keyword-faces and use just a string color (i.e. a
string of the color name) as the face, and then org-get-todo-face
will convert the color to a face, inheriting everything else from
the standard org-todo face.
</p>

<p>
To demonstrate, I currently have org-todo-keyword-faces set to
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #eb4509;">(</span><span style="color: #fd971f;">(</span><span style="color: #e2c770;">"IN PROGRESS"</span> . <span style="color: #e2c770;">"dark orange"</span><span style="color: #fd971f;">)</span>
 <span style="color: #fd971f;">(</span><span style="color: #e2c770;">"WAITING"</span> . <span style="color: #e2c770;">"red4"</span><span style="color: #fd971f;">)</span>
 <span style="color: #fd971f;">(</span><span style="color: #e2c770;">"CANCELED"</span> . <span style="color: #e2c770;">"saddle brown"</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
</pre>
</div>

<p>
Here&rsquo;s the code, in a form you can put in your <code>.emacs</code>
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #eb4509;">(</span><span style="color: #b6e63e;">eval-after-load</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">org-faces</span>
 <span style="color: #9c91e4;">'</span><span style="color: #fd971f;">(</span><span style="color: #eb4509;">progn</span>
    <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">defcustom</span> <span style="color: #fd971f;">org-todo-keyword-faces</span> nil
      <span style="color: #7f7f80;">"Faces for specific </span><span style="color: #e2c770; font-weight: bold;">TODO</span><span style="color: #7f7f80;"> keywords.</span>
<span style="color: #7f7f80;">This is a list of cons cells, with </span><span style="color: #e2c770; font-weight: bold;">TODO</span><span style="color: #7f7f80;"> keywords in the car and</span>
<span style="color: #7f7f80;">faces in the cdr.  The face can be a symbol, a color, or a</span>
<span style="color: #7f7f80;">property list of attributes, like (:foreground \"blue\" :weight</span>
<span style="color: #7f7f80;">bold :underline t)."</span>
      <span style="color: #fd971f;">:group</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">org-faces</span>
      <span style="color: #fd971f;">:group</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">org-todo</span>
      <span style="color: #fd971f;">:type</span> <span style="color: #9c91e4;">'</span><span style="color: #eb4509;">(</span>repeat
              <span style="color: #fd971f;">(</span><span style="color: #fd971f;">cons</span>
               <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">string</span> <span style="color: #fd971f;">:tag</span> <span style="color: #e2c770;">"Keyword"</span><span style="color: #b6e63e;">)</span>
               <span style="color: #b6e63e;">(</span>choice color <span style="color: #eb4509;">(</span>sexp <span style="color: #fd971f;">:tag</span> <span style="color: #e2c770;">"Face"</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>

<span style="color: #eb4509;">(</span><span style="color: #b6e63e;">eval-after-load</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">org</span>
 <span style="color: #9c91e4;">'</span><span style="color: #fd971f;">(</span><span style="color: #eb4509;">progn</span>
    <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">defun</span> <span style="color: #b6e63e;">org-get-todo-face-from-color</span> <span style="color: #eb4509;">(</span>color<span style="color: #eb4509;">)</span>
      <span style="color: #7f7f80;">"Returns a specification for a face that inherits from org-todo</span>
<span style="color: #7f7f80;"> face and has the given color as foreground. Returns nil if</span>
<span style="color: #7f7f80;"> color is nil."</span>
      <span style="color: #eb4509;">(</span><span style="color: #eb4509;">when</span> color
        <span style="color: #9c91e4;">`</span><span style="color: #fd971f;">(</span><span style="color: #fd971f;">:inherit</span> org-warning <span style="color: #fd971f;">:foreground</span> ,color<span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>

    <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">defun</span> <span style="color: #b6e63e;">org-get-todo-face</span> <span style="color: #eb4509;">(</span>kwd<span style="color: #eb4509;">)</span>
      <span style="color: #7f7f80;">"Get the right face for a </span><span style="color: #e2c770; font-weight: bold;">TODO</span><span style="color: #7f7f80;"> keyword KWD.</span>
<span style="color: #7f7f80;">If KWD is a number, get the corresponding match group."</span>
      <span style="color: #eb4509;">(</span><span style="color: #eb4509;">if</span> <span style="color: #fd971f;">(</span><span style="color: #fd971f;">numberp</span> kwd<span style="color: #fd971f;">)</span> <span style="color: #fd971f;">(</span><span style="color: #eb4509;">setq</span> kwd <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">match-string</span> kwd<span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
      <span style="color: #eb4509;">(</span><span style="color: #eb4509;">or</span> <span style="color: #fd971f;">(</span><span style="color: #eb4509;">let</span> <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">(</span>face <span style="color: #fd971f;">(</span><span style="color: #fd971f;">cdr</span> <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">assoc</span> kwd <span style="color: #fd971f;">org-todo-keyword-faces</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
            <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">if</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">stringp</span> face<span style="color: #eb4509;">)</span>
                <span style="color: #eb4509;">(</span>org-get-todo-face-from-color face<span style="color: #eb4509;">)</span>
              face<span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>
          <span style="color: #fd971f;">(</span><span style="color: #eb4509;">and</span> <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">member</span> kwd <span style="color: #fd971f;">org-done-keywords</span><span style="color: #b6e63e;">)</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">org-done</span><span style="color: #fd971f;">)</span>
          <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">org-todo</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org6b4b736" class="outline-4">
<h4 id="org6b4b736">Add an effort estimate on the fly when clocking in</h4>
<div class="outline-text-4" id="text-org6b4b736">
<p>
You can use <code>org-clock-in-prepare-hook</code> to add an effort estimate.
This way you can easily have a &ldquo;tea-timer&rdquo; for your tasks when they
don&rsquo;t already have an effort estimate.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #eb4509;">(</span><span style="color: #b6e63e;">add-hook</span> <span style="color: #9c91e4;">'</span><span style="color: #fd971f;">org-clock-in-prepare-hook</span>
    <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">my-org-mode-ask-effort</span><span style="color: #eb4509;">)</span>

<span style="color: #eb4509;">(</span><span style="color: #eb4509;">defun</span> <span style="color: #b6e63e;">my-org-mode-ask-effort</span> <span style="color: #fd971f;">()</span>
  <span style="color: #7f7f80;">"Ask for an effort estimate when clocking in."</span>
  <span style="color: #fd971f;">(</span><span style="color: #eb4509;">unless</span> <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">org-entry-get</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">point</span><span style="color: #eb4509;">)</span> <span style="color: #e2c770;">"Effort"</span><span style="color: #b6e63e;">)</span>
    <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">let</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">(</span>effort
     <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">completing-read</span>
      <span style="color: #e2c770;">"Effort: "</span>
      <span style="color: #eb4509;">(</span><span style="color: #b6e63e;">org-entry-get-multivalued-property</span> <span style="color: #fd971f;">(</span><span style="color: #fd971f;">point</span><span style="color: #fd971f;">)</span> <span style="color: #e2c770;">"Effort"</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
      <span style="color: #eb4509;">(</span><span style="color: #eb4509;">unless</span> <span style="color: #fd971f;">(</span><span style="color: #fd971f;">equal</span> effort <span style="color: #e2c770;">""</span><span style="color: #fd971f;">)</span>
  <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">org-set-property</span> <span style="color: #e2c770;">"Effort"</span> effort<span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
</pre>
</div>

<p>
Or you can use a default effort for such a timer:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #eb4509;">(</span><span style="color: #b6e63e;">add-hook</span> <span style="color: #9c91e4;">'</span><span style="color: #fd971f;">org-clock-in-prepare-hook</span>
    <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">my-org-mode-add-default-effort</span><span style="color: #eb4509;">)</span>

<span style="color: #eb4509;">(</span><span style="color: #eb4509;">defvar</span> <span style="color: #fd971f;">org-clock-default-effort</span> <span style="color: #e2c770;">"1:00"</span><span style="color: #eb4509;">)</span>

<span style="color: #eb4509;">(</span><span style="color: #eb4509;">defun</span> <span style="color: #b6e63e;">my-org-mode-add-default-effort</span> <span style="color: #fd971f;">()</span>
  <span style="color: #7f7f80;">"Add a default effort estimation."</span>
  <span style="color: #fd971f;">(</span><span style="color: #eb4509;">unless</span> <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">org-entry-get</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">point</span><span style="color: #eb4509;">)</span> <span style="color: #e2c770;">"Effort"</span><span style="color: #b6e63e;">)</span>
    <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">org-set-property</span> <span style="color: #e2c770;">"Effort"</span> org-clock-default-effort<span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org7e9d8f1" class="outline-4">
<h4 id="org7e9d8f1">Use idle timer for automatic agenda views</h4>
<div class="outline-text-4" id="text-org7e9d8f1">
<p>
From John Wiegley&rsquo;s mailing list post (March 18, 2010):
</p>

<blockquote>
<p>
I have the following snippet in my .emacs file, which I find very
useful. Basically what it does is that if I don&rsquo;t touch my Emacs for 5
minutes, it displays the current agenda. This keeps my tasks &ldquo;always
in mind&rdquo; whenever I come back to Emacs after doing something else,
whereas before I had a tendency to forget that it was there.
</p>
</blockquote>

<ul class="org-ul">
<li><a href="http://mid.gmane.org/55590EA7-C744-44E5-909F-755F0BBE452D@gmail.com">John Wiegley: Displaying your Org agenda after idle time</a></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #eb4509;">(</span><span style="color: #eb4509;">defun</span> <span style="color: #b6e63e;">jump-to-org-agenda</span> <span style="color: #fd971f;">()</span>
  <span style="color: #fd971f;">(</span><span style="color: #eb4509;">interactive</span><span style="color: #fd971f;">)</span>
  <span style="color: #fd971f;">(</span><span style="color: #eb4509;">let</span> <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">(</span>buf <span style="color: #fd971f;">(</span><span style="color: #fd971f;">get-buffer</span> <span style="color: #e2c770;">"*Org Agenda*"</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
        wind<span style="color: #b6e63e;">)</span>
    <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">if</span> buf
        <span style="color: #eb4509;">(</span><span style="color: #eb4509;">if</span> <span style="color: #fd971f;">(</span><span style="color: #eb4509;">setq</span> wind <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">get-buffer-window</span> buf<span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>
            <span style="color: #fd971f;">(</span><span style="color: #fd971f;">select-window</span> wind<span style="color: #fd971f;">)</span>
          <span style="color: #fd971f;">(</span><span style="color: #eb4509;">if</span> <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">called-interactively-p</span><span style="color: #b6e63e;">)</span>
              <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">progn</span>
                <span style="color: #eb4509;">(</span><span style="color: #fd971f;">select-window</span> <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">display-buffer</span> buf t t<span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
                <span style="color: #eb4509;">(</span><span style="color: #b6e63e;">org-fit-window-to-buffer</span><span style="color: #eb4509;">)</span>
                <span style="color: #696969;">;; </span><span style="color: #696969;">(org-agenda-redo)</span>
                <span style="color: #b6e63e;">)</span>
            <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">with-selected-window</span> <span style="color: #eb4509;">(</span><span style="color: #b6e63e;">display-buffer</span> buf<span style="color: #eb4509;">)</span>
              <span style="color: #eb4509;">(</span><span style="color: #b6e63e;">org-fit-window-to-buffer</span><span style="color: #eb4509;">)</span>
              <span style="color: #696969;">;; </span><span style="color: #696969;">(org-agenda-redo)</span>
              <span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
      <span style="color: #eb4509;">(</span><span style="color: #fd971f;">call-interactively</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">org-agenda-list</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>
  <span style="color: #696969;">;;</span><span style="color: #696969;">(let ((buf (get-buffer "*Calendar*")))</span>
  <span style="color: #696969;">;;  </span><span style="color: #696969;">(unless (get-buffer-window buf)</span>
  <span style="color: #696969;">;;    </span><span style="color: #696969;">(org-agenda-goto-calendar)))</span>
  <span style="color: #eb4509;">)</span>

<span style="color: #eb4509;">(</span><span style="color: #b6e63e;">run-with-idle-timer</span> <span style="color: #9c91e4; font-weight: bold;">300</span> t <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">jump-to-org-agenda</span><span style="color: #eb4509;">)</span>
</pre>
</div>

<pre class="example">
[nil 0 300 0 t jump-to-org-agenda nil idle]
</pre>
</div>
</div>

<div id="outline-container-orgdb040ad" class="outline-4">
<h4 id="orgdb040ad">Refresh the agenda view regularly</h4>
<div class="outline-text-4" id="text-orgdb040ad">
<p>
Hack sent by Kiwon Um:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #eb4509;">(</span><span style="color: #eb4509;">defun</span> <span style="color: #b6e63e;">kiwon/org-agenda-redo-in-other-window</span> <span style="color: #fd971f;">()</span>
  <span style="color: #7f7f80;">"Call org-agenda-redo function even in the non-agenda buffer."</span>
  <span style="color: #fd971f;">(</span><span style="color: #eb4509;">interactive</span><span style="color: #fd971f;">)</span>
  <span style="color: #fd971f;">(</span><span style="color: #eb4509;">let</span> <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">(</span>agenda-window <span style="color: #fd971f;">(</span><span style="color: #fd971f;">get-buffer-window</span> <span style="color: #fd971f;">org-agenda-buffer-name</span> t<span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
    <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">when</span> agenda-window
      <span style="color: #eb4509;">(</span><span style="color: #eb4509;">with-selected-window</span> agenda-window <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">org-agenda-redo</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
<span style="color: #eb4509;">(</span><span style="color: #b6e63e;">run-at-time</span> nil <span style="color: #9c91e4; font-weight: bold;">300</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">kiwon/org-agenda-redo-in-other-window</span><span style="color: #eb4509;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org29fe039" class="outline-4">
<h4 id="org29fe039">Reschedule agenda items to today with a single command</h4>
<div class="outline-text-4" id="text-org29fe039">
<p>
This was suggested by Carsten in reply to David Abrahams:
</p>

<pre class="example">
(defun org-agenda-reschedule-to-today ()
  (interactive)
  (flet ((org-read-date (&amp;rest rest) (current-time)))
    (call-interactively 'org-agenda-schedule)))
</pre>
</div>
</div>

<div id="outline-container-org3fdd9b1" class="outline-4">
<h4 id="org3fdd9b1">Mark subtree DONE along with all subheadings</h4>
<div class="outline-text-4" id="text-org3fdd9b1">
<p>
Bernt Hansen <a href="https://orgmode.org/list/87aac7dnr6.fsf@norang.ca">suggested</a> this command:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #eb4509;">(</span><span style="color: #eb4509;">defun</span> <span style="color: #b6e63e;">bh/mark-subtree-done</span> <span style="color: #fd971f;">()</span>
  <span style="color: #fd971f;">(</span><span style="color: #eb4509;">interactive</span><span style="color: #fd971f;">)</span>
  <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">org-mark-subtree</span><span style="color: #fd971f;">)</span>
  <span style="color: #fd971f;">(</span><span style="color: #eb4509;">let</span> <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">(</span>limit <span style="color: #fd971f;">(</span><span style="color: #fd971f;">point</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
    <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">save-excursion</span>
      <span style="color: #eb4509;">(</span><span style="color: #b6e63e;">exchange-point-and-mark</span><span style="color: #eb4509;">)</span>
      <span style="color: #eb4509;">(</span><span style="color: #eb4509;">while</span> <span style="color: #fd971f;">(</span><span style="color: #fd971f;">&gt;</span> <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">point</span><span style="color: #b6e63e;">)</span> limit<span style="color: #fd971f;">)</span>
  <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">org-todo</span> <span style="color: #e2c770;">"DONE"</span><span style="color: #fd971f;">)</span>
  <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">outline-previous-visible-heading</span> <span style="color: #9c91e4; font-weight: bold;">1</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
      <span style="color: #eb4509;">(</span><span style="color: #b6e63e;">org-todo</span> <span style="color: #e2c770;">"DONE"</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
</pre>
</div>

<p>
Then M-x bh/mark-subtree-done.
</p>
</div>
</div>

<div id="outline-container-mark-done-when-all-checkboxes-checked" class="outline-4">
<h4 id="mark-done-when-all-checkboxes-checked">Mark heading done when all checkboxes are checked.</h4>
<div class="outline-text-4" id="text-mark-done-when-all-checkboxes-checked">
<p>
An item consists of a list with checkboxes.  When all of the
checkboxes are checked, the item should be considered complete and its
TODO state should be automatically changed to DONE. The code below
does that. This version is slightly enhanced over the one in the
mailing list (see
<a href="https://orgmode.org/list/87r5718ytv.fsf@sputnik.localhost">https://orgmode.org/list/87r5718ytv.fsf@sputnik.localhost</a> to
reset the state back to TODO if a checkbox is unchecked.
</p>

<p>
Note that the code requires that a checkbox statistics cookie (the <code>[/]</code>
or <code>[%]</code> thingie in the headline - see the <a href="https://orgmode.org/manual/Checkboxes.html#Checkboxes">Checkboxes</a> section in the
manual) be present in order for it to work. Note also that it is too
dumb to figure out whether the item has a TODO state in the first
place: if there is a statistics cookie, a TODO/DONE state will be
added willy-nilly any time that the statistics cookie is changed.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span style="color: #696969;">;; </span><span style="color: #696969;">see https://orgmode.org/list/87r5718ytv.fsf@sputnik.localhost</span>
  <span style="color: #eb4509;">(</span><span style="color: #b6e63e;">eval-after-load</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">org-list</span>
    <span style="color: #9c91e4;">'</span><span style="color: #fd971f;">(</span>add-hook <span style="color: #9c91e4;">'</span><span style="color: #fd971f;">org-checkbox-statistics-hook</span> <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">function</span> ndk/checkbox-list-complete<span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>

  <span style="color: #eb4509;">(</span><span style="color: #eb4509;">defun</span> <span style="color: #b6e63e;">ndk/checkbox-list-complete</span> <span style="color: #fd971f;">()</span>
    <span style="color: #fd971f;">(</span><span style="color: #eb4509;">save-excursion</span>
      <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">org-back-to-heading</span> t<span style="color: #b6e63e;">)</span>
      <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">let</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">(</span>beg <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">point</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span> end<span style="color: #eb4509;">)</span>
        <span style="color: #eb4509;">(</span><span style="color: #fd971f;">end-of-line</span><span style="color: #eb4509;">)</span>
        <span style="color: #eb4509;">(</span><span style="color: #eb4509;">setq</span> end <span style="color: #fd971f;">(</span><span style="color: #fd971f;">point</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
        <span style="color: #eb4509;">(</span><span style="color: #fd971f;">goto-char</span> beg<span style="color: #eb4509;">)</span>
        <span style="color: #eb4509;">(</span><span style="color: #eb4509;">if</span> <span style="color: #fd971f;">(</span><span style="color: #fd971f;">re-search-forward</span> <span style="color: #e2c770;">"\\[</span><span style="color: #9c91e4; font-weight: bold;">\\</span><span style="color: #9c91e4; font-weight: bold;">(</span><span style="color: #e2c770;">[0-9]*%</span><span style="color: #9c91e4; font-weight: bold;">\\</span><span style="color: #9c91e4; font-weight: bold;">)</span><span style="color: #e2c770;">\\]</span><span style="color: #9c91e4; font-weight: bold;">\\</span><span style="color: #9c91e4; font-weight: bold;">|</span><span style="color: #e2c770;">\\[</span><span style="color: #9c91e4; font-weight: bold;">\\</span><span style="color: #9c91e4; font-weight: bold;">(</span><span style="color: #e2c770;">[0-9]*</span><span style="color: #9c91e4; font-weight: bold;">\\</span><span style="color: #9c91e4; font-weight: bold;">)</span><span style="color: #e2c770;">/</span><span style="color: #9c91e4; font-weight: bold;">\\</span><span style="color: #9c91e4; font-weight: bold;">(</span><span style="color: #e2c770;">[0-9]*</span><span style="color: #9c91e4; font-weight: bold;">\\</span><span style="color: #9c91e4; font-weight: bold;">)</span><span style="color: #e2c770;">\\]"</span> end t<span style="color: #fd971f;">)</span>
              <span style="color: #fd971f;">(</span><span style="color: #eb4509;">if</span> <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">match-end</span> <span style="color: #9c91e4; font-weight: bold;">1</span><span style="color: #b6e63e;">)</span>
                  <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">if</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">equal</span> <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">match-string</span> <span style="color: #9c91e4; font-weight: bold;">1</span><span style="color: #fd971f;">)</span> <span style="color: #e2c770;">"100%"</span><span style="color: #eb4509;">)</span>
                      <span style="color: #696969;">;; </span><span style="color: #696969;">all done - do the state change</span>
                      <span style="color: #eb4509;">(</span><span style="color: #b6e63e;">org-todo</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">done</span><span style="color: #eb4509;">)</span>
                    <span style="color: #eb4509;">(</span><span style="color: #b6e63e;">org-todo</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">todo</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
                <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">if</span> <span style="color: #eb4509;">(</span><span style="color: #eb4509;">and</span> <span style="color: #fd971f;">(</span><span style="color: #fd971f;">&gt;</span> <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">match-end</span> <span style="color: #9c91e4; font-weight: bold;">2</span><span style="color: #b6e63e;">)</span> <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">match-beginning</span> <span style="color: #9c91e4; font-weight: bold;">2</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>
                         <span style="color: #fd971f;">(</span><span style="color: #fd971f;">equal</span> <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">match-string</span> <span style="color: #9c91e4; font-weight: bold;">2</span><span style="color: #b6e63e;">)</span> <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">match-string</span> <span style="color: #9c91e4; font-weight: bold;">3</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
                    <span style="color: #eb4509;">(</span><span style="color: #b6e63e;">org-todo</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">done</span><span style="color: #eb4509;">)</span>
                  <span style="color: #eb4509;">(</span><span style="color: #b6e63e;">org-todo</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">todo</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-links-to-agenda-views" class="outline-4">
<h4 id="links-to-agenda-views">Links to custom agenda views</h4>
<div class="outline-text-4" id="text-links-to-agenda-views">
<p>
This hack was <a href="http://lists.gnu.org/archive/html/emacs-orgmode/2012-08/msg00986.html">posted to the mailing list</a> by Nathan Neff.
</p>

<p>
If you have custom agenda commands defined to some key, say w, then
the following will serve as a link to the custom agenda buffer.
</p>
<pre class="example">
[[elisp:(org-agenda nil "w")][Show Waiting Tasks]]
</pre>


<p>
Clicking on it will prompt if you want to execute the elisp code.  If
you would rather not have the prompt or would want to respond with a
single letter, <code>y</code> or <code>n</code>, take a look at the docstrings of the
variables <code>org-confirm-elisp-link-function</code> and
<code>org-confirm-elisp-link-not-regexp</code>.  Please take special note of the
security risk associated with completely disabling the prompting
before you proceed.
</p>
</div>
</div>
</div>

<div id="outline-container-org63a9cd1" class="outline-3">
<h3 id="org63a9cd1">Exporting org files</h3>
<div class="outline-text-3" id="text-org63a9cd1">
</div>
<div id="outline-container-ignoreheadline" class="outline-4">
<h4 id="ignoreheadline">Ignoring headlines during export</h4>
<div class="outline-text-4" id="text-ignoreheadline">
<p>
Sometimes users want to ignore the headline text during export like in
the Beamer exporter (<code>ox-beamer</code>).  In the <a href="https://orgmode.org/manual/Beamer-export.html#Beamer-export">Beamer exporter</a> one can use
the tag <code>ignoreheading</code> to disable the export of a certain headline,
whilst still retaining the content of the headline.  We can imitate
this feature in other export backends.  Note that this is not a
particularly easy problem, as the Org exporter creates a static
representation of section numbers, table of contents etc.
</p>

<p>
Consider the following document:
</p>
<div class="org-src-container">
<pre class="src src-org">  * head 1                    :noexport:
  * head 2                    :ignoreheading:
  * head 3
  * <span style="color: #b6e63e;">head 4</span>                  :ignoreheading:

</pre>
</div>
<p>
We want to remove heading 2 and 4.
</p>

<p>
There are different strategies to accomplish this:
</p>
<ol class="org-ol">
<li>The best option is to remove headings tagged with <code>ignoreheading</code>
before export starts.  This can be accomplished with the hook
<code>org-export-before-parsing-hook</code> that runs before the buffer has
been parsed.  In the example above, however, <code>head 2</code> would not be
exported as it becomes part of <code>head 1</code> which is not exporter.  To
overcome this move perhaps <code>head 1</code> can be moved to the end of the
buffer.  An example of a hook that removes headings is before
parsing is available <a href="https://lists.gnu.org/archive/html/emacs-orgmode/2014-03/msg01459.html">here</a>.  Note, this solution is compatible with
<i>all</i> export formats!</li>
<li>The problem is simple when exporting to LaTeX, as the LaTeX
compiler determines numbers.  We can thus use
<code>org-export-filter-headline-functions</code> to remove the offending
headlines.  One regexp-based solution that looks for the word
<code>ignoreheading</code> is available on <a href="https://stackoverflow.com/questions/10295177/is-there-an-equivalent-of-org-modes-b-ignoreheading-for-non-beamer-documents">StackOverflow</a> for both the legacy
exporter Org v7 exporter and the current Org v8 exporter.  Note,
however, that this filter will only work with LaTeX (numbering and
the table of content may break in other exporters).  In the example
above, this filer will work flawlessly in LaTeX, it will not work
at all in HTML and it will fail to update section numbers, TOC and
leave some auxiliary lines behind when exporting to plain text.</li>
<li>Another solution that tries to recover the Org element
representation is available <a href="https://lists.gnu.org/archive/html/emacs-orgmode/2014-03/msg01480.html">here</a>.  In the example above this filter
will not remove <code>head 4</code> exporting to any backend, since verbatim
strings do not retain the Org element representation.  It will
remove the extra heading line when exporting to plain text, but
will also fail to update section numbers.  It should be fairly
simple to also make it work with HTML.</li>
</ol>

<p>
<b>NOTE: another way to accomplish this behavior is to use the <a href="https://code.orgmode.org/bzg/org-mode/raw/master/contrib/lisp/ox-extra.el"><code>ox-extra.el</code></a> package:</b>
To use this, add the following to your <code>.elisp</code> file:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span style="color: #eb4509;">(</span><span style="color: #b6e63e;">add-to-list</span> <span style="color: #9c91e4;">'</span><span style="color: #fd971f;">load-path</span> <span style="color: #e2c770;">"path/to/contrib/lisp"</span><span style="color: #eb4509;">)</span>
    <span style="color: #eb4509;">(</span><span style="color: #fd971f;">require</span> <span style="color: #9c91e4;">'</span><span style="color: #fd971f;">ox-extra</span><span style="color: #eb4509;">)</span>
    <span style="color: #eb4509;">(</span>ox-extras-activate <span style="color: #9c91e4;">'</span><span style="color: #fd971f;">(</span>ignore-headlines<span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
</pre>
</div>

<p>
After this is added, then any headlines having an <code>:ignore:</code> tag will
be omitted from the export, but their contents will be included in the
export.
</p>
</div>
</div>

<div id="outline-container-org7367a31" class="outline-4">
<h4 id="org7367a31">Export Org to Org and handle includes.</h4>
<div class="outline-text-4" id="text-org7367a31">
<p>
N.B: this does not apply to the &ldquo;new&rdquo; export engine (&gt;= 8.0) - the function
<code>org-export-handle-include-files-recurse</code> is only available in earlier versions.
There is probably a way to do the same thing in the &ldquo;new&rdquo; exporter but nobody
has stepped up to the plate yet.
</p>

<p>
Nick Dokos came up with this useful function:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #eb4509;">(</span><span style="color: #eb4509;">defun</span> <span style="color: #b6e63e;">org-to-org-handle-includes</span> <span style="color: #fd971f;">()</span>
  <span style="color: #7f7f80;">"Copy the contents of the current buffer to OUTFILE,</span>
<span style="color: #7f7f80;">recursively processing #+INCLUDEs."</span>
  <span style="color: #fd971f;">(</span><span style="color: #eb4509;">let*</span> <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">(</span>s <span style="color: #fd971f;">(</span><span style="color: #fd971f;">buffer-string</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
   <span style="color: #eb4509;">(</span>fname <span style="color: #fd971f;">(</span><span style="color: #fd971f;">buffer-file-name</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
   <span style="color: #eb4509;">(</span>ofname <span style="color: #fd971f;">(</span><span style="color: #fd971f;">format</span> <span style="color: #e2c770;">"%s.I.org"</span> <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">file-name-sans-extension</span> fname<span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
    <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">setq</span> result
    <span style="color: #eb4509;">(</span><span style="color: #eb4509;">with-temp-buffer</span>
      <span style="color: #fd971f;">(</span><span style="color: #fd971f;">insert</span> s<span style="color: #fd971f;">)</span>
      <span style="color: #fd971f;">(</span>org-export-handle-include-files-recurse<span style="color: #fd971f;">)</span>
      <span style="color: #fd971f;">(</span><span style="color: #fd971f;">buffer-string</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
    <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">find-file</span> ofname<span style="color: #b6e63e;">)</span>
    <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">delete-region</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">point-min</span><span style="color: #eb4509;">)</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">point-max</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
    <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">insert</span> result<span style="color: #b6e63e;">)</span>
    <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">save-buffer</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-latex-command-for-floats" class="outline-4">
<h4 id="latex-command-for-floats">Specifying LaTeX commands to floating environments</h4>
<div class="outline-text-4" id="text-latex-command-for-floats">
<p>
The keyword <code>placement</code> can be used to specify placement options to
floating environments (like <code>\begin{figure}</code> and <code>\begin{table}</code>}) in
LaTeX export. Org passes along everything passed in options as long as
there are no spaces. One can take advantage of this to pass other
LaTeX commands and have their scope limited to the floating
environment.
</p>

<p>
For example one can set the fontsize of a table different from the
default normal size by putting something like <code>\footnotesize</code> right
after the placement options. During LaTeX export using the
<code>#+ATTR_LaTeX:</code> line below:
</p>

<div class="org-src-container">
<pre class="src src-org"><span style="color: #7f7f80;">#+ATTR_LaTeX: placement=[&lt;options&gt;]\footnotesize</span>
</pre>
</div>

<p>
exports the associated floating environment as shown in the following
block.
</p>

<div class="org-src-container">
<pre class="src src-latex"><span style="color: #eb4509;">\begin</span>{<span style="color: #b6e63e;">table</span>}[&lt;options&gt;]<span style="color: #66d9ef;">\footnotesize</span>
...
<span style="color: #eb4509;">\end</span>{<span style="color: #b6e63e;">table</span>}
</pre>
</div>

<p>
It should be noted that this hack does not work for beamer export of
tables since the <code>table</code> environment is not used. As an ugly
workaround, one can use the following:
</p>

<div class="org-src-container">
<pre class="src src-org"><span style="color: #7f7f80;">#+LATEX: {\footnotesize</span>
<span style="color: #7f7f80;">#+ATTR_LaTeX: align=rr</span>
<span style="color: #9c91e4;">| some | table |</span>
<span style="color: #9c91e4;">|------+-------|</span>
<span style="color: #9c91e4;">| ..   | ..    |</span>
<span style="color: #7f7f80;">#+LATEX: }</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgac875b1" class="outline-4">
<h4 id="orgac875b1">Styling code sections with CSS</h4>
<div class="outline-text-4" id="text-orgac875b1">
<p>
Code sections (marked with <code>#+begin_src</code> and <code>#+end_src</code>) are exported
to HTML using <code>&lt;pre&gt;</code> tags, and assigned CSS classes by their content
type.  For example, Perl content will have an opening tag like
<code>&lt;pre class</code>&ldquo;src src-perl&rdquo;&gt;=.  You can use those classes to add styling
to the output, such as here where a small language tag is added at the
top of each kind of code box:
</p>

<div class="org-src-container">
<pre class="src src-lisp"><span style="color: #eb4509;">(</span>setq org-export-html-style
 <span style="color: #e2c770;">"&lt;style type=\"text/css\"&gt;</span>
<span style="color: #e2c770;">    &lt;!--/*--&gt;&lt;![CDATA[/*&gt;&lt;!--*/</span>
<span style="color: #e2c770;">      .src             { background-color: #F5FFF5; position: relative; overflow: visible; }</span>
<span style="color: #e2c770;">      .src:before      { position: absolute; top: -15px; background: #ffffff; padding: 1px; border: 1px solid #000000; font-size: small; }</span>
<span style="color: #e2c770;">      .src-sh:before   { content: 'sh'; }</span>
<span style="color: #e2c770;">      .src-bash:before { content: 'sh'; }</span>
<span style="color: #e2c770;">      .src-R:before    { content: 'R'; }</span>
<span style="color: #e2c770;">      .src-perl:before { content: 'Perl'; }</span>
<span style="color: #e2c770;">      .src-sql:before  { content: 'SQL'; }</span>
<span style="color: #e2c770;">      .example         { background-color: #FFF5F5; }</span>
<span style="color: #e2c770;">    /*]]&gt;*/--&gt;</span>
<span style="color: #e2c770;"> &lt;/style&gt;"</span><span style="color: #eb4509;">)</span>
</pre>
</div>

<p>
Additionally, we use color to distinguish code output (the <code>.example</code>
class) from input (all the <code>.src-*</code> classes).
</p>
</div>
</div>

<div id="outline-container-orgb41caee" class="outline-4">
<h4 id="orgb41caee">Where can I find nice themes for HTML export?</h4>
<div class="outline-text-4" id="text-orgb41caee">
<p>
You can find great looking HTML themes (CSS + JS) at
<a href="https://github.com/fniessen/org-html-themes">https://github.com/fniessen/org-html-themes</a>, currently:
</p>

<ul class="org-ul">
<li><p>
Bigblow, and
</p>


<div class="figure">
<p><img src="images/org-html-themes/bigblow.png" alt="bigblow.png" />
</p>
</div></li>

<li><p>
ReadTheOrg, a clone of Read The Docs.
</p>


<div class="figure">
<p><img src="images/org-html-themes/readtheorg.png" alt="readtheorg.png" />
</p>
</div></li>
</ul>

<p>
See <a href="https://www.youtube.com/watch?v=DnSGSiXYuOk">https://www.youtube.com/watch?v=DnSGSiXYuOk</a> for a demo of the Org
HTML theme Bigblow.
</p>
</div>
</div>

<div id="outline-container-orgf8f4948" class="outline-4">
<h4 id="orgf8f4948">Including external text fragments</h4>
<div class="outline-text-4" id="text-orgf8f4948">
<p>
I recently had to document some source code but could not modify the
source files themselves. Here is a setup that lets you refer to
fragments of external files, such that the fragments are inserted as
source blocks in the current file during evaluation of the <code>call</code>
lines (thus during export as well).
</p>

<div class="org-src-container">
<pre class="src src-org">  * Setup                                                            :noexport:
<span style="color: #7f7f80;">  #+name: fetchsrc</span>
<span style="color: #696969;">  #+BEGIN_SRC emacs-lisp :results raw :var f="foo" :var s="Definition" :var e="\\. *$" :var b=()</span>
<span style="background-color: #000000;">    </span><span style="color: #eb4509; background-color: #000000;">(</span><span style="color: #eb4509; background-color: #000000;">defvar</span><span style="background-color: #000000;"> </span><span style="color: #fd971f; background-color: #000000;">coqfiles</span><span style="background-color: #000000;"> nil</span><span style="color: #eb4509; background-color: #000000;">)</span>

<span style="background-color: #000000;">    </span><span style="color: #eb4509; background-color: #000000;">(</span><span style="color: #eb4509; background-color: #000000;">defun</span><span style="background-color: #000000;"> </span><span style="color: #b6e63e; background-color: #000000;">fetchlines</span><span style="background-color: #000000;"> </span><span style="color: #fd971f; background-color: #000000;">(</span><span style="background-color: #000000;">file-path search-string </span><span style="color: #66d9ef; background-color: #000000;">&amp;optional</span><span style="background-color: #000000;"> end before</span><span style="color: #fd971f; background-color: #000000;">)</span>
<span style="background-color: #000000;">      </span><span style="color: #7f7f80; background-color: #000000;">"Searches for the SEARCH-STRING in FILE-PATH and returns the matching line.</span>
<span style="color: #7f7f80; background-color: #000000;">    If the optional argument END is provided as a number, then this</span>
<span style="color: #7f7f80; background-color: #000000;">    number of lines is printed.  If END is a string, then it is a</span>
<span style="color: #7f7f80; background-color: #000000;">    regular expression indicating the end of the expression to print.</span>
<span style="color: #7f7f80; background-color: #000000;">    If END is omitted, then 10 lines are printed.  If BEFORE is set,</span>
<span style="color: #7f7f80; background-color: #000000;">    then one fewer line is printed (this is useful when END is a</span>
<span style="color: #7f7f80; background-color: #000000;">    string matching the first line that should not be printed)."</span>
<span style="background-color: #000000;">      </span><span style="color: #fd971f; background-color: #000000;">(</span><span style="color: #eb4509; background-color: #000000;">with-temp-buffer</span>
<span style="background-color: #000000;">        </span><span style="color: #b6e63e; background-color: #000000;">(</span><span style="color: #fd971f; background-color: #000000;">insert-file-contents</span><span style="background-color: #000000;"> file-path nil nil nil t</span><span style="color: #b6e63e; background-color: #000000;">)</span>
<span style="background-color: #000000;">        </span><span style="color: #b6e63e; background-color: #000000;">(</span><span style="color: #fd971f; background-color: #000000;">goto-char</span><span style="background-color: #000000;"> </span><span style="color: #eb4509; background-color: #000000;">(</span><span style="color: #fd971f; background-color: #000000;">point-min</span><span style="color: #eb4509; background-color: #000000;">)</span><span style="color: #b6e63e; background-color: #000000;">)</span>
<span style="background-color: #000000;">        </span><span style="color: #b6e63e; background-color: #000000;">(</span><span style="color: #eb4509; background-color: #000000;">let</span><span style="background-color: #000000;"> </span><span style="color: #eb4509; background-color: #000000;">(</span><span style="color: #fd971f; background-color: #000000;">(</span><span style="background-color: #000000;">result</span>
<span style="background-color: #000000;">               </span><span style="color: #b6e63e; background-color: #000000;">(</span><span style="color: #eb4509; background-color: #000000;">if</span><span style="background-color: #000000;"> </span><span style="color: #eb4509; background-color: #000000;">(</span><span style="color: #fd971f; background-color: #000000;">search-forward</span><span style="background-color: #000000;"> search-string nil t</span><span style="color: #eb4509; background-color: #000000;">)</span>
<span style="background-color: #000000;">                   </span><span style="color: #eb4509; background-color: #000000;">(</span><span style="color: #fd971f; background-color: #000000;">buffer-substring</span>
<span style="background-color: #000000;">                    </span><span style="color: #fd971f; background-color: #000000;">(</span><span style="color: #fd971f; background-color: #000000;">line-beginning-position</span><span style="color: #fd971f; background-color: #000000;">)</span>
<span style="background-color: #000000;">                    </span><span style="color: #fd971f; background-color: #000000;">(</span><span style="color: #eb4509; background-color: #000000;">if</span><span style="background-color: #000000;"> end</span>
<span style="background-color: #000000;">                        </span><span style="color: #b6e63e; background-color: #000000;">(</span><span style="color: #eb4509; background-color: #000000;">cond</span>
<span style="background-color: #000000;">                         </span><span style="color: #eb4509; background-color: #000000;">(</span><span style="color: #fd971f; background-color: #000000;">(</span><span style="color: #fd971f; background-color: #000000;">integerp</span><span style="background-color: #000000;"> end</span><span style="color: #fd971f; background-color: #000000;">)</span>
<span style="background-color: #000000;">                          </span><span style="color: #fd971f; background-color: #000000;">(</span><span style="color: #fd971f; background-color: #000000;">line-end-position</span><span style="background-color: #000000;"> </span><span style="color: #b6e63e; background-color: #000000;">(</span><span style="color: #eb4509; background-color: #000000;">if</span><span style="background-color: #000000;"> before </span><span style="color: #eb4509; background-color: #000000;">(</span><span style="color: #fd971f; background-color: #000000;">-</span><span style="background-color: #000000;"> end </span><span style="color: #9c91e4; background-color: #000000; font-weight: bold;">1</span><span style="color: #eb4509; background-color: #000000;">)</span><span style="background-color: #000000;"> end</span><span style="color: #b6e63e; background-color: #000000;">)</span><span style="color: #fd971f; background-color: #000000;">)</span><span style="color: #eb4509; background-color: #000000;">)</span>
<span style="background-color: #000000;">                         </span><span style="color: #eb4509; background-color: #000000;">(</span><span style="color: #fd971f; background-color: #000000;">(</span><span style="color: #fd971f; background-color: #000000;">stringp</span><span style="background-color: #000000;"> end</span><span style="color: #fd971f; background-color: #000000;">)</span>
<span style="background-color: #000000;">                          </span><span style="color: #fd971f; background-color: #000000;">(</span><span style="color: #eb4509; background-color: #000000;">let</span><span style="background-color: #000000;"> </span><span style="color: #b6e63e; background-color: #000000;">(</span><span style="color: #eb4509; background-color: #000000;">(</span><span style="color: #fd971f; background-color: #000000;">point</span><span style="background-color: #000000;"> </span><span style="color: #fd971f; background-color: #000000;">(</span><span style="color: #fd971f; background-color: #000000;">re-search-forward</span><span style="background-color: #000000;"> end nil t</span><span style="color: #fd971f; background-color: #000000;">)</span><span style="color: #eb4509; background-color: #000000;">)</span><span style="color: #b6e63e; background-color: #000000;">)</span>
<span style="background-color: #000000;">                            </span><span style="color: #b6e63e; background-color: #000000;">(</span><span style="color: #eb4509; background-color: #000000;">if</span><span style="background-color: #000000;"> before </span><span style="color: #eb4509; background-color: #000000;">(</span><span style="color: #fd971f; background-color: #000000;">line-end-position</span><span style="background-color: #000000;"> </span><span style="color: #9c91e4; background-color: #000000; font-weight: bold;">0</span><span style="color: #eb4509; background-color: #000000;">)</span><span style="background-color: #000000;"> point</span><span style="color: #b6e63e; background-color: #000000;">)</span><span style="color: #fd971f; background-color: #000000;">)</span><span style="color: #eb4509; background-color: #000000;">)</span>
<span style="background-color: #000000;">                         </span><span style="color: #eb4509; background-color: #000000;">(</span><span style="background-color: #000000;">t </span><span style="color: #fd971f; background-color: #000000;">(</span><span style="color: #fd971f; background-color: #000000;">line-end-position</span><span style="background-color: #000000;"> </span><span style="color: #9c91e4; background-color: #000000; font-weight: bold;">10</span><span style="color: #fd971f; background-color: #000000;">)</span><span style="color: #eb4509; background-color: #000000;">)</span><span style="color: #b6e63e; background-color: #000000;">)</span>
<span style="background-color: #000000;">                      </span><span style="color: #b6e63e; background-color: #000000;">(</span><span style="color: #fd971f; background-color: #000000;">line-end-position</span><span style="background-color: #000000;"> </span><span style="color: #9c91e4; background-color: #000000; font-weight: bold;">10</span><span style="color: #b6e63e; background-color: #000000;">)</span><span style="color: #fd971f; background-color: #000000;">)</span><span style="color: #eb4509; background-color: #000000;">)</span><span style="color: #b6e63e; background-color: #000000;">)</span><span style="color: #fd971f; background-color: #000000;">)</span><span style="color: #eb4509; background-color: #000000;">)</span>
<span style="background-color: #000000;">          </span><span style="color: #eb4509; background-color: #000000;">(</span><span style="color: #eb4509; background-color: #000000;">or</span><span style="background-color: #000000;"> result </span><span style="color: #e2c770; background-color: #000000;">""</span><span style="color: #eb4509; background-color: #000000;">)</span><span style="color: #b6e63e; background-color: #000000;">)</span><span style="color: #fd971f; background-color: #000000;">)</span><span style="color: #eb4509; background-color: #000000;">)</span>

<span style="background-color: #000000;">    </span><span style="color: #eb4509; background-color: #000000;">(</span><span style="background-color: #000000;">fetchlines </span><span style="color: #fd971f; background-color: #000000;">(</span><span style="color: #fd971f; background-color: #000000;">concat</span><span style="background-color: #000000;"> coqfiles f </span><span style="color: #e2c770; background-color: #000000;">".v"</span><span style="color: #fd971f; background-color: #000000;">)</span><span style="background-color: #000000;"> s e b</span><span style="color: #eb4509; background-color: #000000;">)</span>
<span style="color: #696969;">  #+END_SRC</span>

<span style="color: #7f7f80;">  #+name: wrap-coq</span>
<span style="color: #696969;">  #+BEGIN_SRC emacs-lisp :var text="" :results raw</span>
<span style="background-color: #000000;">  </span><span style="color: #eb4509; background-color: #000000;">(</span><span style="color: #fd971f; background-color: #000000;">concat</span><span style="background-color: #000000;"> </span><span style="color: #e2c770; background-color: #000000;">"#+BEGIN_SRC coq\n"</span><span style="background-color: #000000;"> text </span><span style="color: #e2c770; background-color: #000000;">"\n#+END_SRC"</span><span style="color: #eb4509; background-color: #000000;">)</span>
<span style="color: #696969;">  #+END_SRC</span>
</pre>
</div>

<p>
This is specialized for Coq files (hence the <code>coq</code> language in the
<code>wrap-coq</code> function, the <code>.v</code> extension in the <code>fetch</code> function, and
the default value for <code>end</code> matching the syntax ending definitions in
Coq). To use it, you need to:
</p>
<ul class="org-ul">
<li>set the <code>coqfiles</code> variable to where your source files reside;</li>
<li><p>
call the function using lines of the form
</p>
<div class="org-src-container">
<pre class="src src-org"><span style="color: #7f7f80;">    #+call: fetchsrc(f="JsSyntax", s="Inductive expr :=", e="^ *$", b=1) :results drawer :post wrap-coq(text=*this*)</span>
</pre>
</div>
<p>
In this example, we look inside the file <code>JsSyntax.v</code> in <code>coqfiles</code>,
search for a line matching <code>Inductive expr :=</code>, and include the
fragment until the first line consisting only of white space,
excluded (as <code>b=1</code>).
</p></li>
</ul>

<p>
I use drawers to store the results to avoid a bug leading to
duplication during export when the code has already been evaluated in
the buffer (see <a href="https://orgmode.org/list/m2k3fkbxec.fsf@polytechnique.org">this thread</a> for a description of the problem). This
has been fixed in recent versions of org-mode, so alternative
approaches are possible.
</p>
</div>
</div>
</div>

<div id="outline-container-org4a463a2" class="outline-3">
<h3 id="org4a463a2">Babel</h3>
<div class="outline-text-3" id="text-org4a463a2">
</div>
<div id="outline-container-orge2628a4" class="outline-4">
<h4 id="orge2628a4">How do I preview LaTeX fragments when in a LaTeX source block?</h4>
<div class="outline-text-4" id="text-orge2628a4">
<p>
When editing <code>LaTeX</code> source blocks, you may want to preview LaTeX fragments
just like in an Org-mode buffer.  You can do this by using the usual
keybinding <code>C-c C-x C-l</code> after loading this snipped:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #eb4509;">(</span><span style="color: #fd971f;">define-key</span> <span style="color: #fd971f;">org-src-mode-map</span> <span style="color: #e2c770;">"\C-c\C-x\C-l"</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">org-edit-preview-latex-fragment</span><span style="color: #eb4509;">)</span>

<span style="color: #eb4509;">(</span><span style="color: #eb4509;">defun</span> <span style="color: #b6e63e;">org-edit-preview-latex-fragment</span> <span style="color: #fd971f;">()</span>
  <span style="color: #7f7f80;">"Write latex fragment from source to parent buffer and preview it."</span>
  <span style="color: #fd971f;">(</span><span style="color: #eb4509;">interactive</span><span style="color: #fd971f;">)</span>
  <span style="color: #fd971f;">(</span>org-src-in-org-buffer <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">org-preview-latex-fragment</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
</pre>
</div>

<p>
Thanks to Sebastian Hofer for sharing this.
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-org60792b4" class="outline-2">
<h2 id="org60792b4">Hacking Org: Working with Org-mode and other Emacs Packages</h2>
<div class="outline-text-2" id="text-org60792b4">
</div>
<div id="outline-container-org76d0082" class="outline-3">
<h3 id="org76d0082">How to ediff folded Org files</h3>
<div class="outline-text-3" id="text-org76d0082">
<p>
A rather often quip among Org users is when looking at chages with
ediff.  Ediff tends to fold the Org buffers when comparing.  This can
be very inconvenient when trying to determine what changed.  A recent
discussion on the mailing list led to a <a href="https://orgmode.org/list/87wqo5fnxc.dlv@debian.org">neat solution</a> from Ratish
Punnoose.
</p>
</div>
</div>

<div id="outline-container-orgec6af19" class="outline-3">
<h3 id="orgec6af19">org-remember-anything</h3>
<div class="outline-text-3" id="text-orgec6af19">
<p>
<a href="http://www.emacswiki.org/cgi-bin/wiki/Anything">Anything</a> users may find the snippet below interesting:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #eb4509;">(</span><span style="color: #eb4509;">defvar</span> <span style="color: #fd971f;">org-remember-anything</span>
  <span style="color: #9c91e4;">'</span><span style="color: #fd971f;">(</span><span style="color: #b6e63e;">(</span>name . <span style="color: #e2c770;">"Org Remember"</span><span style="color: #b6e63e;">)</span>
    <span style="color: #b6e63e;">(</span>candidates . <span style="color: #eb4509;">(</span><span style="color: #eb4509;">lambda</span> <span style="color: #fd971f;">()</span> <span style="color: #fd971f;">(</span><span style="color: #fd971f;">mapcar</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">car</span> org-remember-templates<span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
    <span style="color: #b6e63e;">(</span>action . <span style="color: #eb4509;">(</span><span style="color: #eb4509;">lambda</span> <span style="color: #fd971f;">(</span>name<span style="color: #fd971f;">)</span>
                <span style="color: #fd971f;">(</span><span style="color: #eb4509;">let*</span> <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">(</span>orig-template org-remember-templates<span style="color: #eb4509;">)</span>
                       <span style="color: #eb4509;">(</span>org-remember-templates
                        <span style="color: #fd971f;">(</span><span style="color: #fd971f;">list</span> <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">assoc</span> name orig-template<span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
                  <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">call-interactively</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">org-remember</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
</pre>
</div>

<p>
You can add it to your &rsquo;anything-sources&rsquo; variable and open remember directly
from anything. I imagine this would be more interesting for people with many
remember templates, so that you are out of keys to assign those to.
</p>
</div>
</div>

<div id="outline-container-orga7e2b33" class="outline-3">
<h3 id="orga7e2b33">Org-mode and saveplace.el</h3>
<div class="outline-text-3" id="text-orga7e2b33">
<p>
Fix a problem with <code>saveplace.el</code> putting you back in a folded position:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #eb4509;">(</span><span style="color: #b6e63e;">add-hook</span> <span style="color: #9c91e4;">'</span><span style="color: #fd971f;">org-mode-hook</span>
          <span style="color: #fd971f;">(</span><span style="color: #eb4509;">lambda</span> <span style="color: #b6e63e;">()</span>
      <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">when</span> <span style="color: #eb4509;">(</span><span style="color: #b6e63e;">outline-invisible-p</span><span style="color: #eb4509;">)</span>
        <span style="color: #eb4509;">(</span><span style="color: #eb4509;">save-excursion</span>
    <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">outline-previous-visible-heading</span> <span style="color: #9c91e4; font-weight: bold;">1</span><span style="color: #fd971f;">)</span>
    <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">org-show-subtree</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org0ceec78" class="outline-3">
<h3 id="org0ceec78">Using ido-mode for org-refile (and archiving via refile)</h3>
<div class="outline-text-3" id="text-org0ceec78">
<p>
First set up ido-mode, for example using:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #696969;">; </span><span style="color: #696969;">use ido mode for completion</span>
<span style="color: #eb4509;">(</span><span style="color: #eb4509;">setq</span> ido-everywhere t<span style="color: #eb4509;">)</span>
<span style="color: #eb4509;">(</span><span style="color: #eb4509;">setq</span> ido-enable-flex-matching t<span style="color: #eb4509;">)</span>
<span style="color: #eb4509;">(</span><span style="color: #eb4509;">setq</span> ido-max-directory-size <span style="color: #9c91e4; font-weight: bold;">100000</span><span style="color: #eb4509;">)</span>
<span style="color: #eb4509;">(</span><span style="color: #fd971f;">ido-mode</span> <span style="color: #fd971f;">(</span><span style="color: #eb4509;">quote</span> both<span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
</pre>
</div>

<p>
Now to enable it in org-mode, use the following:
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #eb4509;">(</span><span style="color: #eb4509;">setq</span> org-completion-use-ido t<span style="color: #eb4509;">)</span>
<span style="color: #eb4509;">(</span><span style="color: #eb4509;">setq</span> <span style="color: #fd971f;">org-refile-use-outline-path</span> nil<span style="color: #eb4509;">)</span>
<span style="color: #eb4509;">(</span><span style="color: #eb4509;">setq</span> <span style="color: #fd971f;">org-refile-allow-creating-parent-nodes</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">confirm</span><span style="color: #eb4509;">)</span>
</pre>
</div>
<p>
The last line enables the creation of nodes on the fly.
</p>

<p>
If you refile into files that are not in your agenda file list, you can add them as target like this (replace file1\<sub>done</sub>, etc with your files):
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #eb4509;">(</span><span style="color: #eb4509;">setq</span> <span style="color: #fd971f;">org-refile-targets</span> <span style="color: #9c91e4;">'</span><span style="color: #fd971f;">(</span><span style="color: #b6e63e;">(</span><span style="color: #fd971f;">org-agenda-files</span> <span style="color: #fd971f;">:maxlevel</span> . <span style="color: #9c91e4; font-weight: bold;">5</span><span style="color: #b6e63e;">)</span> <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">(</span><span style="color: #e2c770;">"~/org/file1_done"</span> <span style="color: #e2c770;">"~/org/file2_done"</span><span style="color: #eb4509;">)</span> <span style="color: #fd971f;">:maxlevel</span> . <span style="color: #9c91e4; font-weight: bold;">5</span><span style="color: #b6e63e;">)</span> <span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
</pre>
</div>

<p>
For refiling it is often not useful to include targets that have a DONE state. It&rsquo;s easy to remove them by using the verify-refile-target hook.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #696969;">; </span><span style="color: #696969;">Exclude DONE state tasks from refile targets; taken from http://doc.norang.ca/org-mode.html</span>
<span style="color: #696969;">; </span><span style="color: #696969;">added check to only include headlines, e.g. line must have at least one child</span>
<span style="color: #eb4509;">(</span><span style="color: #eb4509;">defun</span> <span style="color: #b6e63e;">my/verify-refile-target</span> <span style="color: #fd971f;">()</span>
  <span style="color: #7f7f80;">"Exclude todo keywords with a DONE state from refile targets"</span>
  <span style="color: #fd971f;">(</span><span style="color: #eb4509;">or</span> <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">not</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">member</span> <span style="color: #fd971f;">(</span><span style="color: #fd971f;">nth</span> <span style="color: #9c91e4; font-weight: bold;">2</span> <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">org-heading-components</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span> <span style="color: #fd971f;">org-done-keywords</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>
      <span style="color: #fd971f;">(</span><span style="color: #eb4509;">save-excursion</span> <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">org-goto-first-child</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>
  <span style="color: #eb4509;">)</span>
<span style="color: #eb4509;">(</span><span style="color: #eb4509;">setq</span> <span style="color: #fd971f;">org-refile-target-verify-function</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">my/verify-refile-target</span><span style="color: #eb4509;">)</span>
</pre>
</div>
<p>
Now when looking for a refile target, you can use the full power of ido to find them. Ctrl-R can be used to switch between different options that ido offers.
</p>
</div>
</div>

<div id="outline-container-org6dbd0f3" class="outline-3">
<h3 id="org6dbd0f3">Using ido-completing-read to find attachments</h3>
<div class="outline-text-3" id="text-org6dbd0f3">
<p>
&#x2013; Matt Lundin.
</p>

<p>
Org-attach is great for quickly linking files to a project. But if you
use org-attach extensively you might find yourself wanting to browse
all the files you&rsquo;ve attached to org headlines. This is not easy to do
manually, since the directories containing the files are not human
readable (i.e., they are based on automatically generated ids). Here&rsquo;s
some code to browse those files using ido (obviously, you need to be
using ido):
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #eb4509;">(</span><span style="color: #b6e63e;">load-library</span> <span style="color: #e2c770;">"find-lisp"</span><span style="color: #eb4509;">)</span>

<span style="color: #696969;">;; </span><span style="color: #696969;">Adapted from http://www.emacswiki.org/emacs/RecentFiles</span>

<span style="color: #eb4509;">(</span><span style="color: #eb4509;">defun</span> <span style="color: #b6e63e;">my-ido-find-org-attach</span> <span style="color: #fd971f;">()</span>
  <span style="color: #7f7f80;">"Find files in org-attachment directory"</span>
  <span style="color: #fd971f;">(</span><span style="color: #eb4509;">interactive</span><span style="color: #fd971f;">)</span>
  <span style="color: #fd971f;">(</span><span style="color: #eb4509;">let*</span> <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">(</span><span style="color: #fd971f;">enable-recursive-minibuffers</span> t<span style="color: #eb4509;">)</span>
         <span style="color: #eb4509;">(</span>files <span style="color: #fd971f;">(</span>find-lisp-find-files <span style="color: #fd971f;">org-attach-directory</span> <span style="color: #e2c770;">"."</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
         <span style="color: #eb4509;">(</span>file-assoc-list
          <span style="color: #fd971f;">(</span><span style="color: #fd971f;">mapcar</span> <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">lambda</span> <span style="color: #eb4509;">(</span>x<span style="color: #eb4509;">)</span>
                    <span style="color: #eb4509;">(</span><span style="color: #fd971f;">cons</span> <span style="color: #fd971f;">(</span><span style="color: #fd971f;">file-name-nondirectory</span> x<span style="color: #fd971f;">)</span>
                          x<span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
                  files<span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
         <span style="color: #eb4509;">(</span>filename-list
          <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">remove-duplicates</span> <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">mapcar</span> <span style="color: #9c91e4;">#'</span><span style="color: #66d9ef;">car</span> file-assoc-list<span style="color: #b6e63e;">)</span>
                             <span style="color: #fd971f;">:test</span> <span style="color: #9c91e4;">#'</span><span style="color: #66d9ef;">string=</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
         <span style="color: #eb4509;">(</span>filename <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">ido-completing-read</span> <span style="color: #e2c770;">"Org attachments: "</span> filename-list nil t<span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
         <span style="color: #eb4509;">(</span>longname <span style="color: #fd971f;">(</span><span style="color: #fd971f;">cdr</span> <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">assoc</span> filename file-assoc-list<span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
    <span style="color: #b6e63e;">(</span>ido-set-current-directory
     <span style="color: #eb4509;">(</span><span style="color: #eb4509;">if</span> <span style="color: #fd971f;">(</span><span style="color: #fd971f;">file-directory-p</span> longname<span style="color: #fd971f;">)</span>
         longname
       <span style="color: #fd971f;">(</span><span style="color: #fd971f;">file-name-directory</span> longname<span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
    <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">setq</span> ido-exit <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">refresh</span>
          ido-text-init ido-text
          ido-rotate-temp t<span style="color: #b6e63e;">)</span>
    <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">exit-minibuffer</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>

<span style="color: #eb4509;">(</span><span style="color: #b6e63e;">add-hook</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">ido-setup-hook</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">ido-my-keys</span><span style="color: #eb4509;">)</span>

<span style="color: #eb4509;">(</span><span style="color: #eb4509;">defun</span> <span style="color: #b6e63e;">ido-my-keys</span> <span style="color: #fd971f;">()</span>
  <span style="color: #7f7f80;">"Add my keybindings for ido."</span>
  <span style="color: #fd971f;">(</span><span style="color: #fd971f;">define-key</span> ido-completion-map <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">kbd</span> <span style="color: #e2c770;">"C-;"</span><span style="color: #b6e63e;">)</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">my-ido-find-org-attach</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
</pre>
</div>

<p>
To browse your org attachments using ido fuzzy matching and/or the
completion buffer, invoke ido-find-file as usual (<code>C-x C-f</code>) and then
press <code>C-;</code>.
</p>
</div>
</div>

<div id="outline-container-orgd82b4a2" class="outline-3">
<h3 id="orgd82b4a2">Link to Gnus messages by Message-Id</h3>
<div class="outline-text-3" id="text-orgd82b4a2">
<p>
In a <a href="https://orgmode.org/list/871vy3tg9x.fsf@wolfram.com">recent thread</a> on the Org-Mode mailing list, there was some
discussion about linking to Gnus messages without encoding the folder
name in the link.  The following code hooks in to the store-link
function in Gnus to capture links by Message-Id when in nnml folders,
and then provides a link type &ldquo;mid&rdquo; which can open this link.  The
<code>mde-org-gnus-open-message-link</code> function uses the
<code>mde-mid-resolve-methods</code> variable to determine what Gnus backends to
scan.  It will go through them, in order, asking each to locate the
message and opening it from the first one that reports success.
</p>

<p>
It has only been tested with a single nnml backend, so there may be
bugs lurking here and there.
</p>

<p>
The logic for finding the message was adapted from <a href="http://www.emacswiki.org/cgi-bin/wiki/FindMailByMessageId">an Emacs Wiki
article</a>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #696969;">;; </span><span style="color: #696969;">Support for saving Gnus messages by Message-ID</span>
<span style="color: #eb4509;">(</span><span style="color: #eb4509;">defun</span> <span style="color: #b6e63e;">mde-org-gnus-save-by-mid</span> <span style="color: #fd971f;">()</span>
  <span style="color: #fd971f;">(</span><span style="color: #eb4509;">when</span> <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">memq</span> <span style="color: #fd971f;">major-mode</span> <span style="color: #9c91e4;">'</span><span style="color: #eb4509;">(</span>gnus-summary-mode gnus-article-mode<span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
    <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">when</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">eq</span> <span style="color: #fd971f;">major-mode</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">gnus-article-mode</span><span style="color: #eb4509;">)</span>
      <span style="color: #eb4509;">(</span>gnus-article-show-summary<span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
    <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">let*</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">(</span>group <span style="color: #fd971f;">gnus-newsgroup-name</span><span style="color: #fd971f;">)</span>
           <span style="color: #fd971f;">(</span>method <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">gnus-find-method-for-group</span> group<span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
      <span style="color: #eb4509;">(</span><span style="color: #eb4509;">when</span> <span style="color: #fd971f;">(</span><span style="color: #fd971f;">eq</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">nnml</span> <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">car</span> method<span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>
        <span style="color: #fd971f;">(</span><span style="color: #eb4509;">let*</span> <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">(</span>article <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">gnus-summary-article-number</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
               <span style="color: #eb4509;">(</span>header <span style="color: #fd971f;">(</span>gnus-summary-article-header article<span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
               <span style="color: #eb4509;">(</span>from <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">mail-header-from</span> header<span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
               <span style="color: #eb4509;">(</span>message-id
                <span style="color: #fd971f;">(</span><span style="color: #eb4509;">save-match-data</span>
                  <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">let</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">(</span>mid <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">mail-header-id</span> header<span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
                    <span style="color: #eb4509;">(</span><span style="color: #eb4509;">if</span> <span style="color: #fd971f;">(</span><span style="color: #fd971f;">string-match</span> <span style="color: #e2c770;">"&lt;</span><span style="color: #9c91e4; font-weight: bold;">\\</span><span style="color: #9c91e4; font-weight: bold;">(</span><span style="color: #e2c770;">.*</span><span style="color: #9c91e4; font-weight: bold;">\\</span><span style="color: #9c91e4; font-weight: bold;">)</span><span style="color: #e2c770;">&gt;"</span> mid<span style="color: #fd971f;">)</span>
                        <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">match-string</span> <span style="color: #9c91e4; font-weight: bold;">1</span> mid<span style="color: #fd971f;">)</span>
                      <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">error</span> <span style="color: #e2c770;">"Malformed message ID header %s"</span> mid<span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
               <span style="color: #eb4509;">(</span>date <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">mail-header-date</span> header<span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
               <span style="color: #eb4509;">(</span>subject <span style="color: #fd971f;">(</span>gnus-summary-subject-string<span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
          <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">org-store-link-props</span> <span style="color: #fd971f;">:type</span> <span style="color: #e2c770;">"mid"</span> <span style="color: #fd971f;">:from</span> from <span style="color: #fd971f;">:subject</span> subject
                                <span style="color: #fd971f;">:message-id</span> message-id <span style="color: #fd971f;">:group</span> group
                                <span style="color: #fd971f;">:link</span> <span style="color: #eb4509;">(</span>org-make-link <span style="color: #e2c770;">"mid:"</span> message-id<span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
          <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">apply</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">org-store-link-props</span>
                 <span style="color: #fd971f;">:description</span> <span style="color: #eb4509;">(</span><span style="color: #b6e63e;">org-email-link-description</span><span style="color: #eb4509;">)</span>
                 <span style="color: #fd971f;">org-store-link-plist</span><span style="color: #b6e63e;">)</span>
          t<span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>

<span style="color: #eb4509;">(</span><span style="color: #eb4509;">defvar</span> <span style="color: #fd971f;">mde-mid-resolve-methods</span> <span style="color: #9c91e4;">'</span><span style="color: #fd971f;">()</span>
  <span style="color: #7f7f80;">"List of methods to try when resolving message ID's.  For Gnus,</span>
<span style="color: #7f7f80;">it is a cons of 'gnus and the select (type and name)."</span><span style="color: #eb4509;">)</span>
<span style="color: #eb4509;">(</span><span style="color: #eb4509;">setq</span> mde-mid-resolve-methods
      <span style="color: #9c91e4;">'</span><span style="color: #fd971f;">(</span><span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">gnus</span> nnml <span style="color: #e2c770;">""</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>

<span style="color: #eb4509;">(</span><span style="color: #eb4509;">defvar</span> <span style="color: #fd971f;">mde-org-gnus-open-level</span> <span style="color: #9c91e4; font-weight: bold;">1</span>
  <span style="color: #7f7f80;">"Level at which Gnus is started when opening a link"</span><span style="color: #eb4509;">)</span>
<span style="color: #eb4509;">(</span><span style="color: #eb4509;">defun</span> <span style="color: #b6e63e;">mde-org-gnus-open-message-link</span> <span style="color: #fd971f;">(</span>msgid<span style="color: #fd971f;">)</span>
  <span style="color: #7f7f80;">"Open a message link with Gnus"</span>
  <span style="color: #fd971f;">(</span><span style="color: #fd971f;">require</span> <span style="color: #9c91e4;">'</span><span style="color: #fd971f;">gnus</span><span style="color: #fd971f;">)</span>
  <span style="color: #fd971f;">(</span><span style="color: #fd971f;">require</span> <span style="color: #9c91e4;">'</span><span style="color: #fd971f;">org-table</span><span style="color: #fd971f;">)</span>
  <span style="color: #fd971f;">(</span><span style="color: #eb4509;">catch</span> <span style="color: #9c91e4;">'</span><span style="color: #fd971f;">method-found</span>
    <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">message</span> <span style="color: #e2c770;">"[MID linker] Resolving %s"</span> msgid<span style="color: #b6e63e;">)</span>
    <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">dolist</span> <span style="color: #eb4509;">(</span>method mde-mid-resolve-methods<span style="color: #eb4509;">)</span>
      <span style="color: #eb4509;">(</span><span style="color: #eb4509;">cond</span>
       <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">(</span><span style="color: #eb4509;">and</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">eq</span> <span style="color: #fd971f;">(</span><span style="color: #fd971f;">car</span> method<span style="color: #fd971f;">)</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">gnus</span><span style="color: #eb4509;">)</span>
             <span style="color: #eb4509;">(</span><span style="color: #fd971f;">eq</span> <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">cadr</span> method<span style="color: #fd971f;">)</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">nnml</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
        <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">funcall</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">cdr</span> <span style="color: #fd971f;">(</span><span style="color: #fd971f;">assq</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">gnus</span> <span style="color: #fd971f;">org-link-frame-setup</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
                 mde-org-gnus-open-level<span style="color: #b6e63e;">)</span>
        <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">when</span> <span style="color: #fd971f;">gnus-other-frame-object</span>
          <span style="color: #eb4509;">(</span><span style="color: #fd971f;">select-frame</span> <span style="color: #fd971f;">gnus-other-frame-object</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
        <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">let*</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">(</span>msg-info <span style="color: #b6e63e;">(</span>nnml-find-group-number
                          <span style="color: #eb4509;">(</span><span style="color: #fd971f;">concat</span> <span style="color: #e2c770;">"&lt;"</span> msgid <span style="color: #e2c770;">"&gt;"</span><span style="color: #eb4509;">)</span>
                          <span style="color: #eb4509;">(</span><span style="color: #fd971f;">cdr</span> method<span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>
               <span style="color: #fd971f;">(</span>group <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">and</span> msg-info <span style="color: #eb4509;">(</span><span style="color: #fd971f;">car</span> msg-info<span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>
               <span style="color: #fd971f;">(</span><span style="color: #fd971f;">message</span> <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">and</span> msg-info <span style="color: #eb4509;">(</span><span style="color: #fd971f;">cdr</span> msg-info<span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>
               <span style="color: #fd971f;">(</span>qname <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">and</span> group
                           <span style="color: #eb4509;">(</span><span style="color: #eb4509;">if</span> <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">gnus-methods-equal-p</span>
                                <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">cdr</span> method<span style="color: #b6e63e;">)</span>
                                <span style="color: #fd971f;">gnus-select-method</span><span style="color: #fd971f;">)</span>
                               group
                             <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">gnus-group-full-name</span> group <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">cdr</span> method<span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
          <span style="color: #eb4509;">(</span><span style="color: #eb4509;">when</span> msg-info
            <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">gnus-summary-read-group</span> qname nil t<span style="color: #fd971f;">)</span>
            <span style="color: #fd971f;">(</span>gnus-summary-goto-article message nil t<span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
          <span style="color: #eb4509;">(</span><span style="color: #fd971f;">throw</span> <span style="color: #9c91e4;">'</span><span style="color: #fd971f;">method-found</span> t<span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>
       <span style="color: #fd971f;">(</span>t <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">error</span> <span style="color: #e2c770;">"Unknown link type"</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>

<span style="color: #eb4509;">(</span><span style="color: #b6e63e;">eval-after-load</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">org-gnus</span>
  <span style="color: #9c91e4;">'</span><span style="color: #fd971f;">(</span><span style="color: #eb4509;">progn</span>
     <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">add-to-list</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">org-store-link-functions</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">mde-org-gnus-save-by-mid</span><span style="color: #b6e63e;">)</span>
     <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">org-add-link-type</span> <span style="color: #e2c770;">"mid"</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">mde-org-gnus-open-message-link</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orge37b115" class="outline-3">
<h3 id="orge37b115">Store link to a message when sending in Gnus</h3>
<div class="outline-text-3" id="text-orge37b115">
<p>
Ulf Stegemann came up with this solution (see his <a href="http://www.mail-archive.com/emacs-orgmode@gnu.org/msg33278.html">original message</a>):
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #eb4509;">(</span><span style="color: #eb4509;">defun</span> <span style="color: #b6e63e;">ulf-message-send-and-org-gnus-store-link</span> <span style="color: #fd971f;">(</span><span style="color: #66d9ef;">&amp;optional</span> arg<span style="color: #fd971f;">)</span>
  <span style="color: #7f7f80;">"Send message with `</span><span style="color: #fd971f;">message-send-and-exit</span><span style="color: #7f7f80;">' and store org link to message copy.</span>
<span style="color: #7f7f80;">If multiple groups appear in the Gcc header, the link refers to</span>
<span style="color: #7f7f80;">the copy in the last group."</span>
  <span style="color: #fd971f;">(</span><span style="color: #eb4509;">interactive</span> <span style="color: #e2c770;">"P"</span><span style="color: #fd971f;">)</span>
    <span style="color: #fd971f;">(</span><span style="color: #eb4509;">save-excursion</span>
      <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">save-restriction</span>
  <span style="color: #eb4509;">(</span><span style="color: #b6e63e;">message-narrow-to-headers</span><span style="color: #eb4509;">)</span>
  <span style="color: #eb4509;">(</span><span style="color: #eb4509;">let</span> <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">(</span>gcc <span style="color: #eb4509;">(</span><span style="color: #fd971f;">car</span> <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">last</span>
       <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">message-unquote-tokens</span>
        <span style="color: #eb4509;">(</span><span style="color: #b6e63e;">message-tokenize-header</span>
         <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">mail-fetch-field</span> <span style="color: #e2c770;">"gcc"</span> nil t<span style="color: #fd971f;">)</span> <span style="color: #e2c770;">" ,"</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
        <span style="color: #b6e63e;">(</span>buf <span style="color: #eb4509;">(</span><span style="color: #fd971f;">current-buffer</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
        <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">message-kill-buffer-on-exit</span> nil<span style="color: #b6e63e;">)</span>
        id to from subject desc link newsgroup xarchive<span style="color: #fd971f;">)</span>
        <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">message-send-and-exit</span> arg<span style="color: #fd971f;">)</span>
        <span style="color: #fd971f;">(</span><span style="color: #eb4509;">or</span>
         <span style="color: #696969;">;; </span><span style="color: #696969;">gcc group found ...</span>
         <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">and</span> gcc
              <span style="color: #eb4509;">(</span><span style="color: #eb4509;">save-current-buffer</span>
                <span style="color: #fd971f;">(</span><span style="color: #eb4509;">progn</span> <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">set-buffer</span> buf<span style="color: #b6e63e;">)</span>
                       <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">setq</span> id <span style="color: #eb4509;">(</span><span style="color: #b6e63e;">org-remove-angle-brackets</span>
                                 <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">mail-fetch-field</span> <span style="color: #e2c770;">"Message-ID"</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
                       <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">setq</span> to <span style="color: #eb4509;">(</span><span style="color: #b6e63e;">mail-fetch-field</span> <span style="color: #e2c770;">"To"</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
                       <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">setq</span> from <span style="color: #eb4509;">(</span><span style="color: #b6e63e;">mail-fetch-field</span> <span style="color: #e2c770;">"From"</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
                       <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">setq</span> subject <span style="color: #eb4509;">(</span><span style="color: #b6e63e;">mail-fetch-field</span> <span style="color: #e2c770;">"Subject"</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
              <span style="color: #eb4509;">(</span><span style="color: #b6e63e;">org-store-link-props</span> <span style="color: #fd971f;">:type</span> <span style="color: #e2c770;">"gnus"</span> <span style="color: #fd971f;">:from</span> from <span style="color: #fd971f;">:subject</span> subject
                                    <span style="color: #fd971f;">:message-id</span> id <span style="color: #fd971f;">:group</span> gcc <span style="color: #fd971f;">:to</span> to<span style="color: #eb4509;">)</span>
              <span style="color: #eb4509;">(</span><span style="color: #eb4509;">setq</span> desc <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">org-email-link-description</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
              <span style="color: #eb4509;">(</span><span style="color: #eb4509;">setq</span> link <span style="color: #fd971f;">(</span>org-gnus-article-link
                          gcc newsgroup id xarchive<span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
              <span style="color: #eb4509;">(</span><span style="color: #eb4509;">setq</span> <span style="color: #fd971f;">org-stored-links</span>
                    <span style="color: #fd971f;">(</span><span style="color: #fd971f;">cons</span> <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">list</span> link desc<span style="color: #b6e63e;">)</span> <span style="color: #fd971f;">org-stored-links</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
         <span style="color: #696969;">;; </span><span style="color: #696969;">no gcc group found ...</span>
         <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">message</span> <span style="color: #e2c770;">"Can not create Org link: No Gcc header found."</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>

<span style="color: #eb4509;">(</span><span style="color: #fd971f;">define-key</span> <span style="color: #fd971f;">message-mode-map</span> <span style="color: #fd971f;">[</span><span style="color: #b6e63e;">(</span>control c<span style="color: #b6e63e;">)</span> <span style="color: #b6e63e;">(</span>control meta c<span style="color: #b6e63e;">)</span><span style="color: #fd971f;">]</span>
  <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">ulf-message-send-and-org-gnus-store-link</span><span style="color: #eb4509;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orga71fa75" class="outline-3">
<h3 id="orga71fa75">Link to visit a file and run occur</h3>
<div class="outline-text-3" id="text-orga71fa75">
<p>
Add the following bit of code to your startup (after loading org),
and you can then use links like <code>occur:my-file.txt#regex</code> to open a
file and run occur with the regex on it.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span style="color: #eb4509;">(</span><span style="color: #eb4509;">defun</span> <span style="color: #b6e63e;">org-occur-open</span> <span style="color: #fd971f;">(</span>uri<span style="color: #fd971f;">)</span>
    <span style="color: #7f7f80;">"Visit the file specified by URI, and run `</span><span style="color: #fd971f;">occur</span><span style="color: #7f7f80;">' on the fragment</span>
<span style="color: #7f7f80;">    </span><span style="color: #e2c770;">\</span><span style="color: #7f7f80;">(anything after the first '#') in the uri."</span>
    <span style="color: #fd971f;">(</span><span style="color: #eb4509;">let</span> <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">(</span><span style="color: #fd971f;">list</span> <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">split-string</span> uri <span style="color: #e2c770;">"#"</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
      <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">org-open-file</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">car</span> list<span style="color: #eb4509;">)</span> t<span style="color: #b6e63e;">)</span>
      <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">occur</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">mapconcat</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">identity</span> <span style="color: #fd971f;">(</span><span style="color: #fd971f;">cdr</span> list<span style="color: #fd971f;">)</span> <span style="color: #e2c770;">"#"</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
  <span style="color: #eb4509;">(</span><span style="color: #b6e63e;">org-add-link-type</span> <span style="color: #e2c770;">"occur"</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">org-occur-open</span><span style="color: #eb4509;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org7280e31" class="outline-3">
<h3 id="org7280e31">Send html messages and attachments with Wanderlust</h3>
<div class="outline-text-3" id="text-org7280e31">
<p>
&#x2013; David Maus
</p>

<p>
<i>Note</i>: The module <a href="org-contrib/org-mime.html">Org-mime</a> in Org&rsquo;s contrib directory provides
similar functionality for both Wanderlust and Gnus.  The hack below is
still somewhat different: It allows you to toggle sending of html
messages within Wanderlust transparently.  I.e. html markup of the
message body is created right before sending starts.
</p>
</div>

<div id="outline-container-orgae7c088" class="outline-4">
<h4 id="orgae7c088">Send HTML message</h4>
<div class="outline-text-4" id="text-orgae7c088">
<p>
Putting the code below in your .emacs adds following four functions:
</p>

<ul class="org-ul">
<li><p>
dmj/wl-send-html-message
</p>

<p>
Function that does the job: Convert everything between &ldquo;&#x2013;text
follows this line&#x2013;&rdquo; and first mime entity (read: attachment) or
end of buffer into html markup using `org-export-region-as-html&rsquo;
and replaces original body with a multipart MIME entity with the
plain text version of body and the html markup version.  Thus a
recipient that prefers html messages can see the html markup,
recipients that prefer or depend on plain text can see the plain
text.
</p>

<p>
Cannot be called interactively: It is hooked into SEMI&rsquo;s
`mime-edit-translate-hook&rsquo; if message should be HTML message.
</p></li>

<li><p>
dmj/wl-send-html-message-draft-init
</p>

<p>
Cannot be called interactively: It is hooked into WL&rsquo;s
`wl-mail-setup-hook&rsquo; and provides a buffer local variable to
toggle.
</p></li>

<li><p>
dmj/wl-send-html-message-draft-maybe
</p>

<p>
Cannot be called interactively: It is hooked into WL&rsquo;s
`wl-draft-send-hook&rsquo; and hooks `dmj/wl-send-html-message&rsquo; into
`mime-edit-translate-hook&rsquo; depending on whether HTML message is
toggled on or off
</p></li>

<li><p>
dmj/wl-send-html-message-toggle
</p>

<p>
Toggles sending of HTML message.  If toggled on, the letters
&ldquo;HTML&rdquo; appear in the mode line.
</p>

<p>
Call it interactively!  Or bind it to a key in `wl-draft-mode&rsquo;.
</p></li>
</ul>

<p>
If you have to send HTML messages regularly you can set a global
variable `dmj/wl-send-html-message-toggled-p&rsquo; to the string &ldquo;HTML&rdquo; to
toggle on sending HTML message by default.
</p>

<p>
The image <a href="http://s11.directupload.net/file/u/15851/48ru5wl3.png">here</a> shows an example of how the HTML message looks like in
Google&rsquo;s web front end.  As you can see you have the whole markup of
Org at your service: <b>bold</b>, <i>italics</i>, tables, lists&#x2026;
</p>

<p>
So even if you feel uncomfortable with sending HTML messages at least
you send HTML that looks quite good.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #eb4509;">(</span><span style="color: #eb4509;">defun</span> <span style="color: #b6e63e;">dmj/wl-send-html-message</span> <span style="color: #fd971f;">()</span>
  <span style="color: #7f7f80;">"Send message as html message.</span>
<span style="color: #7f7f80;">Convert body of message to html using</span>
<span style="color: #7f7f80;">  `</span><span style="color: #fd971f;">org-export-region-as-html</span><span style="color: #7f7f80;">'."</span>
  <span style="color: #fd971f;">(</span><span style="color: #fd971f;">require</span> <span style="color: #9c91e4;">'</span><span style="color: #fd971f;">org</span><span style="color: #fd971f;">)</span>
  <span style="color: #fd971f;">(</span><span style="color: #eb4509;">save-excursion</span>
    <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">let</span> <span style="color: #eb4509;">(</span>beg end html text<span style="color: #eb4509;">)</span>
      <span style="color: #eb4509;">(</span><span style="color: #fd971f;">goto-char</span> <span style="color: #fd971f;">(</span><span style="color: #fd971f;">point-min</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
      <span style="color: #eb4509;">(</span><span style="color: #fd971f;">re-search-forward</span> <span style="color: #e2c770;">"^--text follows this line--$"</span><span style="color: #eb4509;">)</span>
      <span style="color: #696969;">;; </span><span style="color: #696969;">move to beginning of next line</span>
      <span style="color: #eb4509;">(</span><span style="color: #fd971f;">beginning-of-line</span> <span style="color: #9c91e4; font-weight: bold;">2</span><span style="color: #eb4509;">)</span>
      <span style="color: #eb4509;">(</span><span style="color: #eb4509;">setq</span> beg <span style="color: #fd971f;">(</span><span style="color: #fd971f;">point</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
      <span style="color: #eb4509;">(</span><span style="color: #eb4509;">if</span> <span style="color: #fd971f;">(</span><span style="color: #fd971f;">not</span> <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">re-search-forward</span> <span style="color: #e2c770;">"^--\\[\\["</span> nil t<span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>
          <span style="color: #fd971f;">(</span><span style="color: #eb4509;">setq</span> end <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">point-max</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>
        <span style="color: #696969;">;; </span><span style="color: #696969;">line up</span>
        <span style="color: #fd971f;">(</span><span style="color: #fd971f;">end-of-line</span> <span style="color: #9c91e4; font-weight: bold;">0</span><span style="color: #fd971f;">)</span>
        <span style="color: #fd971f;">(</span><span style="color: #eb4509;">setq</span> end <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">point</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
      <span style="color: #696969;">;; </span><span style="color: #696969;">grab body</span>
      <span style="color: #eb4509;">(</span><span style="color: #eb4509;">setq</span> text <span style="color: #fd971f;">(</span><span style="color: #fd971f;">buffer-substring-no-properties</span> beg end<span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
      <span style="color: #696969;">;; </span><span style="color: #696969;">convert to html</span>
      <span style="color: #eb4509;">(</span><span style="color: #eb4509;">with-temp-buffer</span>
        <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">org-mode</span><span style="color: #fd971f;">)</span>
        <span style="color: #fd971f;">(</span><span style="color: #fd971f;">insert</span> text<span style="color: #fd971f;">)</span>
        <span style="color: #696969;">;; </span><span style="color: #696969;">handle signature</span>
        <span style="color: #fd971f;">(</span><span style="color: #eb4509;">when</span> <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">re-search-backward</span> <span style="color: #e2c770;">"^-- \n"</span> nil t<span style="color: #b6e63e;">)</span>
          <span style="color: #696969;">;; </span><span style="color: #696969;">preserve link breaks in signature</span>
          <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">insert</span> <span style="color: #e2c770;">"\n#+BEGIN_VERSE\n"</span><span style="color: #b6e63e;">)</span>
          <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">goto-char</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">point-max</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
          <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">insert</span> <span style="color: #e2c770;">"\n#+END_VERSE\n"</span><span style="color: #b6e63e;">)</span>
          <span style="color: #696969;">;; </span><span style="color: #696969;">grab html</span>
          <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">setq</span> html <span style="color: #eb4509;">(</span>org-export-region-as-html
                      <span style="color: #fd971f;">(</span><span style="color: #fd971f;">point-min</span><span style="color: #fd971f;">)</span> <span style="color: #fd971f;">(</span><span style="color: #fd971f;">point-max</span><span style="color: #fd971f;">)</span> t <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">string</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
      <span style="color: #eb4509;">(</span><span style="color: #fd971f;">delete-region</span> beg end<span style="color: #eb4509;">)</span>
      <span style="color: #eb4509;">(</span><span style="color: #fd971f;">insert</span>
       <span style="color: #fd971f;">(</span><span style="color: #fd971f;">concat</span>
        <span style="color: #e2c770;">"--"</span> <span style="color: #e2c770;">"&lt;&lt;alternative&gt;&gt;-{\n"</span>
        <span style="color: #e2c770;">"--"</span> <span style="color: #e2c770;">"[[text/plain]]\n"</span> text
        <span style="color: #e2c770;">"--"</span> <span style="color: #e2c770;">"[[text/html]]\n"</span>  html
        <span style="color: #e2c770;">"--"</span> <span style="color: #e2c770;">"}-&lt;&lt;alternative&gt;&gt;\n"</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>

<span style="color: #eb4509;">(</span><span style="color: #eb4509;">defun</span> <span style="color: #b6e63e;">dmj/wl-send-html-message-toggle</span> <span style="color: #fd971f;">()</span>
  <span style="color: #7f7f80;">"Toggle sending of html message."</span>
  <span style="color: #fd971f;">(</span><span style="color: #eb4509;">interactive</span><span style="color: #fd971f;">)</span>
  <span style="color: #fd971f;">(</span><span style="color: #eb4509;">setq</span> dmj/wl-send-html-message-toggled-p
        <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">if</span> dmj/wl-send-html-message-toggled-p
            nil <span style="color: #e2c770;">"HTML"</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>
  <span style="color: #fd971f;">(</span><span style="color: #fd971f;">message</span> <span style="color: #e2c770;">"Sending html message toggled %s"</span>
           <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">if</span> dmj/wl-send-html-message-toggled-p
               <span style="color: #e2c770;">"on"</span> <span style="color: #e2c770;">"off"</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>

<span style="color: #eb4509;">(</span><span style="color: #eb4509;">defun</span> <span style="color: #b6e63e;">dmj/wl-send-html-message-draft-init</span> <span style="color: #fd971f;">()</span>
  <span style="color: #7f7f80;">"Create buffer local settings for maybe sending html message."</span>
  <span style="color: #fd971f;">(</span><span style="color: #eb4509;">unless</span> <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">boundp</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">dmj/wl-send-html-message-toggled-p</span><span style="color: #b6e63e;">)</span>
    <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">setq</span> dmj/wl-send-html-message-toggled-p nil<span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>
  <span style="color: #fd971f;">(</span><span style="color: #fd971f;">make-variable-buffer-local</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">dmj/wl-send-html-message-toggled-p</span><span style="color: #fd971f;">)</span>
  <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">add-to-list</span> <span style="color: #9c91e4;">'</span><span style="color: #fd971f;">global-mode-string</span>
               <span style="color: #9c91e4;">'</span><span style="color: #b6e63e;">(</span><span style="color: #fd971f;">:eval</span> <span style="color: #eb4509;">(</span><span style="color: #eb4509;">if</span> <span style="color: #fd971f;">(</span><span style="color: #fd971f;">eq</span> <span style="color: #fd971f;">major-mode</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">wl-draft-mode</span><span style="color: #fd971f;">)</span>
                           dmj/wl-send-html-message-toggled-p<span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>

<span style="color: #eb4509;">(</span><span style="color: #eb4509;">defun</span> <span style="color: #b6e63e;">dmj/wl-send-html-message-maybe</span> <span style="color: #fd971f;">()</span>
  <span style="color: #7f7f80;">"Maybe send this message as html message.</span>

<span style="color: #7f7f80;">If buffer local variable `</span><span style="color: #fd971f;">dmj/wl-send-html-message-toggled-p</span><span style="color: #7f7f80;">' is</span>
<span style="color: #7f7f80;">non-nil, add `</span><span style="color: #fd971f;">dmj/wl-send-html-message</span><span style="color: #7f7f80;">' to</span>
<span style="color: #7f7f80;">`</span><span style="color: #fd971f;">mime-edit-translate-hook</span><span style="color: #7f7f80;">'."</span>
  <span style="color: #fd971f;">(</span><span style="color: #eb4509;">if</span> dmj/wl-send-html-message-toggled-p
      <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">add-hook</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">mime-edit-translate-hook</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">dmj/wl-send-html-message</span><span style="color: #b6e63e;">)</span>
    <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">remove-hook</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">mime-edit-translate-hook</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">dmj/wl-send-html-message</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>

<span style="color: #eb4509;">(</span><span style="color: #b6e63e;">add-hook</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">wl-draft-reedit-hook</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">dmj/wl-send-html-message-draft-init</span><span style="color: #eb4509;">)</span>
<span style="color: #eb4509;">(</span><span style="color: #b6e63e;">add-hook</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">wl-mail-setup-hook</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">dmj/wl-send-html-message-draft-init</span><span style="color: #eb4509;">)</span>
<span style="color: #eb4509;">(</span><span style="color: #b6e63e;">add-hook</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">wl-draft-send-hook</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">dmj/wl-send-html-message-maybe</span><span style="color: #eb4509;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org77b37de" class="outline-4">
<h4 id="org77b37de">Attach HTML of region or subtree</h4>
<div class="outline-text-4" id="text-org77b37de">
<p>
Instead of sending a complete HTML message you might only send parts
of an Org file as HTML for the poor souls who are plagued with
non-proportional fonts in their mail program that messes up pretty
ASCII tables.
</p>

<p>
This short function does the trick: It exports region or subtree to
HTML, prefixes it with a MIME entity delimiter and pushes to killring
and clipboard.  If a region is active, it uses the region, the
complete subtree otherwise.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #eb4509;">(</span><span style="color: #eb4509;">defun</span> <span style="color: #b6e63e;">dmj/org-export-region-as-html-attachment</span> <span style="color: #fd971f;">(</span>beg end arg<span style="color: #fd971f;">)</span>
  <span style="color: #7f7f80;">"Export region between BEG and END as html attachment.</span>
<span style="color: #7f7f80;">If BEG and END are not set, use current subtree.  Region or</span>
<span style="color: #7f7f80;">subtree is exported to html without header and footer, prefixed</span>
<span style="color: #7f7f80;">with a mime entity string and pushed to clipboard and killring.</span>
<span style="color: #7f7f80;">When called with prefix, mime entity is not marked as</span>
<span style="color: #7f7f80;">attachment."</span>
  <span style="color: #fd971f;">(</span><span style="color: #eb4509;">interactive</span> <span style="color: #e2c770;">"r\nP"</span><span style="color: #fd971f;">)</span>
  <span style="color: #fd971f;">(</span><span style="color: #eb4509;">save-excursion</span>
    <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">let*</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">(</span>beg <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">if</span> <span style="color: #eb4509;">(</span><span style="color: #b6e63e;">region-active-p</span><span style="color: #eb4509;">)</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">region-beginning</span><span style="color: #eb4509;">)</span>
                  <span style="color: #eb4509;">(</span><span style="color: #eb4509;">progn</span>
                    <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">org-back-to-heading</span><span style="color: #fd971f;">)</span>
                    <span style="color: #fd971f;">(</span><span style="color: #fd971f;">point</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>
           <span style="color: #fd971f;">(</span>end <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">if</span> <span style="color: #eb4509;">(</span><span style="color: #b6e63e;">region-active-p</span><span style="color: #eb4509;">)</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">region-end</span><span style="color: #eb4509;">)</span>
                  <span style="color: #eb4509;">(</span><span style="color: #eb4509;">progn</span>
                    <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">org-end-of-subtree</span><span style="color: #fd971f;">)</span>
                    <span style="color: #fd971f;">(</span><span style="color: #fd971f;">point</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>
           <span style="color: #fd971f;">(</span>html <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">concat</span> <span style="color: #e2c770;">"--[[text/html"</span>
                         <span style="color: #eb4509;">(</span><span style="color: #eb4509;">if</span> arg <span style="color: #e2c770;">""</span> <span style="color: #e2c770;">"\nContent-Disposition: attachment"</span><span style="color: #eb4509;">)</span>
                         <span style="color: #e2c770;">"]]\n"</span>
                         <span style="color: #eb4509;">(</span>org-export-region-as-html beg end t <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">string</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
      <span style="color: #eb4509;">(</span><span style="color: #eb4509;">when</span> <span style="color: #fd971f;">(</span><span style="color: #fd971f;">fboundp</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">x-set-selection</span><span style="color: #fd971f;">)</span>
        <span style="color: #fd971f;">(</span><span style="color: #eb4509;">ignore-errors</span> <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">x-set-selection</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">PRIMARY</span> html<span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>
        <span style="color: #fd971f;">(</span><span style="color: #eb4509;">ignore-errors</span> <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">x-set-selection</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">CLIPBOARD</span> html<span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
      <span style="color: #eb4509;">(</span><span style="color: #fd971f;">message</span> <span style="color: #e2c770;">"html export done, pushed to kill ring and clipboard"</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orga8b485d" class="outline-4">
<h4 id="orga8b485d">Adopting for Gnus</h4>
<div class="outline-text-4" id="text-orga8b485d">
<p>
The whole magic lies in the special strings that mark a HTML
attachment.  So you might just have to find out what these special
strings are in message-mode and modify the functions accordingly.
</p>
</div>
</div>
</div>
<div id="outline-container-orgc676383" class="outline-3">
<h3 id="orgc676383">Add sunrise/sunset times to the agenda.</h3>
<div class="outline-text-3" id="text-orgc676383">
<p>
&#x2013; Nick Dokos
</p>

<p>
The diary package provides the function <code>diary-sunrise-sunset</code> which can be used
in a diary s-expression in some agenda file like this:
</p>

<div class="org-src-container">
<pre class="src src-org"><span style="color: #d6d6d4;">%%(diary-sunrise-sunset)</span>
</pre>
</div>

<p>
Seb Vauban asked if it is possible to put sunrise and sunset in
separate lines. Here is a hack to do that. It adds two functions (they
have to be available before the agenda is shown, so I add them early
in my org-config file which is sourced from .emacs, but you&rsquo;ll have to
suit yourself here) that just parse the output of
diary-sunrise-sunset, instead of doing the right thing which would be
to take advantage of the data structures that diary/solar.el provides.
In short, a hack - so perfectly suited for inclusion here :-)
</p>

<p>
The functions (and latitude/longitude settings which you have to modify for
your location) are as follows:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #eb4509;">(</span><span style="color: #eb4509;">setq</span> calendar-latitude <span style="color: #9c91e4; font-weight: bold;">48.2</span><span style="color: #eb4509;">)</span>
<span style="color: #eb4509;">(</span><span style="color: #eb4509;">setq</span> calendar-longitude <span style="color: #9c91e4; font-weight: bold;">16.4</span><span style="color: #eb4509;">)</span>
<span style="color: #eb4509;">(</span><span style="color: #eb4509;">setq</span> calendar-location-name <span style="color: #e2c770;">"Vienna, Austria"</span><span style="color: #eb4509;">)</span>

<span style="color: #eb4509;">(</span><span style="color: #fd971f;">autoload</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">solar-sunrise-sunset</span> <span style="color: #e2c770;">"solar.el"</span><span style="color: #eb4509;">)</span>
<span style="color: #eb4509;">(</span><span style="color: #fd971f;">autoload</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">solar-time-string</span> <span style="color: #e2c770;">"solar.el"</span><span style="color: #eb4509;">)</span>
<span style="color: #eb4509;">(</span><span style="color: #eb4509;">defun</span> <span style="color: #b6e63e;">diary-sunrise</span> <span style="color: #fd971f;">()</span>
  <span style="color: #7f7f80;">"Local time of sunrise as a diary entry.</span>
<span style="color: #7f7f80;">The diary entry can contain `</span><span style="color: #fd971f;">%s</span><span style="color: #7f7f80;">' which will be replaced with</span>
<span style="color: #7f7f80;">`</span><span style="color: #fd971f;">calendar-location-name</span><span style="color: #7f7f80;">'."</span>
  <span style="color: #fd971f;">(</span><span style="color: #eb4509;">let</span> <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">(</span>l <span style="color: #fd971f;">(</span>solar-sunrise-sunset date<span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
    <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">when</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">car</span> l<span style="color: #eb4509;">)</span>
      <span style="color: #eb4509;">(</span><span style="color: #fd971f;">concat</span>
       <span style="color: #fd971f;">(</span><span style="color: #eb4509;">if</span> <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">string=</span> entry <span style="color: #e2c770;">""</span><span style="color: #b6e63e;">)</span>
           <span style="color: #e2c770;">"Sunrise"</span>
         <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">format</span> entry <span style="color: #eb4509;">(</span><span style="color: #fd971f;">eval</span> calendar-location-name<span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span> <span style="color: #e2c770;">" "</span>
         <span style="color: #fd971f;">(</span>solar-time-string <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">caar</span> l<span style="color: #b6e63e;">)</span> nil<span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>

<span style="color: #eb4509;">(</span><span style="color: #eb4509;">defun</span> <span style="color: #b6e63e;">diary-sunset</span> <span style="color: #fd971f;">()</span>
  <span style="color: #7f7f80;">"Local time of sunset as a diary entry.</span>
<span style="color: #7f7f80;">The diary entry can contain `</span><span style="color: #fd971f;">%s</span><span style="color: #7f7f80;">' which will be replaced with</span>
<span style="color: #7f7f80;">`</span><span style="color: #fd971f;">calendar-location-name</span><span style="color: #7f7f80;">'."</span>
  <span style="color: #fd971f;">(</span><span style="color: #eb4509;">let</span> <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">(</span>l <span style="color: #fd971f;">(</span>solar-sunrise-sunset date<span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
    <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">when</span> <span style="color: #eb4509;">(</span><span style="color: #b6e63e;">cadr</span> l<span style="color: #eb4509;">)</span>
      <span style="color: #eb4509;">(</span><span style="color: #fd971f;">concat</span>
       <span style="color: #fd971f;">(</span><span style="color: #eb4509;">if</span> <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">string=</span> entry <span style="color: #e2c770;">""</span><span style="color: #b6e63e;">)</span>
           <span style="color: #e2c770;">"Sunset"</span>
         <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">format</span> entry <span style="color: #eb4509;">(</span><span style="color: #fd971f;">eval</span> calendar-location-name<span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span> <span style="color: #e2c770;">" "</span>
         <span style="color: #fd971f;">(</span>solar-time-string <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">caadr</span> l<span style="color: #b6e63e;">)</span> nil<span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
</pre>
</div>

<p>
You also need to add a couple of diary s-expressions in one of your agenda
files:
</p>

<div class="org-src-container">
<pre class="src src-org"><span style="color: #d6d6d4;">%%(diary-sunrise)Sunrise in %s</span>
<span style="color: #d6d6d4;">%%(diary-sunset)</span>
</pre>
</div>

<p>
This will show sunrise with the location and sunset without it.
</p>

<p>
The thread on the mailing list that started this can be found <a href="https://orgmode.org/list/87oc5rlwc4.wl%lists@700c.org">here</a>.
In comparison to the version posted on the mailing list, this one
gets rid of the timezone information and can show the location.
</p>
</div>
</div>
<div id="outline-container-orge997dee" class="outline-3">
<h3 id="orge997dee">Add lunar phases to the agenda.</h3>
<div class="outline-text-3" id="text-orge997dee">
<p>
&#x2013; Rdiger
</p>

<p>
Emacs comes with <code>lunar.el</code> to display the lunar phases (<code>M-x lunar-phases</code>).
This can be used to display lunar phases in the agenda display with the
following function:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #eb4509;">(</span><span style="color: #fd971f;">require</span> <span style="color: #9c91e4;">'</span><span style="color: #fd971f;">cl-lib</span><span style="color: #eb4509;">)</span>

<span style="color: #eb4509;">(</span><span style="color: #b6e63e;">org-no-warnings</span> <span style="color: #fd971f;">(</span><span style="color: #eb4509;">defvar</span> <span style="color: #fd971f;">date</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
<span style="color: #eb4509;">(</span><span style="color: #eb4509;">defun</span> <span style="color: #b6e63e;">org-lunar-phases</span> <span style="color: #fd971f;">()</span>
  <span style="color: #7f7f80;">"Show lunar phase in Agenda buffer."</span>
  <span style="color: #fd971f;">(</span><span style="color: #fd971f;">require</span> <span style="color: #9c91e4;">'</span><span style="color: #fd971f;">lunar</span><span style="color: #fd971f;">)</span>
  <span style="color: #fd971f;">(</span><span style="color: #eb4509;">let*</span> <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">(</span>phase-list <span style="color: #fd971f;">(</span>lunar-phase-list <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">nth</span> <span style="color: #9c91e4; font-weight: bold;">0</span> date<span style="color: #b6e63e;">)</span> <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">nth</span> <span style="color: #9c91e4; font-weight: bold;">2</span> date<span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
         <span style="color: #eb4509;">(</span>phase <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">cl-find-if</span> <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">lambda</span> <span style="color: #eb4509;">(</span>phase<span style="color: #eb4509;">)</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">equal</span> <span style="color: #fd971f;">(</span><span style="color: #fd971f;">car</span> phase<span style="color: #fd971f;">)</span> date<span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
                            phase-list<span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
    <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">when</span> phase
      <span style="color: #eb4509;">(</span><span style="color: #eb4509;">setq</span> ret <span style="color: #fd971f;">(</span><span style="color: #fd971f;">concat</span> <span style="color: #b6e63e;">(</span>lunar-phase-name <span style="color: #eb4509;">(</span><span style="color: #fd971f;">nth</span> <span style="color: #9c91e4; font-weight: bold;">2</span> phase<span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span> <span style="color: #e2c770;">" "</span>
                        <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">substring</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">nth</span> <span style="color: #9c91e4; font-weight: bold;">1</span> phase<span style="color: #eb4509;">)</span> <span style="color: #9c91e4; font-weight: bold;">0</span> <span style="color: #9c91e4; font-weight: bold;">5</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
</pre>
</div>

<p>
Add the following line to an agenda file:
</p>

<div class="org-src-container">
<pre class="src src-org"><span style="color: #eb4509; font-weight: bold;">*</span><span style="color: #eb4509; font-weight: bold;"> Lunar phase</span>
<span style="color: #7f7f80;">#+CATEGORY: Lunar</span>
<span style="color: #d6d6d4;">%%(org-lunar-phases)</span>
</pre>
</div>

<p>
This should display an entry on new moon, first/last quarter moon, and on full
moon.  You can customize the entries by customizing <code>lunar-phase-names</code>.
</p>

<p>
E.g., to add Unicode symbols:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #eb4509;">(</span><span style="color: #eb4509;">setq</span> lunar-phase-names
      <span style="color: #9c91e4;">'</span><span style="color: #fd971f;">(</span><span style="color: #e2c770;">"&#9679; New Moon"</span> <span style="color: #696969;">; </span><span style="color: #696969;">Unicode symbol: &#127761; Use full circle as fallback</span>
        <span style="color: #e2c770;">"&#9789; First Quarter Moon"</span>
        <span style="color: #e2c770;">"&#9675; Full Moon"</span> <span style="color: #696969;">; </span><span style="color: #696969;">Unicode symbol: &#127765; Use empty circle as fallback</span>
        <span style="color: #e2c770;">"&#9790; Last Quarter Moon"</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
</pre>
</div>

<p>
Unicode 6 even provides symbols for the Moon with nice faces.  But those
symbols are currently barely supported in fonts.
See <a href="https://en.wikipedia.org/wiki/Astronomical_symbols#Moon">Astronomical symbols on Wikipedia</a>.
</p>
</div>
</div>

<div id="outline-container-org423998a" class="outline-3">
<h3 id="org423998a">Export BBDB contacts to org-contacts.el</h3>
<div class="outline-text-3" id="text-org423998a">
<p>
Try this tool by Wes Hardaker:
</p>

<p>
<a href="http://www.hardakers.net/code/bbdb-to-org-contacts/">http://www.hardakers.net/code/bbdb-to-org-contacts/</a>
</p>
</div>
</div>

<div id="outline-container-org7d74c0f" class="outline-3">
<h3 id="org7d74c0f">Calculating date differences - how to write a simple elisp function</h3>
<div class="outline-text-3" id="text-org7d74c0f">
<p>
Alexander Wingrd asked how to calculate the number of days between a
time stamp in his org file and today (see
<a href="https://orgmode.org/list/064758C1-8D27-4647-A3C2-AB35FB8C6215@gmail.com">https://orgmode.org/list/064758C1-8D27-4647-A3C2-AB35FB8C6215@gmail.com</a>  Although the
resulting answer is probably not of general interest, the method might
be useful to a budding Elisp programmer.
</p>

<p>
Alexander started from an already existing org function,
<code>org-evaluate-time-range</code>.  When this function is called in the context
of a time range (two time stamps separated by &ldquo;<code>--</code>&rdquo;), it calculates the
number of days between the two dates and outputs the result in Emacs&rsquo;s
echo area. What he wanted was a similar function that, when called from
the context of a single time stamp, would calculate the number of days
between the date in the time stamp and today. The result should go to
the same place: Emacs&rsquo;s echo area.
</p>

<p>
The solution presented in the mail thread is as follows:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #eb4509;">(</span><span style="color: #eb4509;">defun</span> <span style="color: #b6e63e;">aw/org-evaluate-time-range</span> <span style="color: #fd971f;">(</span><span style="color: #66d9ef;">&amp;optional</span> to-buffer<span style="color: #fd971f;">)</span>
  <span style="color: #fd971f;">(</span><span style="color: #eb4509;">interactive</span><span style="color: #fd971f;">)</span>
  <span style="color: #fd971f;">(</span><span style="color: #eb4509;">if</span> <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">org-at-date-range-p</span> t<span style="color: #b6e63e;">)</span>
      <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">org-evaluate-time-range</span> to-buffer<span style="color: #b6e63e;">)</span>
    <span style="color: #696969;">;; </span><span style="color: #696969;">otherwise, make a time range in a temp buffer and run o-e-t-r there</span>
    <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">let</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">(</span>headline <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">buffer-substring</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">point-at-bol</span><span style="color: #eb4509;">)</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">point-at-eol</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
      <span style="color: #eb4509;">(</span><span style="color: #eb4509;">with-temp-buffer</span>
  <span style="color: #fd971f;">(</span><span style="color: #fd971f;">insert</span> headline<span style="color: #fd971f;">)</span>
  <span style="color: #fd971f;">(</span><span style="color: #fd971f;">goto-char</span> <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">point-at-bol</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>
  <span style="color: #fd971f;">(</span><span style="color: #fd971f;">re-search-forward</span> <span style="color: #fd971f;">org-ts-regexp</span> <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">point-at-eol</span><span style="color: #b6e63e;">)</span> t<span style="color: #fd971f;">)</span>
  <span style="color: #fd971f;">(</span><span style="color: #eb4509;">if</span> <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">not</span> <span style="color: #eb4509;">(</span><span style="color: #b6e63e;">org-at-timestamp-p</span> t<span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
      <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">error</span> <span style="color: #e2c770;">"No timestamp here"</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>
  <span style="color: #fd971f;">(</span><span style="color: #fd971f;">goto-char</span> <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">match-beginning</span> <span style="color: #9c91e4; font-weight: bold;">0</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>
  <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">org-insert-time-stamp</span> <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">current-time</span><span style="color: #b6e63e;">)</span> nil nil<span style="color: #fd971f;">)</span>
  <span style="color: #fd971f;">(</span><span style="color: #fd971f;">insert</span> <span style="color: #e2c770;">"--"</span><span style="color: #fd971f;">)</span>
  <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">org-evaluate-time-range</span> to-buffer<span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
</pre>
</div>

<p>
The function assumes that point is on some line with some time stamp
(or a date range) in it. Note that <code>org-evaluate-time-range</code> does not care
whether the first date is earlier than the second: it will always output
the number of days between the earlier date and the later date.
</p>

<p>
As stated before, the function itself is of limited interest (although
it satisfied Alexander&rsquo;s need).The <b>method</b> used might be of wider
interest however, so here is a short explanation.
</p>

<p>
The idea is that we want <code>org-evaluate-time-range</code> to do all the
heavy lifting, but that function requires that it be in a date-range
context. So the function first checks whether it&rsquo;s in a date range
context already: if so, it calls <code>org-evaluate-time-range</code> directly
to do the work. The trick now is to arrange things so we can call this
same function in the case where we do <b>not</b> have a date range
context. In that case, we manufacture one: we create a temporary
buffer, copy the line with the purported time stamp to the temp
buffer, find the time stamp (signal an error if no time stamp is
found) and insert a new time stamp with the current time before the
existing time stamp, followed by &ldquo;<code>--</code>&rdquo;: voil, we now have a time range
on which we can apply our old friend <code>org-evaluate-time-range</code> to
produce the answer. Because of the above-mentioned property
of <code>org-evaluate-time-range</code>, it does not matter if the existing
time stamp is earlier or later than the current time: the correct
number of days is output.
</p>

<p>
Note that at the end of the call to <code>with-temp-buffer</code>, the temporary
buffer goes away.  It was just used as a scratch pad for the function
to do some figuring.
</p>

<p>
The idea of using a temp buffer as a scratch pad has wide
applicability in Emacs programming. The rest of the work is knowing
enough about facilities provided by Emacs (e.g. regexp searching) and
by Org (e.g. checking for time stamps and generating a time stamp) so
that you don&rsquo;t reinvent the wheel, and impedance-matching between the
various pieces.
</p>
</div>
</div>

<div id="outline-container-org68f7629" class="outline-3">
<h3 id="org68f7629">ibuffer and org files</h3>
<div class="outline-text-3" id="text-org68f7629">
<p>
Neil Smithline posted this snippet to let you browse org files with
<code>ibuffer</code>:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #eb4509;">(</span><span style="color: #fd971f;">require</span> <span style="color: #9c91e4;">'</span><span style="color: #fd971f;">ibuffer</span><span style="color: #eb4509;">)</span>

<span style="color: #eb4509;">(</span><span style="color: #eb4509;">defun</span> <span style="color: #b6e63e;">org-ibuffer</span> <span style="color: #fd971f;">()</span>
  <span style="color: #7f7f80;">"Open an `</span><span style="color: #fd971f;">ibuffer</span><span style="color: #7f7f80;">' window showing only `</span><span style="color: #fd971f;">org-mode</span><span style="color: #7f7f80;">' buffers."</span>
  <span style="color: #fd971f;">(</span><span style="color: #eb4509;">interactive</span><span style="color: #fd971f;">)</span>
  <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">ibuffer</span> nil <span style="color: #e2c770;">"*Org Buffers*"</span> <span style="color: #9c91e4;">'</span><span style="color: #b6e63e;">(</span><span style="color: #eb4509;">(</span>used-mode . org-mode<span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org2b7c01c" class="outline-3">
<h3 id="org2b7c01c">Enable org-mode links in other modes</h3>
<div class="outline-text-3" id="text-org2b7c01c">
<p>
Sean O&rsquo;Halpin wrote a minor mode for this, please check it <a href="https://github.com/seanohalpin/org-link-minor-mode">here</a>.
</p>

<p>
See the relevant discussion <a href="https://orgmode.org/list/CAOXM+eX-xkGu4B8c=9RLQ+959Sn050wtqSHO2fqhFQX4X5c53A@mail.gmail.com">here</a>.
</p>
</div>
</div>

<div id="outline-container-org793a6c0" class="outline-3">
<h3 id="org793a6c0">poporg.el: edit comments in org-mode</h3>
<div class="outline-text-3" id="text-org793a6c0">
<p>
<a href="https://github.com/QBobWatson/poporg/blob/master/poporg.el">poporg.el</a> is a library by Franois Pinard which lets you edit comments
and strings from your code using a separate org-mode buffer.
</p>
</div>
</div>

<div id="outline-container-orgea3c04b" class="outline-3">
<h3 id="orgea3c04b">Convert a .csv file to an Org-mode table</h3>
<div class="outline-text-3" id="text-orgea3c04b">
<p>
Nicolas Richard has a <a href="https://orgmode.org/list/87a9rpy1x2.fsf@yahoo.fr">nice recipe</a> using the pcsv library (<a href="http://marmalade-repo.org/packages/pcsv">available</a> from
the Marmelade ELPA repository):
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #eb4509;">(</span><span style="color: #eb4509;">defun</span> <span style="color: #b6e63e;">yf/lisp-table-to-org-table</span> <span style="color: #fd971f;">(</span>table <span style="color: #66d9ef;">&amp;optional</span> function<span style="color: #fd971f;">)</span>
  <span style="color: #7f7f80;">"Convert a lisp table to `</span><span style="color: #fd971f;">org-mode</span><span style="color: #7f7f80;">' syntax, applying FUNCTION to each of its elements.</span>
<span style="color: #7f7f80;">The elements should not have any more newlines in them after</span>
<span style="color: #7f7f80;">applying FUNCTION ; the default converts them to spaces. Return</span>
<span style="color: #7f7f80;">value is a string containg the unaligned `</span><span style="color: #fd971f;">org-mode</span><span style="color: #7f7f80;">' table."</span>
  <span style="color: #fd971f;">(</span><span style="color: #eb4509;">unless</span> <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">functionp</span> function<span style="color: #b6e63e;">)</span>
    <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">setq</span> function <span style="color: #eb4509;">(</span><span style="color: #eb4509;">lambda</span> <span style="color: #fd971f;">(</span>x<span style="color: #fd971f;">)</span> <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">replace-regexp-in-string</span> <span style="color: #e2c770;">"\n"</span> <span style="color: #e2c770;">" "</span> x<span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>
  <span style="color: #fd971f;">(</span><span style="color: #fd971f;">mapconcat</span> <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">lambda</span> <span style="color: #eb4509;">(</span>x<span style="color: #eb4509;">)</span>                <span style="color: #696969;">; </span><span style="color: #696969;">x is a line.</span>
               <span style="color: #eb4509;">(</span><span style="color: #fd971f;">concat</span> <span style="color: #e2c770;">"| "</span> <span style="color: #fd971f;">(</span><span style="color: #fd971f;">mapconcat</span> function x <span style="color: #e2c770;">" | "</span><span style="color: #fd971f;">)</span> <span style="color: #e2c770;">" |"</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
             table <span style="color: #e2c770;">"\n"</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>

<span style="color: #eb4509;">(</span><span style="color: #eb4509;">defun</span> <span style="color: #b6e63e;">yf/csv-to-table</span> <span style="color: #fd971f;">(</span>beg end<span style="color: #fd971f;">)</span>
<span style="color: #7f7f80;">"Convert a csv file to an `</span><span style="color: #fd971f;">org-mode</span><span style="color: #7f7f80;">' table."</span>
  <span style="color: #fd971f;">(</span><span style="color: #eb4509;">interactive</span> <span style="color: #e2c770;">"r"</span><span style="color: #fd971f;">)</span>
  <span style="color: #fd971f;">(</span><span style="color: #fd971f;">require</span> <span style="color: #9c91e4;">'</span><span style="color: #fd971f;">pcsv</span><span style="color: #fd971f;">)</span>
  <span style="color: #fd971f;">(</span><span style="color: #fd971f;">insert</span> <span style="color: #b6e63e;">(</span>yf/lisp-table-to-org-table <span style="color: #eb4509;">(</span>pcsv-parse-region beg end<span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>
  <span style="color: #fd971f;">(</span><span style="color: #fd971f;">delete-region</span> beg end<span style="color: #fd971f;">)</span>
  <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">org-table-align</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org743f2ac" class="outline-3">
<h3 id="org743f2ac">Don&rsquo;t let visual-line-mode shadow org special commands</h3>
<div class="outline-text-3" id="text-org743f2ac">
<p>
<code>M-x visual-line-mode RET</code> will use <code>beginning-of-visual-line</code>,
<code>end-of-visual-line</code>, and <code>kill-visual-line</code> instead of
<code>org-beginning-of-line</code>, <code>org-end-of-line</code>, and <code>org-kill-line</code>, while 
those might be preferred in an Org buffer.
</p>

<p>
To avoid this, you can use this hack:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #eb4509;">(</span><span style="color: #b6e63e;">add-hook</span> <span style="color: #9c91e4;">'</span><span style="color: #fd971f;">visual-line-mode-hook</span>
          <span style="color: #fd971f;">(</span><span style="color: #eb4509;">lambda</span> <span style="color: #b6e63e;">()</span> <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">when</span> <span style="color: #eb4509;">(</span><span style="color: #b6e63e;">derived-mode-p</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">org-mode</span><span style="color: #eb4509;">)</span>
                       <span style="color: #eb4509;">(</span><span style="color: #b6e63e;">local-set-key</span> <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">kbd</span> <span style="color: #e2c770;">"C-a"</span><span style="color: #fd971f;">)</span> <span style="color: #9c91e4;">#'</span><span style="color: #66d9ef;">org-beginning-of-line</span><span style="color: #eb4509;">)</span>
                       <span style="color: #eb4509;">(</span><span style="color: #b6e63e;">local-set-key</span> <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">kbd</span> <span style="color: #e2c770;">"C-e"</span><span style="color: #fd971f;">)</span> <span style="color: #9c91e4;">#'</span><span style="color: #66d9ef;">org-end-of-line</span><span style="color: #eb4509;">)</span>
                       <span style="color: #eb4509;">(</span><span style="color: #b6e63e;">local-set-key</span> <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">kbd</span> <span style="color: #e2c770;">"C-k"</span><span style="color: #fd971f;">)</span> <span style="color: #9c91e4;">#'</span><span style="color: #66d9ef;">org-kill-line</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
</pre>
</div>

<p>
See <a href="https://orgmode.org/list/87zh7jfyal.fsf@gmail.com/">this discussion</a>.
</p>
</div>
</div>

<div id="outline-container-org879688d" class="outline-3">
<h3 id="org879688d">foldout.el</h3>
<div class="outline-text-3" id="text-org879688d">
<p>
<code>foldout.el</code>, which is part of Emacs, is a nice little companion for
<code>outline-mode</code>.  With <code>foldout.el</code> one can narrow to a subtree and
later unnarrow.  <code>foldout.el</code> is useful for Org mode out of the box.
</p>

<p>
There is one annoyance though (at least for me):
<code>foldout-zoom-subtree</code> opens the drawers.
</p>

<p>
This can be fixed e.g. by using the following slightly modified
version of <code>foldout-zoom-subtree</code> which uses function <code>org-show-entry</code>
instead of <code>outline-show-entry</code>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #eb4509;">(</span><span style="color: #eb4509;">defun</span> <span style="color: #b6e63e;">foldout-zoom-org-subtree</span> <span style="color: #fd971f;">(</span><span style="color: #66d9ef;">&amp;optional</span> exposure<span style="color: #fd971f;">)</span>
  <span style="color: #7f7f80;">"Same as `</span><span style="color: #fd971f;">foldout-zoom-subtree</span><span style="color: #7f7f80;">' with often nicer zoom in Org mode."</span>
  <span style="color: #fd971f;">(</span><span style="color: #eb4509;">interactive</span> <span style="color: #e2c770;">"P"</span><span style="color: #fd971f;">)</span>
  <span style="color: #fd971f;">(</span><span style="color: #eb4509;">cl-letf</span>
      <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">(</span><span style="color: #fd971f;">(</span><span style="color: #fd971f;">symbol-function</span> <span style="color: #9c91e4;">#'</span><span style="color: #66d9ef;">outline-show-entry</span><span style="color: #fd971f;">)</span> <span style="color: #fd971f;">(</span><span style="color: #eb4509;">lambda</span> <span style="color: #b6e63e;">()</span> <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">org-show-entry</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
    <span style="color: #b6e63e;">(</span>foldout-zoom-subtree exposure<span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org2caff77" class="outline-3">
<h3 id="org2caff77">Integrate Org Capture with YASnippet and Yankpad</h3>
<div class="outline-text-3" id="text-org2caff77">
<p>
Org Capture allows you to quickly store a note. You can mix the Org
Capture template system with those of <a href="https://github.com/joaotavora/yasnippet">YASnippet</a> and <a href="https://github.com/Kungsgeten/yankpad">Yankpad</a>.
</p>

<p>
Check out the repository for how to do it: <a href="https://github.com/ag91/ya-org-capture">https://github.com/ag91/ya-org-capture</a>.
</p>

<p>
A screencast that show the hack in action is <a href="https://github.com/ag91/ya-org-capture/blob/master/ya-org-capture-screehcast.gif">here</a>. And a blog post
describing this in more detail is <a href="https://ag91.github.io/blog/2020/07/28/how-to-integrate-yasnippet-and-yankpad-with-org-capture/">here</a>.
</p>
</div>
</div>

<div id="outline-container-org9139190" class="outline-3">
<h3 id="org9139190">Slack messages as TODOs in your Org Agenda</h3>
<div class="outline-text-3" id="text-org9139190">
<p>
Too many Slack messages reach you? Keep track of them in your Org
Agenda! With this hack you can mix the power of the <a href="https://github.com/yuya373/emacs-slack">Emacs Slack</a> client
and the order of Org mode.
</p>

<p>
Try this by running the code at:
<a href="https://github.com/ag91/emacs-slack-org-mode-example">https://github.com/ag91/emacs-slack-org-mode-example</a>
</p>

<p>
Also a blog post that describes in detail how this works is <a href="https://ag91.github.io/blog/2020/08/14/slack-messages-in-your-org-agenda/">here</a>.
</p>
</div>
</div>
</div>

<div id="outline-container-orgb8db2e9" class="outline-2">
<h2 id="orgb8db2e9">Hacking Org: Working with Org-mode and External Programs</h2>
<div class="outline-text-2" id="text-orgb8db2e9">
</div>
<div id="outline-container-org1da93de" class="outline-3">
<h3 id="org1da93de">Use Org-mode with Screen [Andrew Hyatt]</h3>
<div class="outline-text-3" id="text-org1da93de">
<p>
&ldquo;The general idea is that you start a task in which all the work will
take place in a shell.  This usually is not a leaf-task for me, but
usually the parent of a leaf task.  From a task in your org-file, M-x
ash-org-screen will prompt for the name of a session.  Give it a name,
and it will insert a link.  Open the link at any time to go the screen
session containing your work!&rdquo;
</p>

<p>
<a href="https://orgmode.org/list/c8389b600801271541h4c68e70du589547ea5e8bd52f@mail.gmail.com">https://orgmode.org/list/c8389b600801271541h4c68e70du589547ea5e8bd52f@mail.gmail.com</a>
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #eb4509;">(</span><span style="color: #fd971f;">require</span> <span style="color: #9c91e4;">'</span><span style="color: #fd971f;">term</span><span style="color: #eb4509;">)</span>

<span style="color: #eb4509;">(</span><span style="color: #eb4509;">defun</span> <span style="color: #b6e63e;">ash-org-goto-screen</span> <span style="color: #fd971f;">(</span>name<span style="color: #fd971f;">)</span>
  <span style="color: #7f7f80;">"Open the screen with the specified name in the window"</span>
  <span style="color: #fd971f;">(</span><span style="color: #eb4509;">interactive</span> <span style="color: #e2c770;">"MScreen name: "</span><span style="color: #fd971f;">)</span>
  <span style="color: #fd971f;">(</span><span style="color: #eb4509;">let</span> <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">(</span>screen-buffer-name <span style="color: #fd971f;">(</span>ash-org-screen-buffer-name name<span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
    <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">if</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">member</span> screen-buffer-name
                <span style="color: #fd971f;">(</span><span style="color: #fd971f;">mapcar</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">buffer-name</span> <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">buffer-list</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
        <span style="color: #eb4509;">(</span><span style="color: #b6e63e;">switch-to-buffer</span> screen-buffer-name<span style="color: #eb4509;">)</span>
      <span style="color: #eb4509;">(</span><span style="color: #b6e63e;">switch-to-buffer</span> <span style="color: #fd971f;">(</span>ash-org-screen-helper name <span style="color: #e2c770;">"-dr"</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>

<span style="color: #eb4509;">(</span><span style="color: #eb4509;">defun</span> <span style="color: #b6e63e;">ash-org-screen-buffer-name</span> <span style="color: #fd971f;">(</span>name<span style="color: #fd971f;">)</span>
  <span style="color: #7f7f80;">"Returns the buffer name corresponding to the screen name given."</span>
  <span style="color: #fd971f;">(</span><span style="color: #fd971f;">concat</span> <span style="color: #e2c770;">"*screen "</span> name <span style="color: #e2c770;">"*"</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>

<span style="color: #eb4509;">(</span><span style="color: #eb4509;">defun</span> <span style="color: #b6e63e;">ash-org-screen-helper</span> <span style="color: #fd971f;">(</span>name arg<span style="color: #fd971f;">)</span>
  <span style="color: #696969;">;; </span><span style="color: #696969;">Pick the name of the new buffer.</span>
  <span style="color: #fd971f;">(</span><span style="color: #eb4509;">let</span> <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">(</span><span style="color: #fd971f;">term-ansi-buffer-name</span>
   <span style="color: #fd971f;">(</span><span style="color: #fd971f;">generate-new-buffer-name</span>
    <span style="color: #b6e63e;">(</span>ash-org-screen-buffer-name name<span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
    <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">setq</span> <span style="color: #fd971f;">term-ansi-buffer-name</span>
          <span style="color: #eb4509;">(</span><span style="color: #b6e63e;">term-ansi-make-term</span>
     <span style="color: #fd971f;">term-ansi-buffer-name</span> <span style="color: #e2c770;">"/usr/bin/screen"</span> nil arg name<span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
    <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">set-buffer</span> <span style="color: #fd971f;">term-ansi-buffer-name</span><span style="color: #b6e63e;">)</span>
    <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">term-mode</span><span style="color: #b6e63e;">)</span>
    <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">term-char-mode</span><span style="color: #b6e63e;">)</span>
    <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">term-set-escape-char</span> ?\C-x<span style="color: #b6e63e;">)</span>
    <span style="color: #fd971f;">term-ansi-buffer-name</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>

<span style="color: #eb4509;">(</span><span style="color: #eb4509;">defun</span> <span style="color: #b6e63e;">ash-org-screen</span> <span style="color: #fd971f;">(</span>name<span style="color: #fd971f;">)</span>
  <span style="color: #7f7f80;">"Start a screen session with name"</span>
  <span style="color: #fd971f;">(</span><span style="color: #eb4509;">interactive</span> <span style="color: #e2c770;">"MScreen name: "</span><span style="color: #fd971f;">)</span>
  <span style="color: #fd971f;">(</span><span style="color: #eb4509;">save-excursion</span>
    <span style="color: #b6e63e;">(</span>ash-org-screen-helper name <span style="color: #e2c770;">"-S"</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>
  <span style="color: #fd971f;">(</span>insert-string <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">concat</span> <span style="color: #e2c770;">"[[screen:"</span> name <span style="color: #e2c770;">"]]"</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>

<span style="color: #696969;">;; </span><span style="color: #696969;">And don't forget to add ("screen" . "elisp:(ash-org-goto-screen</span>
<span style="color: #696969;">;; </span><span style="color: #696969;">\"%s\")") to org-link-abbrev-alist.</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org-agenda-appt-zenity" class="outline-3">
<h3 id="org-agenda-appt-zenity">Org Agenda + Appt + Zenity</h3>
<div class="outline-text-3" id="text-org-agenda-appt-zenity">
<a name="agenda-appt-zenity"></a>
<p>
Russell Adams posted this setup <a href="https://orgmode.org/list/20080302101346.GB18852@odin.demosthenes.org">on the list</a>.  It makes sure your agenda
appointments are known by Emacs, and it displays warnings in a <a href="http://live.gnome.org/Zenity">zenity</a>
popup window.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #696969;">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
<span style="color: #696969;">; </span><span style="color: #696969;">For org appointment reminders</span>

<span style="color: #696969;">;; </span><span style="color: #696969;">Get appointments for today</span>
<span style="color: #eb4509;">(</span><span style="color: #eb4509;">defun</span> <span style="color: #b6e63e;">my-org-agenda-to-appt</span> <span style="color: #fd971f;">()</span>
  <span style="color: #fd971f;">(</span><span style="color: #eb4509;">interactive</span><span style="color: #fd971f;">)</span>
  <span style="color: #fd971f;">(</span><span style="color: #eb4509;">setq</span> appt-time-msg-list nil<span style="color: #fd971f;">)</span>
  <span style="color: #fd971f;">(</span><span style="color: #eb4509;">let</span> <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">(</span><span style="color: #fd971f;">org-deadline-warning-days</span> <span style="color: #9c91e4; font-weight: bold;">0</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>    <span style="color: #696969;">;; </span><span style="color: #696969;">will be automatic in org 5.23</span>
        <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">org-agenda-to-appt</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>

<span style="color: #696969;">;; </span><span style="color: #696969;">Run once, activate and schedule refresh</span>
<span style="color: #eb4509;">(</span>my-org-agenda-to-appt<span style="color: #eb4509;">)</span>
<span style="color: #eb4509;">(</span><span style="color: #b6e63e;">appt-activate</span> t<span style="color: #eb4509;">)</span>
<span style="color: #eb4509;">(</span><span style="color: #b6e63e;">run-at-time</span> <span style="color: #e2c770;">"24:01"</span> nil <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">my-org-agenda-to-appt</span><span style="color: #eb4509;">)</span>

<span style="color: #696969;">; </span><span style="color: #696969;">5 minute warnings</span>
<span style="color: #eb4509;">(</span><span style="color: #eb4509;">setq</span> appt-message-warning-time <span style="color: #9c91e4; font-weight: bold;">15</span><span style="color: #eb4509;">)</span>
<span style="color: #eb4509;">(</span><span style="color: #eb4509;">setq</span> appt-display-interval <span style="color: #9c91e4; font-weight: bold;">5</span><span style="color: #eb4509;">)</span>

<span style="color: #696969;">; </span><span style="color: #696969;">Update appt each time agenda opened.</span>
<span style="color: #eb4509;">(</span><span style="color: #b6e63e;">add-hook</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">org-finalize-agenda-hook</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">my-org-agenda-to-appt</span><span style="color: #eb4509;">)</span>

<span style="color: #696969;">; </span><span style="color: #696969;">Setup zenify, we tell appt to use window, and replace default function</span>
<span style="color: #eb4509;">(</span><span style="color: #eb4509;">setq</span> appt-display-format <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">window</span><span style="color: #eb4509;">)</span>
<span style="color: #eb4509;">(</span><span style="color: #eb4509;">setq</span> appt-disp-window-function <span style="color: #fd971f;">(</span><span style="color: #eb4509;">function</span> my-appt-disp-window<span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>

<span style="color: #eb4509;">(</span><span style="color: #eb4509;">defun</span> <span style="color: #b6e63e;">my-appt-disp-window</span> <span style="color: #fd971f;">(</span>min-to-app new-time msg<span style="color: #fd971f;">)</span>
  <span style="color: #fd971f;">(</span><span style="color: #eb4509;">save-window-excursion</span> <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">shell-command</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">concat</span>
    <span style="color: #e2c770;">"/usr/bin/zenity --info --title='Appointment' --text='"</span>
    msg <span style="color: #e2c770;">"' &amp;"</span><span style="color: #eb4509;">)</span> <span style="color: #e2c770;">nil nil</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org020bac9" class="outline-3">
<h3 id="org020bac9">Org and appointment notifications on Mac OS 10.8</h3>
<div class="outline-text-3" id="text-org020bac9">
<p>
Sarah Bagby <a href="http://mid.gmane.org/EA76104A-9ACD-4141-8D33-2E4D810D9B5A@geol.ucsb.edu">posted some code</a> on how to get appointments notifications on
Mac OS 10.8 with <a href="https://github.com/alloy/terminal-notifier">terminal-notifier</a>.
</p>
</div>
</div>

<div id="outline-container-orgfa3d353" class="outline-3">
<h3 id="orgfa3d353">Org-Mode + gnome-osd</h3>
<div class="outline-text-3" id="text-orgfa3d353">
<p>
Richard Riley uses gnome-osd in interaction with Org-Mode to display
appointments.  You can look at the code on the <a href="http://www.emacswiki.org/emacs-en/OrgMode-OSD">emacswiki</a>.
</p>
</div>
</div>

<div id="outline-container-org6fd1bd6" class="outline-3">
<h3 id="org6fd1bd6">txt2org convert text data to org-mode tables</h3>
<div class="outline-text-3" id="text-org6fd1bd6">
<p>
From Eric Schulte
</p>

<p>
I often find it useful to generate Org-mode tables on the command line
from tab-separated data.  The following awk script makes this easy to
do.  Text data is read from STDIN on a pipe and any command line
arguments are interpreted as rows at which to insert hlines.
</p>

<p>
Here are two usage examples.
</p>
<ol class="org-ol">
<li><p>
running the following
</p>
<pre class="example">
$ cat &lt;&lt;EOF|~/src/config/bin/txt2org
one 1
two 2
three 3
twenty 20
EOF
</pre>

<p>
results in
</p>
<pre class="example">
|    one |  1 |
|    two |  2 |
|  three |  3 |
| twenty | 20 |
</pre></li>

<li><p>
and the following (notice the command line argument)
</p>
<pre class="example">
$ cat &lt;&lt;EOF|~/src/config/bin/txt2org 1
strings numbers
one 1
two 2
three 3
twenty 20
EOF
</pre>

<p>
results in
</p>
<pre class="example">
| strings | numbers |
|---------+---------|
|     one |       1 |
|     two |       2 |
|   three |       3 |
|  twenty |      20 |
</pre></li>
</ol>

<p>
Here is the script itself
</p>
<div class="org-src-container">
<pre class="src src-awk">  <span style="color: #696969;">#</span><span style="color: #696969;">!/usr/bin/gawk -f</span>
  <span style="color: #696969;">#</span>
  <span style="color: #696969;"># </span><span style="color: #696969;">Read tab separated data from STDIN and output an Org-mode table.</span>
  <span style="color: #696969;">#</span>
  <span style="color: #696969;"># </span><span style="color: #696969;">Optional command line arguments specify row numbers at which to</span>
  <span style="color: #696969;"># </span><span style="color: #696969;">insert hlines.</span>
  <span style="color: #696969;">#</span>
  <span style="color: #eb4509;">BEGIN</span> <span style="color: #eb4509;">{</span>
      <span style="color: #eb4509;">for</span><span style="color: #fd971f;">(</span>i=<span style="color: #9c91e4; font-weight: bold;">1</span>; i&lt;<span style="color: #fd971f;">ARGC</span>; i++<span style="color: #fd971f;">){</span>
          hlines<span style="color: #b6e63e;">[</span><span style="color: #fd971f;">ARGV</span><span style="color: #eb4509;">[</span>i<span style="color: #eb4509;">]</span>+<span style="color: #9c91e4; font-weight: bold;">1</span><span style="color: #b6e63e;">]</span>=<span style="color: #9c91e4; font-weight: bold;">1</span>; <span style="color: #fd971f;">ARGV</span><span style="color: #b6e63e;">[</span>i<span style="color: #b6e63e;">]</span> = <span style="color: #e2c770;">"-"</span>; <span style="color: #fd971f;">}</span> <span style="color: #eb4509;">}</span>

  <span style="color: #eb4509;">{</span>
      <span style="color: #eb4509;">if</span><span style="color: #fd971f;">(</span><span style="color: #fd971f;">NF</span> &gt; max_nf<span style="color: #fd971f;">){</span> max_nf = <span style="color: #fd971f;">NF</span>; <span style="color: #fd971f;">}</span>;
      <span style="color: #eb4509;">for</span><span style="color: #fd971f;">(</span>f=<span style="color: #9c91e4; font-weight: bold;">1</span>; f&lt;=<span style="color: #fd971f;">NF</span>; f++<span style="color: #fd971f;">){</span>
          <span style="color: #eb4509;">if</span><span style="color: #b6e63e;">(</span><span style="color: #9c91e4; font-weight: bold;">length</span><span style="color: #eb4509;">(</span>$f<span style="color: #eb4509;">)</span> &gt; lengths<span style="color: #eb4509;">[</span>f<span style="color: #eb4509;">]</span><span style="color: #b6e63e;">){</span> lengths<span style="color: #eb4509;">[</span>f<span style="color: #eb4509;">]</span> = <span style="color: #9c91e4; font-weight: bold;">length</span><span style="color: #eb4509;">(</span>$f<span style="color: #eb4509;">)</span>; <span style="color: #b6e63e;">}</span>;
          row<span style="color: #b6e63e;">[</span><span style="color: #fd971f;">NR</span><span style="color: #b6e63e;">][</span>f<span style="color: #b6e63e;">]</span>=$f; <span style="color: #fd971f;">}</span> <span style="color: #eb4509;">}</span>

  <span style="color: #eb4509;">END</span> <span style="color: #eb4509;">{</span>
      hline_str=<span style="color: #e2c770;">"|"</span>
      <span style="color: #eb4509;">for</span><span style="color: #fd971f;">(</span>f=<span style="color: #9c91e4; font-weight: bold;">1</span>; f&lt;=max_nf; f++<span style="color: #fd971f;">){</span>
          <span style="color: #eb4509;">for</span><span style="color: #b6e63e;">(</span>i=<span style="color: #9c91e4; font-weight: bold;">0</span>; i&lt;<span style="color: #eb4509;">(</span>lengths<span style="color: #fd971f;">[</span>f<span style="color: #fd971f;">]</span> + <span style="color: #9c91e4; font-weight: bold;">2</span><span style="color: #eb4509;">)</span>; i++<span style="color: #b6e63e;">){</span> hline_str=hline_str <span style="color: #e2c770;">"-"</span>; <span style="color: #b6e63e;">}</span>
          <span style="color: #eb4509;">if</span><span style="color: #b6e63e;">(</span> f != max_nf<span style="color: #b6e63e;">){</span> hline_str=hline_str <span style="color: #e2c770;">"+"</span>; <span style="color: #b6e63e;">}</span>
          <span style="color: #eb4509;">else</span>            <span style="color: #b6e63e;">{</span> hline_str=hline_str <span style="color: #e2c770;">"|"</span>; <span style="color: #b6e63e;">}</span> <span style="color: #fd971f;">}</span>

      <span style="color: #eb4509;">for</span><span style="color: #fd971f;">(</span>r=<span style="color: #9c91e4; font-weight: bold;">1</span>; r&lt;=<span style="color: #fd971f;">NR</span>; r++<span style="color: #fd971f;">){</span> <span style="color: #696969;"># </span><span style="color: #696969;">rows</span>
          <span style="color: #eb4509;">if</span><span style="color: #b6e63e;">(</span>hlines<span style="color: #eb4509;">[</span>r<span style="color: #eb4509;">]</span> == <span style="color: #9c91e4; font-weight: bold;">1</span><span style="color: #b6e63e;">){</span> <span style="color: #9c91e4; font-weight: bold;">print</span> hline_str; <span style="color: #b6e63e;">}</span>
          <span style="color: #9c91e4; font-weight: bold;">printf</span> <span style="color: #e2c770;">"|"</span>;
          <span style="color: #eb4509;">for</span><span style="color: #b6e63e;">(</span>f=<span style="color: #9c91e4; font-weight: bold;">1</span>; f&lt;=max_nf; f++<span style="color: #b6e63e;">){</span> <span style="color: #696969;"># </span><span style="color: #696969;">columns</span>
              cell=row<span style="color: #eb4509;">[</span>r<span style="color: #eb4509;">][</span>f<span style="color: #eb4509;">]</span>; padding=<span style="color: #e2c770;">""</span>
              <span style="color: #eb4509;">for</span><span style="color: #eb4509;">(</span>i=<span style="color: #9c91e4; font-weight: bold;">0</span>; i&lt;<span style="color: #fd971f;">(</span>lengths<span style="color: #b6e63e;">[</span>f<span style="color: #b6e63e;">]</span> - <span style="color: #9c91e4; font-weight: bold;">length</span><span style="color: #b6e63e;">(</span>cell<span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>; i++<span style="color: #eb4509;">){</span> padding=padding <span style="color: #e2c770;">" "</span>; <span style="color: #eb4509;">}</span>
              <span style="color: #696969;"># </span><span style="color: #696969;">for now just print everything right-aligned</span>
              <span style="color: #696969;"># </span><span style="color: #696969;">if(cell ~ /[0-9.]/){ printf " %s%s |", cell, padding; }</span>
              <span style="color: #696969;"># </span><span style="color: #696969;">else{                printf " %s%s |", padding, cell; }</span>
              <span style="color: #9c91e4; font-weight: bold;">printf</span> <span style="color: #e2c770;">" %s%s |"</span>, padding, cell; <span style="color: #b6e63e;">}</span>
          <span style="color: #9c91e4; font-weight: bold;">printf</span> <span style="color: #e2c770;">"\n"</span>; <span style="color: #fd971f;">}</span>

      <span style="color: #eb4509;">if</span><span style="color: #fd971f;">(</span>hlines<span style="color: #b6e63e;">[</span><span style="color: #fd971f;">NR</span>+<span style="color: #9c91e4; font-weight: bold;">1</span><span style="color: #b6e63e;">]</span><span style="color: #fd971f;">){</span> <span style="color: #9c91e4; font-weight: bold;">print</span> hline_str; <span style="color: #fd971f;">}</span> <span style="color: #eb4509;">}</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgd1e1775" class="outline-3">
<h3 id="orgd1e1775">remind2org</h3>
<div class="outline-text-3" id="text-orgd1e1775">
<p>
From Detlef Steuer
</p>

<p>
<a href="https://orgmode.org/list/20080112175502.0fb06b66@linux.site">https://orgmode.org/list/20080112175502.0fb06b66@linux.site</a>
</p>

<blockquote>
<p>
Remind (<a href="http://www.roaringpenguin.com/products/remind">http://www.roaringpenguin.com/products/remind</a>) is a very powerful
command line calendaring program. Its features supersede the possibilities
of orgmode in the area of date specifying, so that I want to use it
combined with orgmode.
</p>

<p>
Using the script below I&rsquo;m able use remind and incorporate its output in my
agenda views.  The default of using 13 months look ahead is easily
changed. It just happens I sometimes like to look a year into the
future. :-)
</p>
</blockquote>
</div>
</div>

<div id="outline-container-orgf8cacd4" class="outline-3">
<h3 id="orgf8cacd4">Useful webjumps for conkeror</h3>
<div class="outline-text-3" id="text-orgf8cacd4">
<p>
If you are using the <a href="http://conkeror.org">conkeror browser</a>, maybe you want to put this into
your <code>~/.conkerorrc</code> file:
</p>

<pre class="example">
define_webjump("orglist", "http://search.gmane.org/?query=%s&amp;group=gmane.emacs.orgmode");
define_webjump("worg", "http://www.google.com/cse?cx=002987994228320350715%3Az4glpcrritm&amp;ie=UTF-8&amp;q=%s&amp;sa=Search&amp;siteurl=orgmode.org%2Fworg%2F");
</pre>

<p>
It creates two <a href="http://conkeror.org/Webjumps">webjumps</a> for easily searching the Worg website and the
Org-mode mailing list.
</p>
</div>
</div>

<div id="outline-container-org1f94fcc" class="outline-3">
<h3 id="org1f94fcc">Use MathJax for HTML export without requiring JavaScript</h3>
<div class="outline-text-3" id="text-org1f94fcc">
<p>
As of 2010-08-14, MathJax is the default method used to export math to HTML.
</p>

<p>
If you like the results but do not want JavaScript in the exported pages,
check out <a href="http://www.jboecker.de/2010/08/15/staticmathjax.html">Static MathJax</a>, a XULRunner application which generates a static
HTML file from the exported version. It can also embed all referenced fonts
within the HTML file itself, so there are no dependencies to external files.
</p>

<p>
The download archive contains an elisp file which integrates it into the Org
export process (configurable per file with a &ldquo;#+StaticMathJax:&rdquo; line).
</p>

<p>
Read README.org and the comments in org-static-mathjax.el for usage instructions.
</p>
</div>
</div>

<div id="outline-container-orgdda3c11" class="outline-3">
<h3 id="orgdda3c11">Use checkboxes and progress cookies in HTML generated from Org</h3>
<div class="outline-text-3" id="text-orgdda3c11">
<p>
If you want to have dynamically-updated progress cookies for lists
with checkboxes in an HTML document exported from Org, <a href="https://lists.gnu.org/archive/html/emacs-orgmode/2020-06/msg00323.html">this mailing
list thread</a> contains a (partial) Javascript solution.
</p>

<p>
Note that the Javascript depends on the default HTML structure
generated by Org at the time (the maint branch somewhere between 9.3
and 9.4), so the code won&rsquo;t work without modification if you customize
HTML output or if Org&rsquo;s default HTML export changes.
</p>
</div>
</div>

<div id="outline-container-org74c85c8" class="outline-3">
<h3 id="org74c85c8">Search Org files using lgrep</h3>
<div class="outline-text-3" id="text-org74c85c8">
<p>
Matt Lundin suggests this:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span style="color: #eb4509;">(</span><span style="color: #eb4509;">defun</span> <span style="color: #b6e63e;">my-org-grep</span> <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">search</span> <span style="color: #66d9ef;">&amp;optional</span> context<span style="color: #fd971f;">)</span>
    <span style="color: #7f7f80;">"Search for word in org files.</span>

<span style="color: #7f7f80;">Prefix argument determines number of lines."</span>
    <span style="color: #fd971f;">(</span><span style="color: #eb4509;">interactive</span> <span style="color: #e2c770;">"sSearch for: \nP"</span><span style="color: #fd971f;">)</span>
    <span style="color: #fd971f;">(</span><span style="color: #eb4509;">let</span> <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">(</span><span style="color: #fd971f;">grep-find-ignored-files</span> <span style="color: #9c91e4;">'</span><span style="color: #fd971f;">(</span><span style="color: #e2c770;">"#*"</span> <span style="color: #e2c770;">".#*"</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
    <span style="color: #eb4509;">(</span><span style="color: #fd971f;">grep-template</span> <span style="color: #fd971f;">(</span><span style="color: #fd971f;">concat</span> <span style="color: #e2c770;">"grep &lt;X&gt; -i -nH "</span>
         <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">when</span> context
           <span style="color: #eb4509;">(</span><span style="color: #fd971f;">concat</span> <span style="color: #e2c770;">"-C"</span> <span style="color: #fd971f;">(</span><span style="color: #fd971f;">number-to-string</span> context<span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
         <span style="color: #e2c770;">" -e &lt;R&gt; &lt;F&gt;"</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
      <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">lgrep</span> search <span style="color: #e2c770;">"*org*"</span> <span style="color: #e2c770;">"/home/matt/org/"</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>

  <span style="color: #eb4509;">(</span><span style="color: #b6e63e;">global-set-key</span> <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">kbd</span> <span style="color: #e2c770;">"&lt;f8&gt;"</span><span style="color: #fd971f;">)</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">my-org-grep</span><span style="color: #eb4509;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgf1ff98d" class="outline-3">
<h3 id="orgf1ff98d">Automatic screenshot insertion</h3>
<div class="outline-text-3" id="text-orgf1ff98d">
<p>
Suggested by Russell Adams
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span style="color: #eb4509;">(</span><span style="color: #eb4509;">defun</span> <span style="color: #b6e63e;">my-org-screenshot</span> <span style="color: #fd971f;">()</span>
    <span style="color: #7f7f80;">"Take a screenshot into a time stamped unique-named file in the</span>
<span style="color: #7f7f80;">  same directory as the org-buffer and insert a link to this file."</span>
    <span style="color: #fd971f;">(</span><span style="color: #eb4509;">interactive</span><span style="color: #fd971f;">)</span>
    <span style="color: #fd971f;">(</span><span style="color: #eb4509;">setq</span> filename
          <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">concat</span>
           <span style="color: #eb4509;">(</span><span style="color: #fd971f;">make-temp-name</span>
            <span style="color: #fd971f;">(</span><span style="color: #fd971f;">concat</span> <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">buffer-file-name</span><span style="color: #b6e63e;">)</span>
                    <span style="color: #e2c770;">"_"</span>
                    <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">format-time-string</span> <span style="color: #e2c770;">"%Y%m%d_%H%M%S_"</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span> <span style="color: #eb4509;">)</span> <span style="color: #e2c770;">".png"</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>
    <span style="color: #fd971f;">(</span><span style="color: #fd971f;">call-process</span> <span style="color: #e2c770;">"import"</span> nil nil nil filename<span style="color: #fd971f;">)</span>
    <span style="color: #fd971f;">(</span><span style="color: #fd971f;">insert</span> <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">concat</span> <span style="color: #e2c770;">"[["</span> filename <span style="color: #e2c770;">"]]"</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>
    <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">org-display-inline-images</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org9747b62" class="outline-3">
<h3 id="org9747b62">Capture invitations/appointments from MS Exchange emails</h3>
<div class="outline-text-3" id="text-org9747b62">
<p>
Dirk-Jan C.Binnema <a href="https://orgmode.org/list/20100718104515.4C21039C72A@djcbsoftware.nl">provided</a> code to do this.  Please check
<a href="code/elisp/org-exchange-capture.el">org-exchange-capture.el</a>
</p>
</div>
</div>

<div id="outline-container-org38ad37e" class="outline-3">
<h3 id="org38ad37e">Audio/video file playback within org mode</h3>
<div class="outline-text-3" id="text-org38ad37e">
<p>
Paul Sexton provided code that makes <code>file:</code> links to audio or video files
(MP3, WAV, OGG, AVI, MPG, et cetera) play those files using the <a href="https://github.com/dbrock/bongo">Bongo</a> Emacs
media player library. The user can pause, skip forward and backward in the
track, and so on from without leaving Emacs. Links can also contain a time
after a double colon &#x2013; when this is present, playback will begin at that
position in the track.
</p>

<p>
See the file <a href="code/elisp/org-player.el">org-player.el</a>
</p>
</div>
</div>

<div id="outline-container-orgdae4a73" class="outline-3">
<h3 id="orgdae4a73">Under X11 Keep a window with the current agenda items at all time</h3>
<div class="outline-text-3" id="text-orgdae4a73">
<p>
I struggle to keep (in emacs) a window with the agenda at all times.
For a long time I have wanted a sticky window that keeps this
information, and then use my window manager to place it and remove its
decorations (I can also force its placement in the stack: top always,
for example).
</p>

<p>
I wrote a small program in qt that simply monitors an HTML file and
displays it. Nothing more. It does the work for me, and maybe somebody
else will find it useful. It relies on exporting the agenda as HTML
every time the org file is saved, and then this little program
displays the html file. The window manager is responsible of removing
decorations, making it sticky, and placing it in same place always.
</p>

<p>
Here is a screenshot (see window to the bottom right). The decorations
are removed by the window manager:
</p>


<div class="figure">
<p><img src="http://turingmachine.org/hacking/org-mode/orgdisplay.png" alt="orgdisplay.png" />
</p>
</div>

<p>
Here is the code. As I said, very, very simple, but maybe somebody will
find if useful.
</p>

<p>
<a href="http://turingmachine.org/hacking/org-mode/">http://turingmachine.org/hacking/org-mode/</a>
</p>

<p>
&#x2013;daniel german
</p>
</div>
</div>

<div id="outline-container-org3f66225" class="outline-3">
<h3 id="org3f66225">Script (thru procmail) to output emails to an Org file</h3>
<div class="outline-text-3" id="text-org3f66225">
<p>
Tycho Garen sent <a href="http://comments.gmane.org/gmane.emacs.orgmode/44773">this</a>:
</p>

<pre class="example">
I've [...] created some procmail and shell glue that takes emails and
inserts them into an org-file so that I can capture stuff on the go using
the email program.
</pre>


<p>
Everything is documented <a href="http://tychoish.com/code/org-mail/">here</a>.
</p>
</div>
</div>

<div id="outline-container-fileconversion" class="outline-3">
<h3 id="fileconversion">Save File With Different Format for Headings (fileconversion)</h3>
<div class="outline-text-3" id="text-fileconversion">
<p>
Using hooks and on the fly
</p>
<ul class="org-ul">
<li>When writing a buffer to the file: Replace the leading stars from
headings with a file char.</li>
<li>When reading a file into the buffer: Replace the file chars with
leading stars for headings.</li>
</ul>

<p>
To change the file format just add or remove the keyword in the
<code>#+STARTUP:</code> line in the Org buffer and save.
</p>

<p>
Now you can also change to Fundamental mode to see how the file looks
like on the level of the file, can go back to Org mode, reenter Org
mode or change to any other major mode and the conversion gets done
whenever necessary.
</p>
</div>

<div id="outline-container-hidestarsfile" class="outline-4">
<h4 id="hidestarsfile">Headings Without Leading Stars (hidestarsfile and nbspstarsfile)</h4>
<div class="outline-text-4" id="text-hidestarsfile">
<p>
This is like &ldquo;a cleaner outline view&rdquo;:
<a href="https://orgmode.org/manual/Clean-view.html">https://orgmode.org/manual/Clean-view.html</a>
</p>

<p>
Example of the <b>file content</b> first with leading stars as usual and
below without leading stars through <code>#+STARTUP: odd hidestars
hidestarsfile</code>:
</p>

<div class="org-src-container">
<pre class="src src-org"><span style="color: #7f7f80;">  #+STARTUP: odd hidestars</span>
  [...]
  <span style="font-weight: bold;">***</span> TODO section
  <span style="font-weight: bold;">*****</span> subsection
  <span style="font-weight: bold;">*******</span> subsubsec
            <span style="color: #e2c770;">-</span> bla bla
  <span style="font-weight: bold;">***</span> section
        <span style="color: #e2c770;">-</span> bla bla
  <span style="font-weight: bold;">*****</span> subsection
</pre>
</div>

<div class="org-src-container">
<pre class="src src-org"><span style="color: #7f7f80;">  #+STARTUP: odd hidestars hidestarsfile</span>
  [...]
      * TODO section
        * subsection
          * subsubsec
            <span style="color: #e2c770;">-</span> bla bla
      * section
        <span style="color: #e2c770;">-</span> bla bla
        * subsection
</pre>
</div>

<p>
The latter is convenient for better human readability when an Org file,
additionally to Emacs, is read with a file viewer or, for smaller edits,
with an editor not capable of the Org file format.
</p>

<p>
<code>hidestarsfile</code> is a hack and can not become part of the Org core:
</p>
<ul class="org-ul">
<li>An Org file with <code>hidestarsfile</code> can not contain list items with a
star as bullet due to the syntax conflict at read time. Mark
E. Shoulson suggested to use the non-breaking space which is now
implemented in fileconversion as <code>nbspstarsfile</code> as an alternative
for <code>hidestarsfile</code>. Although I don&rsquo;t recommend it because an editor
like typically e. g. Emacs may render the non-breaking space
differently from the space <code>0x20</code>.</li>
<li>An Org file with <code>hidestarsfile</code> can almost not be edited with an
Org mode without added functionality of hidestarsfile as long as the
file is not converted back.</li>
</ul>
</div>
</div>

<div id="outline-container-markdownstarsfile" class="outline-4">
<h4 id="markdownstarsfile">Headings in Markdown Format (markdownstarsfile)</h4>
<div class="outline-text-4" id="text-markdownstarsfile">
<p>
Together with <code>oddeven</code> you can use <code>markdownstarsfile</code> to be readable
or even basically editable with Markdown (does not make much sense
with <code>odd</code>, see <code>org-convert-to-odd-levels</code> and
<code>org-convert-to-oddeven-levels</code> for how to convert).
</p>

<p>
Example of the <b>file content</b>:
</p>

<div class="org-src-container">
<pre class="src src-org"><span style="color: #7f7f80;">  #+STARTUP: oddeven markdownstarsfile</span>
<span style="color: #696969;">  # section level 1</span>
    <span style="color: #e2c770;">1.</span> first item of numbered list (same format in Org and Markdown)
  <span style="color: #e2c770;">##</span> section level 2
     <span style="color: #e2c770;">-</span> first item of unordered list (same format in Org and Markdown)
  <span style="color: #e2c770;">###</span> section level 3
      <span style="color: #e2c770;">+</span> first item of unordered list (same format in Org and Markdown)
  <span style="color: #e2c770;">####</span> section level 4
       * first item of unordered list (same format in Org and Markdown)
       * avoid this item type to be compatible with Org hidestarsfile
</pre>
</div>

<p>
An Org file with <code>markdownstarsfile</code> can not contain code comment
lines prefixed with <code>#</code>, even not when within source blocks.
</p>
</div>
</div>

<div id="outline-container-fileconversion-code" class="outline-4">
<h4 id="fileconversion-code">emacs-lisp code</h4>
<div class="outline-text-4" id="text-fileconversion-code">
<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span style="color: #696969;">;; </span><span style="color: #696969;">- fileconversion version 0.10</span>
  <span style="color: #696969;">;; </span><span style="color: #696969;">- DISCLAIMER: Make a backup of your Org files before trying</span>
  <span style="color: #696969;">;;   </span><span style="color: #696969;">`</span><span style="color: #fd971f;">f-org-fileconv-*</span><span style="color: #696969;">'. It is recommended to use a version control</span>
  <span style="color: #696969;">;;   </span><span style="color: #696969;">system like git and to review and commit the changes in the Org</span>
  <span style="color: #696969;">;;   </span><span style="color: #696969;">files regularly.</span>
  <span style="color: #696969;">;; </span><span style="color: #696969;">- Supported "#+STARTUP:" formats: "hidestarsfile",</span>
  <span style="color: #696969;">;;   </span><span style="color: #696969;">"nbspstarsfile", "markdownstarsfile".</span>

  <span style="color: #696969;">;; </span><span style="color: #696969;">Design summary: fileconversion is a round robin of two states linked by</span>
  <span style="color: #696969;">;; </span><span style="color: #696969;">two actions:</span>
  <span style="color: #696969;">;; </span><span style="color: #696969;">- State `</span><span style="color: #fd971f;">v-org-fileconv-level-org-p</span><span style="color: #696969;">' is nil: The level is "file"</span>
  <span style="color: #696969;">;;   </span><span style="color: #696969;">(encoded).</span>
  <span style="color: #696969;">;; </span><span style="color: #696969;">- Action `</span><span style="color: #fd971f;">f-org-fileconv-decode</span><span style="color: #696969;">': Replace file char with "*".</span>
  <span style="color: #696969;">;; </span><span style="color: #696969;">- State `</span><span style="color: #fd971f;">v-org-fileconv-level-org-p</span><span style="color: #696969;">' is non-nil: The level is "Org"</span>
  <span style="color: #696969;">;;   </span><span style="color: #696969;">(decoded).</span>
  <span style="color: #696969;">;; </span><span style="color: #696969;">- Action `</span><span style="color: #fd971f;">f-org-fileconv-encode</span><span style="color: #696969;">': Replace "*" with file char.</span>
  <span style="color: #696969;">;;</span>
  <span style="color: #696969;">;; </span><span style="color: #696969;">Naming convention of prefix:</span>
  <span style="color: #696969;">;; </span><span style="color: #696969;">- f-[...]: "my function", instead of the unspecific prefix `</span><span style="color: #fd971f;">my-*</span><span style="color: #696969;">'.</span>
  <span style="color: #696969;">;; </span><span style="color: #696969;">- v-[...]: "my variable", instead of the unspecific prefix `</span><span style="color: #fd971f;">my-*</span><span style="color: #696969;">'.</span>

  <span style="color: #eb4509;">(</span><span style="color: #eb4509;">defvar</span> <span style="color: #fd971f;">v-org-fileconv-level-org-p</span> nil
    <span style="color: #7f7f80;">"Whether level of buffer is Org or only file.</span>
<span style="color: #7f7f80;">  nil: level is file (encoded), non-nil: level is Org (decoded)."</span><span style="color: #eb4509;">)</span>
  <span style="color: #eb4509;">(</span><span style="color: #fd971f;">make-variable-buffer-local</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">v-org-fileconv-level-org-p</span><span style="color: #eb4509;">)</span>
  <span style="color: #696969;">;; </span><span style="color: #696969;">Survive a change of major mode that does `</span><span style="color: #fd971f;">kill-all-local-variables</span><span style="color: #696969;">', e.</span>
  <span style="color: #696969;">;; </span><span style="color: #696969;">g. when reentering Org mode through "C-c C-c" on a #+STARTUP: line.</span>
  <span style="color: #eb4509;">(</span><span style="color: #fd971f;">put</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">v-org-fileconv-level-org-p</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">permanent-local</span> t<span style="color: #eb4509;">)</span>

  <span style="color: #696969;">;; </span><span style="color: #696969;">* Callback `</span><span style="color: #fd971f;">f-org-fileconv-org-mode-beg</span><span style="color: #696969;">' before `</span><span style="color: #fd971f;">org-mode</span><span style="color: #696969;">'</span>
  <span style="color: #eb4509;">(</span><span style="color: #eb4509;">defadvice</span> <span style="color: #b6e63e;">org-mode</span> <span style="color: #fd971f;">(</span>before org-mode-advice-before-fileconv<span style="color: #fd971f;">)</span>
    <span style="color: #fd971f;">(</span>f-org-fileconv-org-mode-beg<span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
  <span style="color: #eb4509;">(</span><span style="color: #b6e63e;">ad-activate</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">org-mode</span><span style="color: #eb4509;">)</span>
  <span style="color: #eb4509;">(</span><span style="color: #eb4509;">defun</span> <span style="color: #b6e63e;">f-org-fileconv-org-mode-beg</span> <span style="color: #fd971f;">()</span>
    <span style="color: #696969;">;; </span><span style="color: #696969;">- Reason to test `</span><span style="color: #fd971f;">buffer-file-name</span><span style="color: #696969;">': Only when converting really</span>
    <span style="color: #696969;">;;   </span><span style="color: #696969;">from/to an Org _file_, not e. g. for a temp Org buffer unrelated to a</span>
    <span style="color: #696969;">;;   </span><span style="color: #696969;">file.</span>
    <span style="color: #696969;">;; </span><span style="color: #696969;">- No `</span><span style="color: #fd971f;">message</span><span style="color: #696969;">' to not wipe a possible "File mode specification error:".</span>
    <span style="color: #696969;">;; </span><span style="color: #696969;">- `</span><span style="color: #fd971f;">f-org-fileconv-decode</span><span style="color: #696969;">' in org-mode-hook would be too late for</span>
    <span style="color: #696969;">;;   </span><span style="color: #696969;">performance reasons, see</span>
    <span style="color: #696969;">;;   </span><span style="color: #696969;">http://lists.gnu.org/archive/html/emacs-orgmode/2013-11/msg00920.html</span>
    <span style="color: #fd971f;">(</span><span style="color: #eb4509;">when</span> <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">buffer-file-name</span><span style="color: #b6e63e;">)</span> <span style="color: #b6e63e;">(</span>f-org-fileconv-decode<span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>

  <span style="color: #696969;">;; </span><span style="color: #696969;">* Callback `</span><span style="color: #fd971f;">f-org-fileconv-org-mode-end</span><span style="color: #696969;">' after `</span><span style="color: #fd971f;">org-mode</span><span style="color: #696969;">'</span>
  <span style="color: #eb4509;">(</span><span style="color: #b6e63e;">add-hook</span> <span style="color: #9c91e4;">'</span><span style="color: #fd971f;">org-mode-hook</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">f-org-fileconv-org-mode-end</span>
            nil   <span style="color: #696969;">; </span><span style="color: #696969;">_Prepend_ to hook to have it first.</span>
            nil<span style="color: #eb4509;">)</span>  <span style="color: #696969;">; </span><span style="color: #696969;">Hook addition global.</span>
  <span style="color: #eb4509;">(</span><span style="color: #eb4509;">defun</span> <span style="color: #b6e63e;">f-org-fileconv-org-mode-end</span> <span style="color: #fd971f;">()</span>
    <span style="color: #696969;">;; </span><span style="color: #696969;">- Reason to test `</span><span style="color: #fd971f;">buffer-file-name</span><span style="color: #696969;">': only when converting really</span>
    <span style="color: #696969;">;;   </span><span style="color: #696969;">from/to an Org _file_, not e. g. for a temp Org buffer unrelated to a</span>
    <span style="color: #696969;">;;   </span><span style="color: #696969;">file.</span>
    <span style="color: #696969;">;; </span><span style="color: #696969;">- No `</span><span style="color: #fd971f;">message</span><span style="color: #696969;">' to not wipe a possible "File mode specification error:".</span>
    <span style="color: #fd971f;">(</span><span style="color: #eb4509;">when</span> <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">buffer-file-name</span><span style="color: #b6e63e;">)</span>
      <span style="color: #696969;">;; </span><span style="color: #696969;">- Adding this to `</span><span style="color: #fd971f;">change-major-mode-hook</span><span style="color: #696969;">' or "defadvice before" of</span>
      <span style="color: #696969;">;;   </span><span style="color: #696969;">org-mode would be too early and already trigger during find-file.</span>
      <span style="color: #696969;">;; </span><span style="color: #696969;">- Argument 4: t to limit hook addition to buffer locally, this way</span>
      <span style="color: #696969;">;;   </span><span style="color: #696969;">and as required the hook addition will disappear when the major</span>
      <span style="color: #696969;">;;   </span><span style="color: #696969;">mode of the buffer changes.</span>
      <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">add-hook</span> <span style="color: #9c91e4;">'</span><span style="color: #fd971f;">change-major-mode-hook</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">f-org-fileconv-encode</span> nil t<span style="color: #b6e63e;">)</span>
      <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">add-hook</span> <span style="color: #9c91e4;">'</span><span style="color: #fd971f;">before-save-hook</span>       <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">f-org-fileconv-encode</span> nil t<span style="color: #b6e63e;">)</span>
      <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">add-hook</span> <span style="color: #9c91e4;">'</span><span style="color: #fd971f;">after-save-hook</span>        <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">f-org-fileconv-decode</span> nil t<span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>

  <span style="color: #eb4509;">(</span><span style="color: #eb4509;">defun</span> <span style="color: #b6e63e;">f-org-fileconv-re</span> <span style="color: #fd971f;">()</span>
    <span style="color: #7f7f80;">"Check whether there is a #+STARTUP: line for fileconversion.</span>
<span style="color: #7f7f80;">  If found then return the expressions required for the conversion."</span>
    <span style="color: #fd971f;">(</span><span style="color: #eb4509;">save-excursion</span>
      <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">goto-char</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">point-min</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>  <span style="color: #696969;">; </span><span style="color: #696969;">`</span><span style="color: #fd971f;">beginning-of-buffer</span><span style="color: #696969;">' is not allowed.</span>
      <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">let</span> <span style="color: #eb4509;">(</span>re-list <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">count</span> <span style="color: #9c91e4; font-weight: bold;">0</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
        <span style="color: #eb4509;">(</span><span style="color: #eb4509;">while</span> <span style="color: #fd971f;">(</span><span style="color: #fd971f;">re-search-forward</span> <span style="color: #e2c770;">"^[ \t]*#\\+STARTUP:"</span> nil t<span style="color: #fd971f;">)</span>
          <span style="color: #696969;">;; </span><span style="color: #696969;">#+STARTUP: hidestarsfile</span>
          <span style="color: #fd971f;">(</span><span style="color: #eb4509;">when</span> <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">string-match-p</span> <span style="color: #e2c770;">"\\bhidestarsfile\\b"</span> <span style="color: #eb4509;">(</span><span style="color: #b6e63e;">thing-at-point</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">line</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
            <span style="color: #696969;">;; </span><span style="color: #696969;">Exclude e. g.:</span>
            <span style="color: #696969;">;; </span><span style="color: #696969;">- Line starting with star for bold emphasis.</span>
            <span style="color: #696969;">;; </span><span style="color: #696969;">- Line of stars to underline section title in loosely quoted</span>
            <span style="color: #696969;">;;   </span><span style="color: #696969;">ASCII style (star at end of line).</span>
            <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">setq</span> re-list <span style="color: #9c91e4;">'</span><span style="color: #eb4509;">(</span><span style="color: #e2c770;">"</span><span style="color: #9c91e4; font-weight: bold;">\\</span><span style="color: #9c91e4; font-weight: bold;">(</span><span style="color: #e2c770;">\\* </span><span style="color: #9c91e4; font-weight: bold;">\\</span><span style="color: #9c91e4; font-weight: bold;">)</span><span style="color: #e2c770;">"</span>  <span style="color: #696969;">; </span><span style="color: #696969;">common-re</span>
                            ?\ <span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>         <span style="color: #696969;">; </span><span style="color: #696969;">file-char</span>
            <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">setq</span> count <span style="color: #eb4509;">(</span><span style="color: #fd971f;">1+</span> count<span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>
          <span style="color: #696969;">;; </span><span style="color: #696969;">#+STARTUP: nbspstarsfile</span>
          <span style="color: #fd971f;">(</span><span style="color: #eb4509;">when</span> <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">string-match-p</span> <span style="color: #e2c770;">"\\bnbspstarsfile\\b"</span> <span style="color: #eb4509;">(</span><span style="color: #b6e63e;">thing-at-point</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">line</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
            <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">setq</span> re-list <span style="color: #9c91e4;">'</span><span style="color: #eb4509;">(</span><span style="color: #e2c770;">"</span><span style="color: #9c91e4; font-weight: bold;">\\</span><span style="color: #9c91e4; font-weight: bold;">(</span><span style="color: #e2c770;">\\* </span><span style="color: #9c91e4; font-weight: bold;">\\</span><span style="color: #9c91e4; font-weight: bold;">)</span><span style="color: #e2c770;">"</span>  <span style="color: #696969;">; </span><span style="color: #696969;">common-re</span>
                            ?\xa0<span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>       <span style="color: #696969;">; </span><span style="color: #696969;">file-char non-breaking space</span>
            <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">setq</span> count <span style="color: #eb4509;">(</span><span style="color: #fd971f;">1+</span> count<span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>
          <span style="color: #696969;">;; </span><span style="color: #696969;">#+STARTUP: markdownstarsfile</span>
          <span style="color: #fd971f;">(</span><span style="color: #eb4509;">when</span> <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">string-match-p</span> <span style="color: #e2c770;">"\\bmarkdownstarsfile\\b"</span>
                                <span style="color: #eb4509;">(</span><span style="color: #b6e63e;">thing-at-point</span> <span style="color: #9c91e4;">'</span><span style="color: #66d9ef;">line</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
            <span style="color: #696969;">;; </span><span style="color: #696969;">Exclude e. g. "#STARTUP:".</span>
            <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">setq</span> re-list <span style="color: #9c91e4;">'</span><span style="color: #eb4509;">(</span><span style="color: #e2c770;">"</span><span style="color: #9c91e4; font-weight: bold;">\\</span><span style="color: #9c91e4; font-weight: bold;">(</span><span style="color: #e2c770;"> </span><span style="color: #9c91e4; font-weight: bold;">\\</span><span style="color: #9c91e4; font-weight: bold;">)</span><span style="color: #e2c770;">"</span>  <span style="color: #696969;">; </span><span style="color: #696969;">common-re</span>
                            ?#<span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>       <span style="color: #696969;">; </span><span style="color: #696969;">file-char</span>
            <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">setq</span> count <span style="color: #eb4509;">(</span><span style="color: #fd971f;">1+</span> count<span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
        <span style="color: #eb4509;">(</span><span style="color: #eb4509;">when</span> <span style="color: #fd971f;">(</span><span style="color: #fd971f;">&gt;</span> count <span style="color: #9c91e4; font-weight: bold;">1</span><span style="color: #fd971f;">)</span> <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">error</span> <span style="color: #e2c770;">"More than one fileconversion found."</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
        re-list<span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>

  <span style="color: #eb4509;">(</span><span style="color: #eb4509;">defun</span> <span style="color: #b6e63e;">f-org-fileconv-decode</span> <span style="color: #fd971f;">()</span>
    <span style="color: #7f7f80;">"In headings replace file char with '*'."</span>
    <span style="color: #fd971f;">(</span><span style="color: #eb4509;">let</span> <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">(</span>re-list <span style="color: #fd971f;">(</span>f-org-fileconv-re<span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
      <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">when</span> <span style="color: #eb4509;">(</span><span style="color: #eb4509;">and</span> re-list <span style="color: #fd971f;">(</span><span style="color: #fd971f;">not</span> v-org-fileconv-level-org-p<span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
        <span style="color: #696969;">;; </span><span style="color: #696969;">No `</span><span style="color: #fd971f;">save-excursion</span><span style="color: #696969;">' to be able to keep point in case of error.</span>
        <span style="color: #eb4509;">(</span><span style="color: #eb4509;">let*</span> <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">(</span>common-re <span style="color: #eb4509;">(</span><span style="color: #fd971f;">nth</span> <span style="color: #9c91e4; font-weight: bold;">0</span> re-list<span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
               <span style="color: #b6e63e;">(</span>file-char <span style="color: #eb4509;">(</span><span style="color: #fd971f;">nth</span> <span style="color: #9c91e4; font-weight: bold;">1</span> re-list<span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
               <span style="color: #b6e63e;">(</span>file-re   <span style="color: #eb4509;">(</span><span style="color: #fd971f;">concat</span> <span style="color: #e2c770;">"^"</span> <span style="color: #fd971f;">(</span><span style="color: #fd971f;">string</span> file-char<span style="color: #fd971f;">)</span> <span style="color: #e2c770;">"+"</span> common-re<span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
               <span style="color: #b6e63e;">(</span>org-re    <span style="color: #eb4509;">(</span><span style="color: #fd971f;">concat</span> <span style="color: #e2c770;">"^\\*+"</span> common-re<span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
               len
               <span style="color: #b6e63e;">(</span>p         <span style="color: #eb4509;">(</span><span style="color: #fd971f;">point</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>
          <span style="color: #fd971f;">(</span><span style="color: #fd971f;">goto-char</span> <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">point-min</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>  <span style="color: #696969;">; </span><span style="color: #696969;">`</span><span style="color: #fd971f;">beginning-of-buffer</span><span style="color: #696969;">' is not allowed.</span>
          <span style="color: #696969;">;; </span><span style="color: #696969;">Syntax check.</span>
          <span style="color: #fd971f;">(</span><span style="color: #eb4509;">when</span> <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">re-search-forward</span> org-re nil t<span style="color: #b6e63e;">)</span>
            <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">goto-char</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">match-beginning</span> <span style="color: #9c91e4; font-weight: bold;">0</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
            <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">org-reveal</span><span style="color: #b6e63e;">)</span>
            <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">error</span> <span style="color: #e2c770;">"Org fileconversion decode: Syntax conflict at point."</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>
          <span style="color: #fd971f;">(</span><span style="color: #fd971f;">goto-char</span> <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">point-min</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>  <span style="color: #696969;">; </span><span style="color: #696969;">`</span><span style="color: #fd971f;">beginning-of-buffer</span><span style="color: #696969;">' is not allowed.</span>
          <span style="color: #696969;">;; </span><span style="color: #696969;">Substitution.</span>
          <span style="color: #fd971f;">(</span><span style="color: #eb4509;">with-silent-modifications</span>
            <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">while</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">re-search-forward</span> file-re nil t<span style="color: #eb4509;">)</span>
              <span style="color: #eb4509;">(</span><span style="color: #fd971f;">goto-char</span> <span style="color: #fd971f;">(</span><span style="color: #fd971f;">match-beginning</span> <span style="color: #9c91e4; font-weight: bold;">0</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
              <span style="color: #696969;">;; </span><span style="color: #696969;">Faster than a lisp call of insert and delete on each single</span>
              <span style="color: #696969;">;; </span><span style="color: #696969;">char.</span>
              <span style="color: #eb4509;">(</span><span style="color: #eb4509;">setq</span> len <span style="color: #fd971f;">(</span><span style="color: #fd971f;">-</span> <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">match-beginning</span> <span style="color: #9c91e4; font-weight: bold;">1</span><span style="color: #b6e63e;">)</span> <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">match-beginning</span> <span style="color: #9c91e4; font-weight: bold;">0</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
              <span style="color: #eb4509;">(</span><span style="color: #fd971f;">insert-char</span> ?* len<span style="color: #eb4509;">)</span>
              <span style="color: #eb4509;">(</span><span style="color: #fd971f;">delete-char</span> len<span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>
          <span style="color: #fd971f;">(</span><span style="color: #fd971f;">goto-char</span> p<span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>

          <span style="color: #696969;">;; </span><span style="color: #696969;">Notes for ediff when only one file has fileconversion:</span>
          <span style="color: #696969;">;; </span><span style="color: #696969;">- The changes to the buffer with fileconversion until here are</span>
          <span style="color: #696969;">;;   </span><span style="color: #696969;">not regarded by `</span><span style="color: #fd971f;">ediff-files</span><span style="color: #696969;">' because the first call to diff is</span>
          <span style="color: #696969;">;;   </span><span style="color: #696969;">made with the bare files directly. Only `</span><span style="color: #fd971f;">ediff-update-diffs</span><span style="color: #696969;">'</span>
          <span style="color: #696969;">;;   </span><span style="color: #696969;">and `</span><span style="color: #fd971f;">ediff-buffers</span><span style="color: #696969;">' write the decoded buffers to temp files and</span>
          <span style="color: #696969;">;;   </span><span style="color: #696969;">then call diff with them.</span>
          <span style="color: #696969;">;; </span><span style="color: #696969;">- Workarounds (choose one):</span>
          <span style="color: #696969;">;;   </span><span style="color: #696969;">- After ediff-files first do a "!" (ediff-update-diffs) in the</span>
          <span style="color: #696969;">;;     </span><span style="color: #696969;">"*Ediff Control Panel*".</span>
          <span style="color: #696969;">;;   </span><span style="color: #696969;">- Instead of using `</span><span style="color: #fd971f;">ediff-files</span><span style="color: #696969;">' first open the files and then</span>
          <span style="color: #696969;">;;     </span><span style="color: #696969;">run `</span><span style="color: #fd971f;">ediff-buffers</span><span style="color: #696969;">' (better for e. g. a script that takes two</span>
          <span style="color: #696969;">;;     </span><span style="color: #696969;">files as arguments and uses "emacs --eval").</span>

    <span style="color: #696969;">;; </span><span style="color: #696969;">The level is Org most of all when no fileconversion is in effect.</span>
    <span style="color: #fd971f;">(</span><span style="color: #eb4509;">setq</span> v-org-fileconv-level-org-p t<span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>

  <span style="color: #eb4509;">(</span><span style="color: #eb4509;">defun</span> <span style="color: #b6e63e;">f-org-fileconv-encode</span> <span style="color: #fd971f;">()</span>
    <span style="color: #7f7f80;">"In headings replace '*' with file char."</span>
    <span style="color: #fd971f;">(</span><span style="color: #eb4509;">let</span> <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">(</span>re-list <span style="color: #fd971f;">(</span>f-org-fileconv-re<span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
      <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">when</span> <span style="color: #eb4509;">(</span><span style="color: #eb4509;">and</span> re-list v-org-fileconv-level-org-p<span style="color: #eb4509;">)</span>
        <span style="color: #696969;">;; </span><span style="color: #696969;">No `</span><span style="color: #fd971f;">save-excursion</span><span style="color: #696969;">' to be able to keep point in case of error.</span>
        <span style="color: #eb4509;">(</span><span style="color: #eb4509;">let*</span> <span style="color: #fd971f;">(</span><span style="color: #b6e63e;">(</span>common-re <span style="color: #eb4509;">(</span><span style="color: #fd971f;">nth</span> <span style="color: #9c91e4; font-weight: bold;">0</span> re-list<span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
               <span style="color: #b6e63e;">(</span>file-char <span style="color: #eb4509;">(</span><span style="color: #fd971f;">nth</span> <span style="color: #9c91e4; font-weight: bold;">1</span> re-list<span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
               <span style="color: #b6e63e;">(</span>file-re   <span style="color: #eb4509;">(</span><span style="color: #fd971f;">concat</span> <span style="color: #e2c770;">"^"</span> <span style="color: #fd971f;">(</span><span style="color: #fd971f;">string</span> file-char<span style="color: #fd971f;">)</span> <span style="color: #e2c770;">"+"</span> common-re<span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
               <span style="color: #b6e63e;">(</span>org-re    <span style="color: #eb4509;">(</span><span style="color: #fd971f;">concat</span> <span style="color: #e2c770;">"^\\*+"</span> common-re<span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
               len
               <span style="color: #b6e63e;">(</span>p         <span style="color: #eb4509;">(</span><span style="color: #fd971f;">point</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>
          <span style="color: #fd971f;">(</span><span style="color: #fd971f;">goto-char</span> <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">point-min</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>  <span style="color: #696969;">; </span><span style="color: #696969;">`</span><span style="color: #fd971f;">beginning-of-buffer</span><span style="color: #696969;">' is not allowed.</span>
          <span style="color: #696969;">;; </span><span style="color: #696969;">Syntax check.</span>
          <span style="color: #fd971f;">(</span><span style="color: #eb4509;">when</span> <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">re-search-forward</span> file-re nil t<span style="color: #b6e63e;">)</span>
            <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">goto-char</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">match-beginning</span> <span style="color: #9c91e4; font-weight: bold;">0</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span>
            <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">org-reveal</span><span style="color: #b6e63e;">)</span>
            <span style="color: #b6e63e;">(</span><span style="color: #b6e63e;">error</span> <span style="color: #e2c770;">"Org fileconversion encode: Syntax conflict at point."</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>
          <span style="color: #fd971f;">(</span><span style="color: #fd971f;">goto-char</span> <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">point-min</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>  <span style="color: #696969;">; </span><span style="color: #696969;">`</span><span style="color: #fd971f;">beginning-of-buffer</span><span style="color: #696969;">' is not allowed.</span>
          <span style="color: #696969;">;; </span><span style="color: #696969;">Substitution.</span>
          <span style="color: #fd971f;">(</span><span style="color: #eb4509;">with-silent-modifications</span>
            <span style="color: #b6e63e;">(</span><span style="color: #eb4509;">while</span> <span style="color: #eb4509;">(</span><span style="color: #fd971f;">re-search-forward</span> org-re nil t<span style="color: #eb4509;">)</span>
              <span style="color: #eb4509;">(</span><span style="color: #fd971f;">goto-char</span> <span style="color: #fd971f;">(</span><span style="color: #fd971f;">match-beginning</span> <span style="color: #9c91e4; font-weight: bold;">0</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
              <span style="color: #696969;">;; </span><span style="color: #696969;">Faster than a lisp call of insert and delete on each single</span>
              <span style="color: #696969;">;; </span><span style="color: #696969;">char.</span>
              <span style="color: #eb4509;">(</span><span style="color: #eb4509;">setq</span> len <span style="color: #fd971f;">(</span><span style="color: #fd971f;">-</span> <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">match-beginning</span> <span style="color: #9c91e4; font-weight: bold;">1</span><span style="color: #b6e63e;">)</span> <span style="color: #b6e63e;">(</span><span style="color: #fd971f;">match-beginning</span> <span style="color: #9c91e4; font-weight: bold;">0</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span>
              <span style="color: #eb4509;">(</span><span style="color: #fd971f;">insert-char</span> file-char len<span style="color: #eb4509;">)</span>
              <span style="color: #eb4509;">(</span><span style="color: #fd971f;">delete-char</span> len<span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>
          <span style="color: #fd971f;">(</span><span style="color: #fd971f;">goto-char</span> p<span style="color: #fd971f;">)</span>
          <span style="color: #fd971f;">(</span><span style="color: #eb4509;">setq</span> v-org-fileconv-level-org-p nil<span style="color: #fd971f;">)</span><span style="color: #eb4509;">)</span><span style="color: #b6e63e;">)</span><span style="color: #fd971f;">)</span>
    nil<span style="color: #eb4509;">)</span>  <span style="color: #696969;">; </span><span style="color: #696969;">For the hook.</span>
</pre>
</div>

<p>
Michael Brand
</p>
</div>
</div>
</div>

<div id="outline-container-orgc66c300" class="outline-3">
<h3 id="orgc66c300">Meaningful diff for org files in a git repository</h3>
<div class="outline-text-3" id="text-orgc66c300">
<p>
Since most diff utilities are primarily meant for source code, it is
difficult to read diffs of text files like <code>.org</code> files easily. If you
version your org directory with a SCM like git you will know what I
mean. However for git, there is a way around. You can use
<code>gitattributes</code> to define a custom diff driver for org files. Then a
regular expression can be used to configure how the diff driver
recognises a &ldquo;function&rdquo;.
</p>

<p>
Put the following in your <code>&lt;org_dir&gt;/.gitattributes</code>.
</p>
<pre class="example">
*.org	diff=org
</pre>

<p>
Then put the following lines in <code>&lt;org_dir&gt;/.git/config</code>
</p>
<pre class="example">
[diff "org"]
	xfuncname = "^(\\*+ [a-zA-Z0-9]+.+)$"
</pre>


<p>
This will let you see diffs for org files with each hunk identified by
the unmodified headline closest to the changes. After the
configuration a diff should look something like the example below.
</p>

<pre class="example">
diff --git a/org-hacks.org b/org-hacks.org
index a0672ea..92a08f7 100644
--- a/org-hacks.org
+++ b/org-hacks.org
@@ -2495,6 +2495,22 @@ ** Script (thru procmail) to output emails to an Org file

 Everything is documented [[http://tychoish.com/code/org-mail/][here]].

+** Meaningful diff for org files in a git repository
+
+Since most diff utilities are primarily meant for source code, it is
+difficult to read diffs of text files like ~.org~ files easily. If you
+version your org directory with a SCM like git you will know what I
+mean. However for git, there is a way around. You can use
+=gitattributes= to define a custom diff driver for org files. Then a
+regular expression can be used to configure how the diff driver
+recognises a "function".
+
+Put the following in your =&lt;org_dir&gt;/.gitattributes=.
+: *.org	diff=org
+Then put the following lines in =&lt;org_dir&gt;/.git/config=
+: [diff "org"]
+: 	xfuncname = "^(\\*+ [a-zA-Z0-9]+.+)$"
+
 * Musings

 ** Cooking?  Brewing?
</pre>
</div>
</div>

<div id="outline-container-orgbee7bd8" class="outline-3">
<h3 id="orgbee7bd8">Opening devonthink links</h3>
<div class="outline-text-3" id="text-orgbee7bd8">
<p>
John Wiegley wrote <a href="https://github.com/jwiegley/dot-emacs/blob/master/lisp/org-devonthink.el">org-devonthink.el</a>, which lets you handle devonthink
links from org-mode.
</p>
</div>
</div>

<div id="outline-container-org8d27a32" class="outline-3">
<h3 id="org8d27a32">Memacs - Org-mode collecting meta-data from the disk and cloud</h3>
<div class="outline-text-3" id="text-org8d27a32">
<p>
Karl Voit designed Memacs (<a href="https://en.wikipedia.org/wiki/Memex">Memex</a> and Emacs) which is a collection of
modules that are able to get meta-data from different kind of
sources. Memacs then generates output files containing meta-data in
Org-mode format. Those files a most likely integrated as <code>*.org_archive</code>
files in your agenda.
</p>

<p>
This way, you can get a pretty decent overview of your (digital) life:
</p>
<ul class="org-ul">
<li>file name timestamps (<a href="https://en.wikipedia.org/wiki/Iso_date">ISO 8601</a>; like &ldquo;2013-10-11 Product Demonstration.odp&rdquo;)</li>
<li>emails (IMAP, POP, Maildir, mbox)</li>
<li>RSS feeds (blog updates, &#x2026; <b>lots</b> of possibilities there!)</li>
<li>version system commits (SVN, git)</li>
<li>calendar (iCal, CSV)</li>
<li>text messages from your phone (Android)</li>
<li>phone calls (Android)</li>
<li>photographs (EXIF)</li>
<li>bank accounts (<a href="http://easybank.at">easybank</a>)</li>
<li>usenet postings (slrn, mbox, &#x2026;)</li>
<li>XML (a sub-set of easy-to-parse XML files can be parsed with minimal
effort)</li>
</ul>

<p>
General idea: you set up the module(s) you would like to use once and
they are running in the background. As long as the data source does
not change, you should not have to worry about the module again.
</p>

<p>
It is hard to explain the vast amount of (small) benefits you get once
you have set up your Memacs modules.
</p>

<p>
There is <a href="http://arxiv.org/abs/1304.1332">a whitepaper which describes Memacs</a> and its implications.
</p>

<p>
Memacs is <a href="https://github.com/novoid/Memacs">hosted on github</a> and is written in Python.
</p>

<p>
You can use Memacs to write your own Memacs module: an example module
demonstrates how to write modules with very low effort. Please
consider a pull request on github so that other people can use your
module as well!
</p>

<p>
<a href="https://github.com/novoid/twitter-json_to_orgmode">Twitter JSON to Org-mode</a> generates Memacs-like output files for
<a href="https://blog.twitter.com/2012/your-twitter-archive">Twitter export archives</a> (JSON) but is independent of Memacs.
</p>
</div>
</div>

<div id="outline-container-org80c74f7" class="outline-3">
<h3 id="org80c74f7">Displaying Vega and Vega lite graphs with org</h3>
<div class="outline-text-3" id="text-org80c74f7">
<p>
See <a href="https://github.com/vladkotu/vladkotu.github.io/blob/source/blog/org-clj-plot/clj-plot.org#vega-vega-lite-wrappers">this example</a>.
</p>
</div>
</div>

<div id="outline-container-orgf3264ff" class="outline-3">
<h3 id="orgf3264ff">Emacs as an Org capture server</h3>
<div class="outline-text-3" id="text-orgf3264ff">
<blockquote>
<p>
The general idea is to run an Emacs server as a daemon which clients
can quickly connect to via a bash script. The client executes
org-capture and the frame closes upon finalizing or aborting the
capture.
</p>
</blockquote>

<p>
See No Wayman&rsquo;s <a href="https://orgmode.org/list/87a6xz3lnd.fsf@gmail.com/">message on the list</a> and <a href="https://gist.github.com/progfolio/af627354f87542879de3ddc30a31adc1">this gist</a> for details.
</p>
</div>
</div>
</div>

<div id="outline-container-orgca743e5" class="outline-2">
<h2 id="orgca743e5">Musings</h2>
<div class="outline-text-2" id="text-orgca743e5">
</div>
<div id="outline-container-orgb875a28" class="outline-3">
<h3 id="orgb875a28">Cooking?  Brewing?</h3>
<div class="outline-text-3" id="text-orgb875a28">
<p>
See <a href="https://orgmode.org/list/87livkco7y.wl%egh@e6h.org">this message</a> from Erik Hetzner:
</p>

<p>
It currently does metric/english conversion, and a few other tricks.
Basically I just use calcs units code.  I think scaling recipes, or
turning percentages into weights would be pretty easy.
</p>

<p>
<a href="https://gitorious.org/org-cook/org-cook">https://gitorious.org/org-cook/org-cook</a>
</p>

<p>
There is also, for those interested:
</p>

<p>
<a href="https://gitorious.org/org-brew/org-brew">https://gitorious.org/org-brew/org-brew</a>
</p>

<p>
for brewing beer. This is again, mostly just calc functions, including
hydrometer correction, abv calculation, priming sugar for a given CO<sub>2</sub>
volume, etc. More integration with org-mode should be possible: for
instance it would be nice to be able to use a lookup table (of ingredients)
to calculate target original gravity, IBUs, etc.
</p>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: Worg people</p>
<p class="date">Created: 2021-06-15 Tue 18:21</p>
</div>
</body>
</html>
